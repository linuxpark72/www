<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Clocks</title><link rel="Prev" href="clock_power_setup.html" title="Previous" /><link rel="Next" href="power_management_tx1.html" title="Next" /><link rel="StyleSheet" href="css/clocks.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/clocks_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/clocks.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pooYEMUpYKDcXNdEm1mDqkg" class="ww_skin_page_body" style="background-attachment: scroll; background-image: url(&quot;watermark.png&quot;); background-position: center center; background-repeat: no-repeat; margin-left: 0pt; margin-right: 10pt" onload="Page.OnLoad('../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/clocks.html');"><header id="wwconnect_header"><div><table width="100%" align="center" summary=""><tr><td class="Header_Left"><img alt="NVIDIA Tegra" src="images/NVLogo_2D_H.jpg" width="204" height="44" border="0" /></td><td class="Header_Right"><div>NVIDIA Tegra Linux Driver Package</div><br />
           Development Guide <br /><font size="-1"><div>28.2 Release</div></font><br /></td></tr></table></div><!--     <br clear="all" />
 --><hr color="#DEE4F0" /><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwpID0E0VB0HA" class="Heading_2_Top">Clocks</div><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/clocks.html#wwpID0E0DB0HA">Overriding Default Clock Rates</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/clocks.html#wwpID0ESHA">Configuring Clocks</a></div></dd></dl></div><div id="wwpID0E0UB0HA" class="Body_Text">NVIDIA<span style="vertical-align: super">®</span> Tegra<span style="vertical-align: super">®</span> Board Support Package (BSP) supports configuring Tegra clocks and peripheral clocks through the software. This topic describes how to check clock status, get maximum rates for clocks, and configure clock sources.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0TB0HA" class="Cell_Heading">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0TB0HA" class="Note_Text">For information about available Tegra clock sources and capabilities, see the “Clock and Reset Controller” section of the <span class="Emphasis">Tegra Technical Reference Manual</span> (<span class="Emphasis">TRM</span>) for your chip. This section of the <span style="font-style: italic">TRM</span> also describes clock source multiplexers and provides descriptions of available clock sources for each component.</div></td></tr></table></div><div id="wwpID0E0SB0HA" class="Body_Text">In kernel 4.4 and following, the common clock framework (CCF) is supported. As a result:</div><div id="wwpID0E0RB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>All device drivers use the public CCF APIs <span class="Code_Char">include/linux/clk.h</span>, and <span class="Code_Char">include/linux/clk-provider.h</span>, including functions such as <span class="Code_Char">clk_get</span>, <span class="Code_Char">clk_enable</span>, <span class="Code_Char">devm_clk_get</span>, <span class="Code_Char">clk_prepare_enable</span>, <span class="Code_Char">clk_prepare_disable</span>, <span class="Code_Char">clk_disable</span>, and others, instead of Tegra specific APIs.</div><div id="wwpID0E0QB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>All clock drivers, including the Tegra custom <span class="Code_Char">clk</span> driver, implement <span class="Code_Char">clk_ops</span>.</div><div id="wwpID0E0PB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Clock sources and clocks required by devices are defined in the Device Tree.</div><div id="wwpID0E0OB0HA" class="Body_Text">The Tegra custom clock driver is available in the <span class="Code_Char">kernel-4.4/drivers/clk/tegra/</span> directory.</div><div id="wwpID0E0NB0HA" class="Body_Text">Clock rate and clock source information is available in the following files:</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 178.55pt"><div id="wwpID0EABM0MB0HA" class="Cell_Heading"><span style="color: #000000">CCF Basic Clocks</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 188.95pt"><div id="wwpID0EAAM0MB0HA" class="Cell_Heading"><span style="color: #000000">Driver File</span></div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABL0MB0HA" class="Cell_Text">PLL, PLL_OUT</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAL0MB0HA" class="Cell_Text">clk-pll.c, clk-pll-out.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABK0MB0HA" class="Cell_Text">Audio Sync</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAK0MB0HA" class="Cell_Text">clk-audio-sync.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABJ0MB0HA" class="Cell_Text">Divider</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAJ0MB0HA" class="Cell_Text">clk-divider.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABI0MB0HA" class="Cell_Text">Peripheral Gate</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAI0MB0HA" class="Cell_Text">cclk-periph.c, clk-periph-fixed.c, clk-periph-gate.c, clk-tegra-periph.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABH0MB0HA" class="Cell_Text">Super</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAH0MB0HA" class="Cell_Text">clk-super.c, clk-tegra-super-gen4.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABG0MB0HA" class="Cell_Text">Fixed</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAG0MB0HA" class="Cell_Text">clk-tegra-fixed.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABF0MB0HA" class="Cell_Text">Shared</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAF0MB0HA" class="Cell_Text">clk-tegra-shared.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABE0MB0HA" class="Cell_Text">DFLL</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAE0MB0HA" class="Cell_Text">clk-dfll.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD0MB0HA" class="Cell_Text">CBUS</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAD0MB0HA" class="Cell_Text">clk-cbus-shared.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0MB0HA" class="Cell_Text">EMC</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAC0MB0HA" class="Cell_Text">clk-emc.c</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0MB0HA" class="Cell_Text">Jetson TX1 clocks</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB0MB0HA" class="Cell_Text">soc/tegra/kernel-include/dt-bindings/clock/tegra210-car.h</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0MB0HA" class="Cell_Text">Jetson TX2 clocks</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAA0MB0HA" class="Cell_Text">soc/t18x/kernel-include/dt-bindings/clock/tegra186-clock.h</div></td></tr></table></div><div id="wwpID0E0LB0HA" class="Heading_5">To check clock status</div><div id="wwpID0E0KB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>On the device, enter the following command to launch <span class="Code_Char">debugfs</span> and check the clock:</div><div id="wwpID0E0JB0HA" class="Code">sudo -s</div><div id="wwpID0E0IB0HA" class="Code"># cat /sys/kernel/debug/clk/clk_summary</div><div id="wwpID0E0HB0HA" class="Body_Text">An example of <span class="Code_Char">debugfs</span> output for TX1 is as follows.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0GB0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/image1_2.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" /></div></div><div id="wwpID0E0FB0HA" class="Body_Text">An example of <span class="Code_Char">debugfs</span> output for TX2 is as follows.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0EB0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/image2_4.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" /></div></div><div id="wwpID0E0DB0HA" class="Heading_3">Overriding Default Clock Rates</div><div id="wwpID0E0CB0HA" class="Body_Text">The default clock rate of each component is set during boot and updated under control of the driver or framework in the case of TX1, or BPMP in the case of TX2. The <span class="Code_Char">debugfs</span> service provides a way to override the default clock rate and set a fixed clock rate. Use debugfs for debugging and experimental purposes only.</div><div id="wwpID0E0BB0HA" class="Body_Text">TX1 contains the following clocks, controlled by various frameworks:</div><div id="wwpID0E0AB0HA" class="Code">/sys/kernel/debug/clk/override.[ape, c3bus, gbus, mselect, abus, c2bus, emc, host1x, sclk]</div><div id="wwpID0E6HA" class="Body_Text">For example, the GPU clock, i.e., the <span class="Code_Char">gbus</span> rate, is under GPU frequency scaling. Change the <span class="Code_Char">gbus</span> rate with the following commands:</div><div id="wwpID0E5HA" class="Code">echo X &gt; /sys/kernel/debug/clk/override.gbus/clk_update_rate</div><div id="wwpID0E4HA" class="Code">echo 1 &gt; /sys/kernel/debug/clk/override.gbus/clk_state</div><div id="wwpID0E3HA" class="Body_Text">Re-enable <span class="Code_Char">gbus</span> frequency scaling with the following command:</div><div id="wwpID0E2HA" class="Code">echo 0 &gt; /sys/kernel/debug/clk/override.gbus/clk_state</div><div id="wwpID0E1HA" class="Body_Text">Valid clock rates can be found using <span class="Code_Char">clk_possible_rates</span>. For example, find the rates for <span class="Code_Char">gbus</span> with the following command:</div><div id="wwpID0EZHA" class="Code">cat /sys/kernel/debug/clk/gbus/clk_possible_rates</div><div id="wwpID0EYHA" class="Body_Text">For other clocks, update clock rates with the following command:</div><div id="wwpID0EXHA" class="Code">echo x &gt; /sys/kernel/debug/clk/&lt;module&gt;/clk_update_rate</div><div id="wwpID0EWHA" class="Body_Text">The TX2 clocks are controlled by BPMP. For example, override the EMC rate with the following commands:</div><div id="wwpID0EVHA" class="Code-bg">echo 1 &gt; /sys/kernel/debug/bpmp/debug/clk/emc/mrq_rate_locked</div><div id="wwpID0EUHA" class="Code-bg">echo 1 &gt; /sys/kernel/debug/bpmp/debug/clk/emc/state</div><div id="wwpID0ETHA" class="Code-bg">echo x &gt; /sys/kernel/debug/bpmp/debug/clk/emc/rate</div><div id="wwpID0ESHA" class="Heading_3">Configuring Clocks</div><div id="wwpID0ERHA" class="Body_Text">In general, each block or module has a dedicated clock source register. For detailed information about a given register, see <span class="Code_Char">CLK_RST_CONTROLLER_CLK_SOURCE_&lt;module_name&gt;</span> in the <span class="Emphasis">Tegra Technical Reference Manual</span> (<span class="Emphasis">TRM</span>).</div><div id="wwpID0EQHA" class="Body_Text">Clock source registers provide clock source selection and clock divider control for the module. The divider is typically 8 bits, 7 integer bits and 1 fractional bit (U7.1).</div><div id="wwpID0EPHA" class="Heading_5">To change clock configurations in the kernel device driver module</div><div id="wwpID0EOHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Declare clocks in Device Tree. For example, for <span class="Code_Char">padctl-uphy</span>, clocks can be declared as follows:</div><div id="wwpID0ENHA" class="Code">clocks = &lt;&amp;tegra_car TEGRA210_CLK_HSIC_TRK&gt;,</div><div id="wwpID0EMHA" class="Code">         &lt;&amp;tegra_car TEGRA210_CLK_USB2_TRK&gt;,</div><div id="wwpID0ELHA" class="Code">          &lt;&amp;tegra_car TEGRA210_CLK_PLL_E&gt;;</div><div id="wwpID0EKHA" class="Code">clock-names = "hsic_trk", "usb2_trk", "pll_e";</div><div id="wwpID0EJHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Use the <span class="Code_Char">devm_clk_get </span>function to obtain the desired clock source using clock-names.</div><div id="wwpID0EIHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Use the <span class="Code_Char">clk_get_parent</span> function to obtain the parent clock for the desired clock.</div><div id="wwpID0EHHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Use the <span class="Code_Char">clk_set_parent</span> function to select the specified clock source for the target clock.</div><div id="wwpID0EGHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>5.	</span></span>Use the <span class="Code_Char">clk_set_rate</span> function to set the frequency of the target clock. </div><div id="wwpID0EFHA" class="List_Continue">The divider is calculated automatically according to the target rate. Successful clock frequency settings must meet the available divider of that module and the frequency of the clock source.</div><div id="wwpID0EEHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>6.	</span></span>Use the <span class="Code_Char">clk_round_rate</span> function to get the exact clock frequency that can be configured from the current clock source.</div><div id="wwpID0EDHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>7.	</span></span>Use <span class="Code_Char">clk_prepare_enable</span> (or <span class="Code_Char">clk_prepare</span> and <span class="Code_Char">clk_enable</span>) functions to ungate/enable the clock. The <span class="Code_Char">clk_prepare</span> function can be used instead of <span class="Code_Char">clk_enable</span> to ungate a clock if the operation may sleep.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABACHA" class="Cell_Heading">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EBAACHA" class="Note_Text">Some modules may have additional dividers, e.g., <span class="Code_Char">DC_DISP_DISP_CLOCK_CONTROL_0</span>.</div><div id="wwpID0EAAACHA" class="Note_Text">For more information, see the <span class="Emphasis">Tegra Technical Reference Manual</span> (<span class="Emphasis">TRM</span>) for your chip.</div></td></tr></table></div><div id="wwpID0EBHA" class="Body_Text">&nbsp;</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br /><hr color="#DEE4F0" /><table width="90%" align="center" summary=""><tr><td class="Footer_Left"><font color="gray"><b></b><br />
           Subject to Change | © 2017 by NVIDIA Corporation.
           All rights reserved.
        </font></td><td class="Footer_Right"><font color="gray"><div>PR-06076-R28</div><br /><div style="text-align: center; font-weight: bold;"><div>Revised: 05 Mar 2018 16:32:31</div></div></font></td></tr></table></footer></body></html>