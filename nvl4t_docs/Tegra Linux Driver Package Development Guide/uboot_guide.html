<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>U-Boot Customization</title><link rel="Prev" href="part_config_tx2.html" title="Previous" /><link rel="Next" href="mb1_platform_config.html" title="Next" /><link rel="StyleSheet" href="css/uboot_guide.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/uboot_guide_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN2swndeQuNmW_002bPx9RBPAKwQ" class="ww_skin_page_body" style="background-attachment: scroll; background-image: url(&quot;watermark.png&quot;); background-position: center center; background-repeat: no-repeat; margin-left: 0pt; margin-right: 10pt" onload="Page.OnLoad('../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html');"><header id="wwconnect_header"><div><table width="100%" align="center" summary=""><tr><td class="Header_Left"><img alt="NVIDIA Tegra" src="images/NVLogo_2D_H.jpg" width="204" height="44" border="0" /></td><td class="Header_Right"><div>NVIDIA Tegra Linux Driver Package</div><br />
           Development Guide <br /><font size="-1"><div>28.2 Release</div></font><br /></td></tr></table></div><!--     <br clear="all" />
 --><hr color="#DEE4F0" /><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwpID0E0JM0HA" class="Heading_1">U-Boot Customization</div><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0HM0HA">Requirements</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0SL0HA">Downloading and Building U-Boot</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0BK0HA">Flashing U-Boot Full L4T Image</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0JJ0HA">Flashing U-Boot Only</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0CJ0HA">Changing the eMMC Partition Layout</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E03H0HA">Building the Device Tree Compiler</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0IH0HA">Replacing the Kernel</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0VG0HA">Copying the Root Filesystem</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0TG0HA">Boot Sequence and Sysboot Configuration Files</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0YF0HA">Optimizing U-Boot Boot Time</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0XD0HA">Environment Configuration</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0PC0HA">Debugging U-Boot Environment</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0NC0HA">Interrupting U-Boot</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0GC0HA">Getting Help</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0BC0HA">Listing a Directory Structure</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0FB0HA">Listing the Contents of a Directory</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0EZHA">Printing the U-Boot Environment</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0EUHA">Printing/Setting Environment Variables</a></div></dd></dl></div><div id="wwpID0E0IM0HA" class="Body_Text">U-Boot is the default boot loader for NVIDIA<span style="vertical-align: super">®</span>&nbsp;Tegra<span style="vertical-align: super">®</span>&nbsp;Linux&nbsp;Driver&nbsp;Package (L4T). </div><div id="wwpID0E0HM0HA" class="Heading_2">Requirements</div><div id="wwpID0E0GM0HA" class="Body_Text">The software requirements and prerequisites include:</div><div id="wwpID0E0FM0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Linux-based Host System</div><div id="wwpID0E0EM0HA" class="List_Continue">Functionality of the U-Boot build and flashing utilities are validated using an Ubuntu <span class="Code_Char">&lt;os_ver_host&gt;</span> host system. Later versions of Ubuntu, or alternative Linux distributions, may work with host-specific modifications.</div><div id="wwpID0E0DM0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Tegra&nbsp;Linux Driver Package (L4T)</div><div id="wwpID0E0CM0HA" class="List_Continue">Download and install the latest L4T package from the Tegra Developer Zone:</div><div id="wwpID0E0BM0HA" class="Code"><span class="Weblink"><a href="http://developer.nvidia.com/linux-tegra" target="external_window">http://developer.nvidia.com/linux-tegra </a></span></div><div id="wwpID0E0AM0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Device Tree Compiler (DTC)</div><div id="wwpID0E06L0HA" class="List_Continue">The DTC is used to compile device tree files contained in the U-Boot source tree. Many of the DTC packages available from standard Linux distribution package management systems, like APT, are not updated with a version of DTC that supports the features required by the U‑Boot makefile. </div><div id="wwpID0E05L0HA" class="List_Continue">For a detailed example of building DTC from source see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E03H0HA" title="U-Boot Customization">Building Device Tree Compiler</a></span>.</div><div id="wwpID0E04L0HA" class="List_Continue">A pre-built DTC binary is included in the kernel directory of the release. This binary is built from the kernel sources in this release. The sources are located in the <span class="Code_Char">scripts/dtc</span> directory. You build DTC by building the kernel <span class="Code_Char">dtbs</span> target.</div><div id="wwpID0E03L0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Download the Linaro Aarch64 toolchain available at:</div><div id="wwpID0E02L0HA" class="Code">https://www.linaro.org/downloads/</div><div id="wwpID0E01L0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>U‑Boot source</div><div id="wwpID0E0ZL0HA" class="List_Continue">For information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0SL0HA" title="U-Boot Customization">Downloading and Building U-Boot</a></span>.</div><div id="wwpID0E0YL0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Kernel source</div><div id="wwpID0E0XL0HA" class="List_Continue">For information, see:</div><div id="wwpID0E0WL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000">•	</span></span><span class="Hyperlink">Setting up the Root File System</span></div><div id="wwpID0E0VL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Hyperlink">Downloading the Kernel Source</span></div><div id="wwpID0E0UL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Hyperlink">Building the NVIDIA Kernel</span></div><div id="wwpID0E0TL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0BK0HA" title="U-Boot Customization">Adding a Compiled Kernel to the Root File System</a></span></div><div id="wwpID0E0SL0HA" class="Heading_2">Downloading and Building U-Boot</div><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0QL0HA">Prerequisite</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0KK0HA">Before Flashing</a></div></dd></dl></div><div id="wwpID0E0RL0HA" class="Body_Text">Before flashing U-Boot to your reference platform, you must download and build it on your Linux host system. NVIDIA offers a Git repository containing the source code for a version of U‑Boot suitable for L4T.</div><div id="wwpID0E0QL0HA" class="Heading_3">Prerequisite</div><div id="wwpID0E0PL0HA" class="Body_Text">Before over-writing the U-Boot binaries with the extracted L4T release package, backup all of the original U-Boot files in:</div><div id="wwpID0E0OL0HA" class="Code">Linux_for_Tegra/bootloader/&lt;platform&gt;/&lt;board_and_rev&gt;/</div><div id="wwpID0E0NL0HA" class="Body_Text">Where:</div><div id="wwpID0E0ML0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;platform&gt;</span> is the SOC name or platform. </div><div id="wwpID0E0LL0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E0KL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E0JL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX2/TX2i: <span class="Code_Char">p2771-0000-500</span></div><div id="wwpID0E0IL0HA" class="Heading_5">To download and build U-Boot</div><div id="wwpID0E0HL0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Perform either of the following options:</div><div id="wwpID0E0GL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command:</div><div id="wwpID0E0FL0HA" class="Code_Indent">$ git clone -n git://nv-tegra.nvidia.com/3rdparty/u-boot.git</div><div id="wwpID0E0EL0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Use the <span class="Code_Char">source_sync.sh</span> script in the L4T release. </div><div id="wwpID0E0DL0HA" class="List_Continue_2">If you run <span class="Code_Char">source_sync.sh -u</span> without parameters, the script prompts for the <span class="Code_Char">&lt;tag_name&gt;</span>, which is the release tag name as provided in the <span class="Emphasis">Release Notes</span>.</div><div id="wwpID0E0CL0HA" class="List_Continue_2">The <span class="Code_Char">-k</span> option to <span class="Code_Char">source_sync</span> syncs the kernel sources. A space between the <span class="Code_Char">-u</span> and <span class="Code_Char">-k</span> options is allowed. By default, if no option is provided, the script syncs the kernel and u-boot sources.</div><div id="wwpID0E0BL0HA" class="List_Continue_2">Also, you can run the script by passing the <span class="Code_Char">&lt;tag_name&gt;</span> as follows:</div><div id="wwpID0E0AL0HA" class="Code_Indent">$ cd &lt;your_L4T_root&gt;/Linux_for_Tegra</div><div id="wwpID0E06K0HA" class="Code_Indent">$ ./source_sync.sh -u &lt;tag_name&gt;</div><div id="wwpID0E05K0HA" class="List_Continue_2">This syncs the source to:</div><div id="wwpID0E04K0HA" class="Code_Indent">&lt;source_sync.sh_location&gt;/sources/u-boot_source </div><div id="wwpID0E03K0HA" class="List_Continue_2">The <span class="Code_Char">&lt;uboot_src_dir&gt;</span> directory becomes:</div><div id="wwpID0E02K0HA" class="Code_Indent">&lt;your_L4T_root&gt;/Linux_for_Tegra/sources/u-boot_source</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA01K0HA" class="Normal" style="margin-top: 8pt"><span style="color: #FFFFFF; font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA01K0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">The rest of these instructions assume your current working directory is the U-Boot source tree.</span></div></td></tr></table></div><div id="wwpID0E0ZK0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Checkout the Git tag name:</div><div id="wwpID0E0YK0HA" class="Code">$ git checkout -b &lt;branch_name&gt; &lt;tag_name&gt;</div><div id="wwpID0E0XK0HA" class="List_Continue">Where:</div><div id="wwpID0E0WK0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;branch_name&gt;</span> is the name of your local branch.</div><div id="wwpID0E0VK0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;tag_name&gt;</span> is the release tag name as provided in the <span class="Emphasis">Release Notes</span>.</div><div id="wwpID0E0UK0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Set the build environment:</div><div id="wwpID0E0TK0HA" class="Code">$ export CROSS_COMPILE=&lt;your_toolchain_location&gt;</div><div id="wwpID0E0SK0HA" class="List_Continue">For example, <span class="Code_Char">export CROSS_COMPILE=aarch64-linux-gnu-</span></div><div id="wwpID0E0RK0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Build U-Boot by executing:</div><div id="wwpID0E0QK0HA" class="Code">$ make distclean</div><div id="wwpID0E0PK0HA" class="Code">$ make &lt;<span class="Hyperlink">board_and_rev</span>&gt;_defconfig</div><div id="wwpID0E0OK0HA" class="Code">$ make</div><div id="wwpID0E0NK0HA" class="List_Continue">Where: <span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E0MK0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">p2371-2180</span></div><div id="wwpID0E0LK0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX2/TX2i: <span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">p2771-0000-500</span></div><div id="wwpID0E0KK0HA" class="Heading_3">Before Flashing</div><div id="wwpID0E0JK0HA" class="Body_Text">Before flashing, you must copy the updated U-Boot to the L4T tree.</div><div id="wwpID0E0IK0HA" class="Heading_5">To copy the updated U-Boot for flashing, to the reference platform</div><div id="wwpID0E0HK0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command on your Linux host system:</div><div id="wwpID0E0GK0HA" class="Code">$ cp &lt;uboot_src_dir&gt;/u-boot{,.bin,.dtb,-dtb.bin} \</div><div id="wwpID0E0FK0HA" class="Code">&lt;your_L4T_root&gt;/Linux_for_Tegra/bootloader/&lt;platform&gt;/&lt;<span class="Hyperlink">board_and_rev</span>&gt;</div><div id="wwpID0E0EK0HA" class="List_Continue">Where <span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E0DK0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">p2371-2180</span></div><div id="wwpID0E0CK0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX2/TX2i: <span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">p2771-0000-500</span></div><div id="wwpID0E0BK0HA" class="Heading_2">Flashing U-Boot Full L4T Image</div><div id="wwpID0E0AK0HA" class="Body_Text">You must flash U-Boot to internal eMMC only. At boot time, U-Boot fetches the boot configuration file, kernel and device tree, which can reside on one of the following storage devices used for boot:</div><div id="wwpID0E06J0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Internal eMMC</div><div id="wwpID0E05J0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>An SD card</div><div id="wwpID0E04J0HA" class="Body_Text">When executing the script that flashes U-Boot, specify a command-line option to identify the storage device containing the root filesystem. This is required so that the appropriate boot configuration file is selected. The boot configuration file contains kernel command line parameters that control where the Linux kernel looks for the root filesystem. </div><div id="wwpID0E03J0HA" class="Heading_5">To flash U-Boot and select the script to mount the root filesystem from internal eMMC</div><div id="wwpID0E02J0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Select a boot configuration file that causes the kernel to mount the root filesystem from internal eMMC:</div><div id="wwpID0E01J0HA" class="Code">$ sudo ./flash.sh &lt;<span class="Hyperlink">platform</span>&gt; mmcblk0p1</div><div id="wwpID0E0ZJ0HA" class="Heading_5">To flash U-Boot and set the script to mount the root filesystem from an SD card</div><div id="wwpID0E0YJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Select a boot configuration file that causes the kernel to mount the root filesystem from an SD card:</div><div id="wwpID0E0XJ0HA" class="Code">$ sudo ./flash.sh &lt;platform&gt; mmcblk1p1</div><div id="wwpID0E0WJ0HA" class="Heading_5">To flash U-Boot and select the script to mount the root filesystem from an NFS server</div><div id="wwpID0E0VJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Select a boot configuration file that causes the kernel to mount the root filesystem from an NFS server:</div><div id="wwpID0E0UJ0HA" class="Code">$ sudo ./flash.sh -N &lt;IPA&gt;:/&lt;<span class="Code_Char">nfs directory</span>&gt; [-n &lt;target IPA&gt;:&lt;host IPA&gt;:&lt;gateway IPA&gt;:&lt;netmask&gt;] &lt;<span class="Hyperlink">platform</span>&gt; &lt;interface name&gt;</div><div id="wwpID0E0TJ0HA" class="List_Continue">Where: </div><div id="wwpID0E0SJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;interface name&gt;</span> is eth0 for RJ45 connector and eth1 for a USB Ethernet dongle.</div><div id="wwpID0E0RJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;IPA&gt;</span> is the NFS server hosting the root filesystem.</div><div id="wwpID0E0QJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;nfs_directory&gt;</span> is the full pathname of exported root filesystem.</div><div id="wwpID0E0PJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;target IPA&gt;</span> is the static IP address for the target device.</div><div id="wwpID0E0OJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;host IPA&gt;</span> is the static IP address for the NFS server.</div><div id="wwpID0E0NJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;gateway IPA&gt;</span> is the static IP address for the gateway.</div><div id="wwpID0E0MJ0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;netmask&gt;</span> is the static netmask for the local network.</div><div id="wwpID0E0LJ0HA" class="Normal" style="margin-top: 8pt">&nbsp;</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0KJ0HA" class="Normal" style="margin-top: 8pt"><span style="color: #FFFFFF; font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0KJ0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">The -n option is recommended on point-to-point network connections where no DHCP server is configured.</span></div></td></tr></table></div><div id="wwpID0E0JJ0HA" class="Heading_2">Flashing U-Boot Only</div><div id="wwpID0E0IJ0HA" class="Body_Text">To flash the full L4T image to the reference platform see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0BK0HA" title="U-Boot Customization">Flashing U-Boot Full L4T Image</a></span> above. To flash a new version of U-Boot, perform the following:</div><div id="wwpID0E0HJ0HA" class="Heading_5">To flash the new U-Boot</div><div id="wwpID0E0GJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command on Jetson TX1:</div><div id="wwpID0E0FJ0HA" class="Code">$ sudo ./flash.sh -k LNX &lt;<span class="Hyperlink">platform</span>&gt; mmcblk0p1</div><div id="wwpID0E0EJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command on Jetson TX2:</div><div id="wwpID0E0DJ0HA" class="Code">$ sudo ./flash.sh -k kernel &lt;platform&gt; mmcblk0p1</div><div id="wwpID0E0CJ0HA" class="Heading_2">Changing the eMMC Partition Layout</div><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E02I0HA">eMMC IC Parameter</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0TI0HA">Root Filesystem Size</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0OI0HA">GPT Partitions</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0II0HA">LNX Partition</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0FI0HA">APP Partition</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0AI0HA">Full Internal eMMC Partition Layout</a></div></dd></dl></div><div id="wwpID0E0BJ0HA" class="Body_Text">This topic is based on eMMC hardware and software layout information in the following files:</div><div id="wwpID0E0AJ0HA" class="Code" style="margin-left: 36pt"><span style="font-size: 8pt">Linux_for_Tegra/&lt;target_board&gt;.conf.common </span></div><div id="wwpID0E06I0HA" class="Code" style="margin-left: 36pt"><span style="font-size: 8pt">Linux_for_Tegra/bootloader/&lt;</span><span class="Code_Char" style="font-size: 8pt">platform</span><span style="font-size: 8pt">&gt;/cfg/gnu_linux_tegraboot_emmc_full.xml</span></div><div id="wwpID0E05I0HA" class="Code" style="margin-left: 36pt"><span style="font-size: 8pt">Linux_for_Tegra/bootloader/&lt;platform&gt;/cfg/flash_l4t_t186.xml</span></div><div id="wwpID0E04I0HA" class="Code">&nbsp;</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA03I0HA" class="Normal" style="margin-top: 8pt"><span style="color: #FFFFFF; font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0ECAA03I0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">The kernel is installed into the filesystem alongside the boot configuration file. </span></div><div id="wwpID0EBAA03I0HA" class="List_Paragraph" style="margin-bottom: 6pt; margin-left: 18pt; margin-top: 6pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">•	</span></span><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">On TX1 and TX2 systems, the kernel (LNX) partition contains U-Boot.</span></div><div id="wwpID0EAAA03I0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">Aside from this difference, U-Boot has the same internal eMMC partition layout as that used by cboot.</span></div></td></tr></table></div><div id="wwpID0E02I0HA" class="Heading_3">eMMC IC Parameter</div><div id="wwpID0E01I0HA" class="Body_Text">The eMMC IC parameter is defined by two variables in the <span class="Code_Char">Linux_for_Tegra/&lt;target_board&gt;.conf.common</span> file to:</div><div id="wwpID0E0ZI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Limit the size of the total usable data area</div><div id="wwpID0E0YI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Determine the location of GPT partitions</div><div id="wwpID0E0XI0HA" class="Body_Text">The eMMC ID parameter includes:</div><div id="wwpID0E0WI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>BOOTPARTSIZE: specifies the eMMC boot partition size which consists of boot0 partition size + boot1 partition size.</div><div id="wwpID0E0VI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>EMMCSIZE: specifies the eMMC usable data size which consists of BOOTPARTSIZE + user partition size.<br /></div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0UI0HA" class="Normal" style="margin-top: 8pt"><span style="color: #FFFFFF; font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0UI0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">boot0, boot1, and user partition size can be obtained from the eMMC device datasheet.</span></div></td></tr></table></div><div id="wwpID0E0TI0HA" class="Heading_3">Root Filesystem Size</div><div id="wwpID0E0SI0HA" class="Body_Text">The root filesystem partition is the largest of the partitions. The size of this partition is one of the key factors in partition layout determination. </div><div id="wwpID0E0RI0HA" class="Heading_5">To modify the root filesystem partition size</div><div id="wwpID0E0QI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Modify the value of the <span class="Code_Char">ROOTFSSIZE</span> variable in the <span class="Code_Char">Linux_for_Tegra/&lt;target_board&gt;.conf.common</span> file.<br /></div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0PI0HA" class="Normal" style="margin-top: 8pt"><span style="color: #FFFFFF; font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0PI0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">The total space used by all partitions cannot exceed EMMCSIZE.</span></div></td></tr></table></div><div id="wwpID0E0OI0HA" class="Heading_3">GPT Partitions</div><div id="wwpID0E0NI0HA" class="Body_Text">The <span class="Code_Char">flash.sh</span> script creates the primary and secondary GPT partitions automatically, based on the internal eMMC partition layout. </div><div id="wwpID0E0MI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The protective MBR contains device information to prevent traditional boot loaders from performing destructive actions. It is located at LBA 0.</div><div id="wwpID0E0LI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The primary GPT partition contains the GUID Partition Table. It is located at LBA 1.</div><div id="wwpID0E0KI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The secondary GPT partition contains the same information as the primary GPT and serves as the backup. It is located at the last LBA of the boot device.</div><div id="wwpID0E0JI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The last Logical Block Address (LBA) varies from device to device. Both U-Boot and the kernel are able to obtain the last LBA.</div><div id="wwpID0E0II0HA" class="Heading_3">LNX Partition</div><div id="wwpID0E0HI0HA" class="Body_Text">The LNX partition nominally contains the kernel. </div><div id="wwpID0E0GI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>On TX1 and TX2 systems, when using U-Boot, this partition is used to contain U-Boot. When U-Boot is used, it reads the kernel from the root filesystem.</div><div id="wwpID0E0FI0HA" class="Heading_3">APP Partition</div><div id="wwpID0E0EI0HA" class="Body_Text">If root filesystem storage is in eMMC, the root filesystem is flashed to this partition. U-Boot expects the boot configuration file and kernel files to exist in the <span class="Code_Char">&lt;rootfs&gt;/boot</span> directory. The <span class="Code_Char">flash.sh</span> flashes the following kernel files in the APP partition:</div><div id="wwpID0E0DI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>kernel (<span class="Code_Char">Image)</span></div><div id="wwpID0E0CI0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Body_Text_Char">boot configuration file</span> (<span class="Code_Char">extlinux/extlinux.conf</span>)<br /></div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0BI0HA" class="Normal" style="margin-top: 8pt"><span style="color: #FFFFFF; font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0BI0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">The flash.sh script treats the root filesystem-on-IP-network configuration as a special case. It flashes these kernel files in the &lt;APP partition&gt;:/boot directory.</span></div></td></tr></table></div><div id="wwpID0E0AI0HA" class="Heading_3">Full Internal eMMC Partition Layout</div><div id="wwpID0E06H0HA" class="Body_Text">For an example of the configuration file, see the following:</div><div id="wwpID0E05H0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>For TX1 systems: <span class="Code_Char">gnu_linux_tegraboot_emmc_full.xml</span> file</div><div id="wwpID0E04H0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>For TX2 systems: <span class="Code_Char">flash_l4t_t186.xml</span> file </div><div id="wwpID0E03H0HA" class="Heading_2">Building the Device Tree Compiler</div><div id="wwpID0E02H0HA" class="Body_Text">The Device Tree Compiler (DTC) must be built from source code. </div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA01H0HA" class="Normal" style="margin-top: 8pt"><span style="color: #FFFFFF; font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA01H0HA" class="Normal" style="margin-bottom: 6pt; margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">If you do not wish to pass in the DTC filename as a parameter to the U Boot environment, ensure a local command path that contains DTC, such as /usr/local/bin or another choice, is at the beginning of the shell command path.</span></div></td></tr></table></div><div id="wwpID0E0ZH0HA" class="Heading_5">To build DTC from source</div><div id="wwpID0E0WH0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Download the DTC source code by executing the following <span class="Code_Char">git clone</span> command:</div><div id="wwpID0E0VH0HA" class="Code">$ git clone git://git.kernel.org/pub/scm/utils/dtc/dtc.git</div><div id="wwpID0E0UH0HA" class="Code">$ cd dtc</div><div id="wwpID0E0TH0HA" class="List_Continue">The rest of this procedure assumes your current working directory is the DTC source tree.</div><div id="wwpID0E0SH0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Build DTC by executing:</div><div id="wwpID0E0RH0HA" class="Code">$ make</div><div id="wwpID0E0QH0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>To install into the default directory <span class="Code_Char">$HOME</span>, execute:</div><div id="wwpID0E0PH0HA" class="Code">$ make install</div><div id="wwpID0E0OH0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>To install to a specific directory, execute:</div><div id="wwpID0E0NH0HA" class="Code">$ make install PREFIX=/usr/local</div><div id="wwpID0E0MH0HA" class="List_Continue">In either case<span class="Body_Text_Char">, the following directories are created </span>below the installation directory:</div><div id="wwpID0E0LH0HA" class="Code">bin</div><div id="wwpID0E0KH0HA" class="Code">lib</div><div id="wwpID0E0JH0HA" class="Code">include</div><div id="wwpID0E0IH0HA" class="Heading_2">Replacing the Kernel</div><div id="wwpID0E0HH0HA" class="Body_Text">You can replace the kernel with your own custom kernel. Use the procedure that applies to the type of storage device from which your device boots.</div><div id="wwpID0E0GH0HA" class="Heading_5">To replace the kernel in systems that boot from internal eMMC</div><div id="wwpID0E0FH0HA" class="Body_Text">These steps can be used in SD card and USB storage device cases.</div><div id="wwpID0E0EH0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Boot the Jetson TX1/TX2/TX2i system.</div><div id="wwpID0E0DH0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Copy the new kernel files, using <span class="Code_Char">scp</span>, into the <span class="Code_Char">/boot</span> directory.</div><div id="wwpID0E0CH0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Reboot the Jetson TX1/TX2/TX2i system.</div><div id="wwpID0E0BH0HA" class="Heading_5">To replace the kernel in systems that boot from an SD Card or USB device</div><div id="wwpID0E0AH0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Connect the SD Card or USB device to your host system.</div><div id="wwpID0E06G0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Copy the new kernel files to the <span class="Code_Char">/boot</span> directory on the SD Card or USB device.</div><div id="wwpID0E05G0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Disconnect the SD Card or USB device from the host system.</div><div id="wwpID0E04G0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Connect the SD Card or USB device to the Jetson TX1/TX2/TX2i system.</div><div id="wwpID0E03G0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>5.	</span></span>Reboot the Jetson TX1/TX2/TX2i system.</div><div id="wwpID0E02G0HA" class="Heading_5">To replace the kernel in systems that boot from an NFS server</div><div id="wwpID0E01G0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Boot the Jetson TX1/TX2/TX2i system.</div><div id="wwpID0E0ZG0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>On the target system enter the following command:</div><div id="wwpID0E0YG0HA" class="Code">$ sudo mount /dev/mmcblk0p1 /mnt</div><div id="wwpID0E0XG0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Copy the new kernel files, using <span class="Code_Char">scp</span>, to the <span class="Code_Char">mnt/boot</span> directory.</div><div id="wwpID0E0WG0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Reboot the Jetson TX1/TX2/TX2i system.</div><div id="wwpID0E0VG0HA" class="Heading_2">Copying the Root Filesystem</div><div id="wwpID0E0UG0HA" class="Body_Text">For external media, you must copy the root filesystem to the device <span class="Strong">after</span> running the <span class="Code_Char">flash.sh</span> command. Then you attach the device to the target system. This is required because the <span class="Code_Char">flash.sh</span> script adds the required files to the root filesystem directory on the host when it runs.</div><div id="wwpID0E0TG0HA" class="Heading_2">Boot Sequence and Sysboot Configuration Files</div><div id="wwpID0E0SG0HA" class="Body_Text">The U-Boot functionality includes a default booting scan sequence. It scans bootable devices in the following order:</div><div id="wwpID0E0RG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>External SD Card</div><div id="wwpID0E0QG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Internal eMMC</div><div id="wwpID0E0PG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>USB Device</div><div id="wwpID0E0OG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>NFS Device</div><div id="wwpID0E0NG0HA" class="Body_Text">It looks for an <span class="Code_Char">extlinux.conf</span> configuration file in the following directory of the bootable partition in the device:</div><div id="wwpID0E0MG0HA" class="Code">&lt;rootfs&gt;/boot/extlinux</div><div id="wwpID0E0LG0HA" class="Body_Text">Upon finding the <span class="Code_Char">extlinux.conf</span> file, U-Boot performs the following.</div><div id="wwpID0E0KG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Uses the <span class="Code_Char">sysboot</span> command to read out boot configuration from <span class="Code_Char">extlinux.conf</span></div><div id="wwpID0E0JG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Loads kernel Image file</div><div id="wwpID0E0IG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Boots the kernel</div><div id="wwpID0E0HG0HA" class="Body_Text">The Image is user-accessible in the <span class="Code_Char">&lt;rootfs&gt;/boot</span> location after booting. The <span class="Code_Char">extlinux.conf</span> file is user accessible in the <span class="Code_Char">&lt;rootfs&gt;/boot/extlinux</span> location. Users can easily change these files to test their own kernel without flashing.</div><div id="wwpID0E0GG0HA" class="Body_Text">The file <span class="Code_Char">extlinux.conf</span> is a standard text-format sysboot configuration file that contains all boot information. It indicates the kernel image filename, the device tree blob filename, and the kernel boot command line. There are four example <span class="Code_Char">extlinux.conf</span> files provided in the L4T release for each supported board:</div><div id="wwpID0E0FG0HA" class="Code">extlinux.conf.emmc</div><div id="wwpID0E0EG0HA" class="Code">extlinux.conf.sdcard</div><div id="wwpID0E0DG0HA" class="Code">extlinux.conf.usb</div><div id="wwpID0E0CG0HA" class="Code">extlinux.conf.nfs</div><div id="wwpID0E0BG0HA" class="Body_Text">During flashing, <span class="Code_Char">flash.sh</span> copies the appropriate variant to the following location on the target:</div><div id="wwpID0E0AG0HA" class="Code">&lt;rootfs&gt;/boot/extlinux/extlinux.conf</div><div id="wwpID0E06F0HA" class="Body_Text">The <span class="Code_Char">extlinux.conf</span> files are very similar, except for different kernel boot command lines. You can find the <span class="Code_Char">extlinux.conf</span> files on your host system at:</div><div id="wwpID0E05F0HA" class="Code">bootloader/<span class="Code_Char">&lt;</span><span class="Hyperlink">platform</span><span class="Code_Char">&gt;/&lt;</span>board<span class="Code_Char">&gt;</span>/</div><div id="wwpID0E04F0HA" class="Body_Text">Where:</div><div id="wwpID0E03F0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;platform&gt;</span> is the SOC name or platform. </div><div id="wwpID0E02F0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board&gt;</span> is:</div><div id="wwpID0E01F0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E0ZF0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX2/TX2i: <span class="Code_Char">p2771-0000</span></div><div id="wwpID0E0YF0HA" class="Heading_2">Optimizing U-Boot Boot Time</div><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0UF0HA">Disabling PCIe Support</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0BF0HA">Enabling/Disabling ASPM Support</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0LE0HA">Disabling USB Support</a></div></dd></dl></div><div id="wwpID0E0XF0HA" class="Body_Text">By default, U-Boot includes a default configuration that enables all supported hardware features. It searches the available devices for boot scripts. This enables out-of-the-box support for the widest possible variety of storage devices and boot configurations.</div><div id="wwpID0E0WF0HA" class="Body_Text">This flexibility delays execution of the final operating system because hardware support takes time to initialize and scanning all attached storage and network devices takes time. In constrained or pre-configured systems, this flexibility may not be necessary. You may know ahead of time, which storage device contains the required files, or that certain devices are not required to be initialized by the boot-loader. To optimize boot time, configure U-Boot to allow for these constraints and reduce system boot time. </div><div id="wwpID0E0VF0HA" class="Body_Text">These changes must be made in the kernel sources.</div><div id="wwpID0E0UF0HA" class="Heading_3">Disabling PCIe Support</div><div id="wwpID0E0TF0HA" class="Body_Text">U-Boot delays enumerating and initializing PCIe devices until the user, or a boot script, explicitly attempts to access a PCIe device. Consequently, disabling PCIe support does not reduce boot time.</div><div id="wwpID0E0SF0HA" class="Heading_5">To disable PCIe support</div><div id="wwpID0E0RF0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Remove the following values from <span class="Code_Char">include/configs/&lt;board&gt;.h</span>:</div><div id="wwpID0E0QF0HA" class="Code_Indent">CONFIG_PCI_EHCI</div><div id="wwpID0E0PF0HA" class="Code_Indent">CONFIG_PCI_TEGRA</div><div id="wwpID0E0OF0HA" class="Code_Indent">CONFIG_CMD_PCI</div><div id="wwpID0E0NF0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Remove the following values from <span class="Code_Char">configs/&lt;board_and_rev&gt;_defconfig</span><span class="Body_Text_Char">:</span></div><div id="wwpID0E0MF0HA" class="Code_Indent">CONFIG_PCI_TEGRA</div><div id="wwpID0E0LF0HA" class="Code_Indent">CONFIG_RTL8169</div><div id="wwpID0E0KF0HA" class="Code_Indent">CONFIG_E1000</div><div id="wwpID0E0JF0HA" class="Body_Text">Where:</div><div id="wwpID0E0IF0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board&gt;</span> is:</div><div id="wwpID0E0HF0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E0GF0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span>Jetson TX2: <span class="Code_Char">p2771-0000</span></div><div id="wwpID0E0FF0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span><span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">Jetson TX2i: </span><span class="Code_Char">p2771-0000-500</span></div><div id="wwpID0E0EF0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E0DF0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E0CF0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span>Jetson TX2/TX2i: <span class="Code_Char">p2771-0000-500</span></div><div id="wwpID0E0BF0HA" class="Heading_3">Enabling/Disabling ASPM Support</div><div id="wwpID0E0AF0HA" class="Body_Text">U-Boot delays enumerating and initializing Active State Power Management (ASPM) PCIe devices until the user, or a boot device, explicitly attempts to access a PCIe ASPM device. Consequently, disabling ASPM support does not reduce boot time.</div><div id="wwpID0E06E0HA" class="Heading_5">To enable ASPM support</div><div id="wwpID0E05E0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Remove the following value from <span class="Code_Char">configs/&lt;board_and_rev&gt;_defconfig</span><span class="Body_Text_Char">:</span></div><div id="wwpID0E04E0HA" class="Code_Indent">CONFIG_PCIEASPM</div><div id="wwpID0E03E0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Add the following value.</div><div id="wwpID0E02E0HA" class="Code_Indent">CONFIG_PCIEASPM_POWERSAVE=y</div><div id="wwpID0E01E0HA" class="Body_Text">Where:</div><div id="wwpID0E0ZE0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E0YE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E0XE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span>Jetson TX2: <span class="Code_Char">p2771-0000-500</span></div><div id="wwpID0E0WE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span><span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">Jetson TX2i: p2771-0000/500</span></div><div id="wwpID0E0VE0HA" class="Heading_5">To disable ASPM support</div><div id="wwpID0E0UE0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Remove the following value from <span class="Code_Char">configs/&lt;board_and_rev&gt;_defconfig</span><span class="Body_Text_Char">:</span></div><div id="wwpID0E0TE0HA" class="Code_Indent">CONFIG_PCIEASPM_POWERSAVE=y </div><div id="wwpID0E0SE0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Add the following value.</div><div id="wwpID0E0RE0HA" class="Code_Indent">CONFIG_PCIEASPM</div><div id="wwpID0E0QE0HA" class="Body_Text">Where:</div><div id="wwpID0E0PE0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E0OE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E0NE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span>Jetson TX2: <span class="Code_Char">p2771-0000-500</span></div><div id="wwpID0E0ME0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span><span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">Jetson TX2i: p2771-0000/500</span></div><div id="wwpID0E0LE0HA" class="Heading_3">Disabling USB Support</div><div id="wwpID0E0KE0HA" class="Body_Text">U-Boot delays enumerating and initializing USB devices until the user, or a boot script, explicitly attempts to access a USB device. Consequently, disabling USB support does not reduce boot time.</div><div id="wwpID0E0JE0HA" class="Heading_5">To disable USB support</div><div id="wwpID0E0IE0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Remove the following values from <span class="Code_Char">configs/&lt;board_and_rev&gt;_defconfig</span>:</div><div id="wwpID0E0HE0HA" class="Code">CONFIG_CMD_USB</div><div id="wwpID0E0GE0HA" class="Code">CONFIG_CMD_USB_MASS_STORAGE</div><div id="wwpID0E0FE0HA" class="Code">CONFIG_USB</div><div id="wwpID0E0EE0HA" class="Code">CONFIG_USB_GADGET</div><div id="wwpID0E0DE0HA" class="Code">CONFIG_USB_GADGET_DOWNLOAD</div><div id="wwpID0E0CE0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Edit <span class="Code_Char">include/configs/&lt;board&gt;.h</span> to remove the <span class="Code_Char">#include</span> of <span class="Code_Char">tegra-common-usb-gadget.h</span>.</div><div id="wwpID0E0BE0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Edit <span class="Code_Char">include/configs/tegra-common-post.h</span> to remove the USB entry from <span class="Code_Char">BOOT_TARGET_DEVICES</span>.</div><div id="wwpID0E0AE0HA" class="List_Continue">Where:</div><div id="wwpID0E06D0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board&gt;</span> is:</div><div id="wwpID0E05D0HA" class="List_Bullet_3"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E04D0HA" class="List_Bullet_3"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span>Jetson TX2: <span class="Code_Char">p2771-0000</span></div><div id="wwpID0E03D0HA" class="List_Bullet_3"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span><span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">Jetson TX2i: p2771-0000/500</span></div><div id="wwpID0E02D0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E01D0HA" class="List_Bullet_3"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char">p2371-2180</span></div><div id="wwpID0E0ZD0HA" class="List_Bullet_3"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span>Jetson TX2: <span class="Code_Char">p2771-0000-500</span></div><div id="wwpID0E0YD0HA" class="List_Bullet_3"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span><span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">Jetson TX2i: p2771-0000/500</span></div><div id="wwpID0E0XD0HA" class="Heading_2">Environment Configuration</div><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0SD0HA">Setting Environment Variables</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0ND0HA">Compile-Time</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E0JD0HA">Manufacturing and Flashing Time</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/uboot_guide.html#wwpID0E06C0HA">extlinux.conf Modifications</a></div></dd></dl></div><div id="wwpID0E0WD0HA" class="Body_Text">U-Boot runtime behavior is controlled by scripts contained in the U-Boot environment. When U-Boot begins execution, it waits for <span class="Code_Char">&lt;bootdelay&gt;</span> seconds before executing the automatic boot sequence. During this time, the user may interrupt the boot process to access the U-Boot shell. If not interrupted, U-Boot executes <span class="Code_Char">&lt;bootcmd&gt;</span> as a shell command. <span class="Code_Char">&lt;bootcmd&gt;</span> contains a series of commands to search storage devices for boot scripts and execute them.</div><div id="wwpID0E0VD0HA" class="Body_Text">By modifying the values of these variables at compile or manufacturing time, U‑Boot can be directed to boot from a specific device in a specific manner, thereby reducing boot time.</div><div id="wwpID0E0UD0HA" class="Body_Text">The following table identifies the variables that can be modified.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 125.65pt"><div id="wwpID0EABI0TD0HA" class="Cell_Heading">Variable</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 265.5pt"><div id="wwpID0EAAI0TD0HA" class="Cell_Heading">Description</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABH0TD0HA" class="Cell_Text">bootdelay</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAH0TD0HA" class="Cell_Text">Contains the number of seconds that U-Boot pauses to determine whether the user wishes to interrupt the boot sequence.</div><div id="wwpID0ECAH0TD0HA" class="Cell_Text">To avoid delay, set to 0.</div><div id="wwpID0EBAH0TD0HA" class="Cell_Text"><span class="Emphasis">Note:</span> Although this value avoids delay, if the user has requested to interrupt the boot process before the U-Boot shell is reached, that request is honored.</div><div id="wwpID0EAAH0TD0HA" class="Cell_Text">If the delay is less than 0, the bootmenu is displayed and autoboot is disabled.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABG0TD0HA" class="Cell_Text">bootcmd</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAG0TD0HA" class="Cell_Text">Contains a sequence of U-Boot shell commands to be executed automatically at boot.</div><div id="wwpID0EAAG0TD0HA" class="Cell_Text">For systems with custom requirements, this value can be completely replaced. However, simple customizations, such as selecting a specific storage device for booting, does not require editing this value.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABF0TD0HA" class="Cell_Text">boot_targets</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EHAF0TD0HA" class="Cell_Text">Contains a space-separated list of storage devices or network protocols that U-Boot scans to find boot scripts.</div><div id="wwpID0EGAF0TD0HA" class="Cell_Text">Valid values include:</div><div id="wwpID0EFAF0TD0HA" class="Cell_Text" style="margin-left: 7.95pt; text-indent: -9pt"><span class="WebWorks_Number" style="width: 9pt"><span>•	</span></span>mmc0 - the built-in eMMC.</div><div id="wwpID0EEAF0TD0HA" class="Cell_Text" style="margin-left: 7.95pt; text-indent: -9pt"><span class="WebWorks_Number" style="width: 9pt"><span>•	</span></span>mmc1 - the SD card slot.</div><div id="wwpID0EDAF0TD0HA" class="Cell_Text" style="margin-left: 7.95pt; text-indent: -9pt"><span class="WebWorks_Number" style="width: 9pt"><span>•	</span></span>usb0 - any attached USB Mass Storage device.</div><div id="wwpID0ECAF0TD0HA" class="Cell_Text" style="margin-left: 7.95pt; text-indent: -9pt"><span class="WebWorks_Number" style="width: 9pt"><span>•	</span></span>pxe - network, using DHCP to receive an IP address, then PXE to download a syslinux configuration file.</div><div id="wwpID0EBAF0TD0HA" class="Cell_Text" style="margin-left: 7.95pt; text-indent: -9pt"><span class="WebWorks_Number" style="width: 9pt"><span>•	</span></span>dhcp - network using DHCP to receive an IP address, then TFTP to download a U-Boot boot script.</div><div id="wwpID0EAAF0TD0HA" class="Cell_Text">This variable can be set to a single specific device, or a more restrictive list than the default.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABE0TD0HA" class="Cell_Text">scan_dev_for_boot_part</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAE0TD0HA" class="Cell_Text">Contains a script to parse the device partition table and determines which partition U-Boot must scan for boot files.</div><div id="wwpID0ECAE0TD0HA" class="Cell_Text">If the partition number is known ahead of time, replace the script with a simpler script that hardcodes the value of &lt;devplist&gt; with a single partition number (represented in hexadecimal), and then runs either or both of the following variables:</div><div id="wwpID0EBAE0TD0HA" class="Cell_Text" style="margin-left: 8.1pt; text-indent: -8.1pt"><span class="WebWorks_Number" style="width: 8.1pt"><span>•	</span></span>scan_dev_for_extlinux or</div><div id="wwpID0EAAE0TD0HA" class="Cell_Text" style="margin-left: 8.1pt; text-indent: -8.1pt"><span class="WebWorks_Number" style="width: 8.1pt"><span>•	</span></span>scan_dev_for_boot_scripts</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD0TD0HA" class="Cell_Text">boot_prefixes</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EFAD0TD0HA" class="Cell_Text">Contains a list of filesystem directories to scan for boot scripts or configuration files.</div><div id="wwpID0EEAD0TD0HA" class="Cell_Text">File system layouts vary between installations.</div><div id="wwpID0EDAD0TD0HA" class="Cell_Text">For example, /boot may be a separate partition containing boot scripts, or part of the root filesystem.</div><div id="wwpID0ECAD0TD0HA" class="Cell_Text">By default, U-Boot searches both locations for boot scripts.</div><div id="wwpID0EBAD0TD0HA" class="Cell_Text">In constrained cases, the user may set this variable to a single directory name so that U-Boot does not search unnecessary directories.</div><div id="wwpID0EAAD0TD0HA" class="Cell_Text">Note: All entries in this variable must contain both a leading and a trailing /.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0TD0HA" class="Cell_Text">scan_dev_for_extlinux</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAC0TD0HA" class="Cell_Text">Contains a script to search for extlinux configuration files. If found, boots the system based on their content.</div><div id="wwpID0EBAC0TD0HA" class="Cell_Text">If the system is known not to use extlinux configuration files, replace this script with commands that do nothing.</div><div id="wwpID0EAAC0TD0HA" class="Cell_Text">For best results, set this variable to an innocuous value, such as “true”, rather than leaving it empty, so that U-Boot does not complain about attempts to execute an empty variable as a script.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0TD0HA" class="Cell_Text">scan_dev_for_scripts</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAB0TD0HA" class="Cell_Text">Contains a script to search for U-Boot boot scripts. If found, loads and executes them.</div><div id="wwpID0ECAB0TD0HA" class="Cell_Text">If the system is known not to use U-Boot boot scripts, replace this script with commands that do nothing.</div><div id="wwpID0EBAB0TD0HA" class="Cell_Text">Note: The default boot scripts execute &lt;scan_dev_for_extlinux&gt; prior to executing &lt;scan_dev_for_scripts&gt;. Therefore, modifying this variable does not affect systems that boot using extlinux configuration files because this script will never be executed.</div><div id="wwpID0EAAB0TD0HA" class="Cell_Text">For best results, set this variable to an innocuous value, such as “true”, rather than leaving it empty, so that U-Boot does not complain about attempts to execute an empty variable as a script.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0TD0HA" class="Cell_Text">boot_scripts</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAA0TD0HA" class="Cell_Text">Contains a space-separated list of U-Boot script names for &lt;scan_dev_for_scripts&gt; to search for. </div><div id="wwpID0EAAA0TD0HA" class="Cell_Text">If the script name is known ahead of time, set this variable to the desired value rather than the default list.</div></td></tr></table></div><div id="wwpID0E0SD0HA" class="Heading_3">Setting Environment Variables</div><div id="wwpID0E0RD0HA" class="Body_Text">You can set environment variable at:</div><div id="wwpID0E0QD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Compile-Time</div><div id="wwpID0E0PD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Manufacturing Time</div><div id="wwpID0E0OD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Flashing Time</div><div id="wwpID0E0ND0HA" class="Heading_3">Compile-Time</div><div id="wwpID0E0MD0HA" class="Body_Text">When U-Boot starts executing, it attempts to initialize the environment variables from data stored in flash memory. The location of the data is determined by the U-Boot configuration file on the board. If the data is missing or corrupted, U-Boot uses the default set of values that are built into the U-Boot binary.</div><div id="wwpID0E0LD0HA" class="Body_Text">The default L4T flashing process does not write this data into flash memory, so the built-in copy is always used initially. The built-in default environment values are set in the following places in the U-Boot source code:</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 161.65pt"><div id="wwpID0EABD0KD0HA" class="Cell_Heading">U-Boot Source Code</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 229.5pt"><div id="wwpID0EAAD0KD0HA" class="Cell_Heading">Variable Value</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0KD0HA" class="Cell_Text">include/config_distro_bootcmd.h</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAC0KD0HA" class="Cell_Text">This file defines the variables and scripts related to the automatic boot process.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0KD0HA" class="Cell_Text">include/config/auto.conf</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB0KD0HA" class="Cell_Text">The value of CONFIG_BOOTDELAY determines the default value of &lt;bootdelay&gt;.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0KD0HA" class="Cell_Text">include/configs/tegra-common-post.h</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EGAA0KD0HA" class="Cell_Text">The value of BOOT_TARGET_DEVICES determines:</div><div id="wwpID0EFAA0KD0HA" class="Cell_Text" style="margin-left: 8.1pt; text-indent: -8.1pt"><span class="WebWorks_Number" style="width: 8.1pt"><span>•	</span></span>The default value of &lt;boot_targets&gt;.</div><div id="wwpID0EEAA0KD0HA" class="Cell_Text" style="margin-left: 8.1pt; text-indent: -8.1pt"><span class="WebWorks_Number" style="width: 8.1pt"><span>•	</span></span>The set of legal values that can appear in &lt;boot_targets&gt;. </div><div id="wwpID0EDAA0KD0HA" class="Cell_Text">Removing entries from this variable prevents the use of those values in &lt;boot_targets&gt; at all.</div><div id="wwpID0ECAA0KD0HA" class="Cell_Text">To modify this value at compile-time:</div><div id="wwpID0EBAA0KD0HA" class="Cell_Text" style="margin-left: 26.1pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt">1.	</span>Modify include/config_distro_bootcmd.h to avoid setting &lt;boot_targets&gt; if the board-specific configuration file has already defined this value.</div><div id="wwpID0EAAA0KD0HA" class="Cell_Text" style="margin-left: 26.1pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt">2.	</span>Modify include/config/&lt;board&gt;.h to set &lt;boot_targets&gt;.</div></td></tr></table></div><div id="wwpID0E0JD0HA" class="Heading_3">Manufacturing and Flashing Time</div><div id="wwpID0E0ID0HA" class="Body_Text">You can modify your manufacturing flow to add an extra step that writes a saved copy of the environment variables to flash. The following provides a set of alternatives to use for modifying your manufacturing flow:</div><div id="wwpID0E0HD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>After flashing the board, arrange for the board to execute U-Boot, and cause U-Boot to execute commands that modify and save the environment:</div><div id="wwpID0E0GD0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Reset the board so that U-Boot runs and sends commands to U-Boot using the serial console. You must write and execute some program on your host system to detect when U-Boot begins executing, interrupt the U-Boot automatic boot process, and then send the commands to U-Boot.</div><div id="wwpID0E0FD0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute a sequence of commands similar to the following:</div><div id="wwpID0E0ED0HA" class="Code_Indent">env default -f -a; setenv boot_targets mmc0; saveenv</div><div id="wwpID0E0DD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Manually edit the U-Boot environment interactively, save the result, and extract the appropriate flash memory region to a file on your host system. Then, modify the L4T partition layout XML file to that the data is written to flash during any subsequent flashing process.</div><div id="wwpID0E0CD0HA" class="List_Continue">Alternatively, apply this technique if your manufacturing process programs flash chips directly, rather than using the L4T flashing tools on each board. You must merge the extracted saved environment data into your flash image file, rather than referencing it from the L4T partition layout XML file.</div><div id="wwpID0E0BD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Generate a set of saved environment data using the U-Boot <span class="Code_Char">fw_env</span> tool located in the tools/env directory in the U-Boot source code. Then, modify the L4T partition layout XML file so that data is written to flash during any subsequent flashing process.</div><div id="wwpID0E0AD0HA" class="List_Continue">Alternatively, apply this technique if your manufacturing process programs flash chips directly, rather than using the L4T flashing tools on each board. You must merge the extracted saved environment data into your flash image file, rather than referencing it from the L4T partition layout XML file.</div><div id="wwpID0E06C0HA" class="Heading_3">extlinux.conf Modifications</div><div id="wwpID0E05C0HA" class="Body_Text">L4T includes an <span class="Code_Char">extlinux.conf</span> file that tells U-Boot which kernel filenames to load. It also includes the command line to pass to the kernel. The file is configured to display a boot menu to the user for 3 seconds before automatically booting. To reduce boot processing time, you can remove this timeout.</div><div id="wwpID0E04C0HA" class="Heading_5">To remove extlinux.conf timeout boot menu</div><div id="wwpID0E03C0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Edit <span class="Code_Char">extlinux.conf</span> file to remove the lines containing the following keywords:</div><div id="wwpID0E02C0HA" class="Code">TIMEOUT</div><div id="wwpID0E01C0HA" class="Code">MENU</div><div id="wwpID0E0ZC0HA" class="List_Continue">On an installed L4T target system, this file is located at:</div><div id="wwpID0E0YC0HA" class="Code">/boot<span class="Code_Char">/extlinux/</span>extlinux.conf</div><div id="wwpID0E0XC0HA" class="List_Continue">Prior to flashing, this file is located in the host L4T flashing directory at</div><div id="wwpID0E0WC0HA" class="Code">bootloader/&lt;platform&gt;/&lt;board_and_rev&gt;/extlinux.conf.emmc</div><div id="wwpID0E0VC0HA" class="List_Continue">Where:</div><div id="wwpID0E0UC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;platform&gt;</span> is the SOC name or platform.</div><div id="wwpID0E0TC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;board_and_rev&gt;</span> is:</div><div id="wwpID0E0SC0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Jetson TX1: <span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">p2371-2180</span></div><div id="wwpID0E0RC0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span>Jetson TX2: <span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">p2771-0000/500</span></div><div id="wwpID0E0QC0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span style="font-family: &quot;Palatino Linotype&quot;">•	</span></span><span class="Code_Char" style="font-family: &quot;Palatino Linotype&quot;">Jetson TX2i: p2771-0000/500</span></div><div id="wwpID0E0PC0HA" class="Heading_2">Debugging U-Boot Environment</div><div id="wwpID0E0OC0HA" class="Body_Text">Use these debugging tips to help you debug your U-Boot environment. These examples do not represent a comprehensive listing of U-Boot functionality. For a full list of supported commands and their usage by U-Boot, consult U-Boot documentation and source.</div><div id="wwpID0E0NC0HA" class="Heading_2">Interrupting U-Boot</div><div id="wwpID0E0MC0HA" class="Body_Text">You can interrupt U-Boot during boot.</div><div id="wwpID0E0LC0HA" class="Heading_5">To interrupt U-Boot</div><div id="wwpID0E0KC0HA" class="List_Number" style="margin-left: 67.5pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Connect a terminal application to the serial port of the board.</div><div id="wwpID0E0JC0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Power on or reset the board.</div><div id="wwpID0E0IC0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Wait for the U-Boot sign on message to appear. Key presses before this point in time may be ignored.</div><div id="wwpID0E0HC0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Press any key to interrupt the automatic boot process.</div><div id="wwpID0E0GC0HA" class="Heading_2">Getting Help</div><div id="wwpID0E0FC0HA" class="Body_Text">On the U‑Boot terminal screen, type <span class="Code_Char">help</span> at any time for the list of supported commands from the U‑Boot terminal.</div><div id="wwpID0E0EC0HA" class="Heading_5">To see the U-Boot Help text</div><div id="wwpID0E0DC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>To see the U-Boot help text enter the following command:</div><div id="wwpID0E0CC0HA" class="Code_Indent"># help</div><div id="wwpID0E0BC0HA" class="Heading_2">Listing a Directory Structure</div><div id="wwpID0E0AC0HA" class="Body_Text">You can list the directory structure of a particular device.</div><div id="wwpID0E06B0HA" class="Heading_5">To list the directory structure</div><div id="wwpID0E05B0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>To list the directory structure of eMMC device 0 partition 1, enter the following command on the target:</div><div id="wwpID0E04B0HA" class="Code"># ls mmc 0:1</div><div id="wwpID0E03B0HA" class="List_Continue">This command functions correctly on EXT2/3/4 and FAT file systems.</div><div id="wwpID0E02B0HA" class="List_Continue">Example output follows:</div><div id="wwpID0E01B0HA" class="Code"> &lt;DIR&gt;       4096 .</div><div id="wwpID0E0ZB0HA" class="Code"> &lt;DIR&gt;       4096 ..</div><div id="wwpID0E0YB0HA" class="Code"> &lt;DIR&gt;       4096 bin</div><div id="wwpID0E0XB0HA" class="Code"> &lt;DIR&gt;       4096 boot</div><div id="wwpID0E0WB0HA" class="Code"> &lt;DIR&gt;       4096 dev</div><div id="wwpID0E0VB0HA" class="Code"> &lt;DIR&gt;       4096 etc</div><div id="wwpID0E0UB0HA" class="Code"> &lt;DIR&gt;       4096 home</div><div id="wwpID0E0TB0HA" class="Code"> &lt;DIR&gt;       4096 lib</div><div id="wwpID0E0SB0HA" class="Code"> &lt;DIR&gt;       4096 lost+found</div><div id="wwpID0E0RB0HA" class="Code"> &lt;DIR&gt;       4096 media</div><div id="wwpID0E0QB0HA" class="Code"> &lt;DIR&gt;       4096 mnt</div><div id="wwpID0E0PB0HA" class="Code"> &lt;DIR&gt;       4096 opt</div><div id="wwpID0E0OB0HA" class="Code"> &lt;DIR&gt;       4096 proc</div><div id="wwpID0E0NB0HA" class="Code"> &lt;DIR&gt;       4096 root</div><div id="wwpID0E0MB0HA" class="Code"> &lt;DIR&gt;       4096 sbin</div><div id="wwpID0E0LB0HA" class="Code"> &lt;DIR&gt;       4096 selinux</div><div id="wwpID0E0KB0HA" class="Code"> &lt;DIR&gt;       4096 srv</div><div id="wwpID0E0JB0HA" class="Code"> &lt;DIR&gt;       4096 sys</div><div id="wwpID0E0IB0HA" class="Code"> &lt;DIR&gt;       4096 tmp</div><div id="wwpID0E0HB0HA" class="Code"> &lt;DIR&gt;       4096 usr</div><div id="wwpID0E0GB0HA" class="Code"> &lt;DIR&gt;       4096 var</div><div id="wwpID0E0FB0HA" class="Heading_2">Listing the Contents of a Directory</div><div id="wwpID0E0EB0HA" class="Body_Text">You can list the contents of any directory.</div><div id="wwpID0E0DB0HA" class="Heading_5">To list the contents of a directory</div><div id="wwpID0E0CB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>List directory contents with the following command:</div><div id="wwpID0E0BB0HA" class="Code"># ls mmc 0:1 &lt;directory&gt;</div><div id="wwpID0E0AB0HA" class="List_Continue">Where <span class="Code_Char">&lt;directory&gt;</span> is a pathname in the filesystem.</div><div id="wwpID0E6HA" class="List_Continue">For example, to list contents of the <span class="Code_Char">/boot</span> directory where the <span class="Code_Char">Image</span> file should be, (as shown in the example output below), use the following command:</div><div id="wwpID0E5HA" class="Code"># ext2ls mmc 0:1 /boot</div><div id="wwpID0E4HA" class="Code">&lt;DIR&gt; &nbsp; &nbsp; &nbsp; 1024 .</div><div id="wwpID0E3HA" class="Code">&lt;DIR&gt; &nbsp; &nbsp; &nbsp; 1024 ..</div><div id="wwpID0E2HA" class="Code">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;908 extlinux</div><div id="wwpID0E1HA" class="Code">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5910248 Image</div><div id="wwpID0EZHA" class="Heading_2">Printing the U-Boot Environment</div><div id="wwpID0EYHA" class="Body_Text">You can print the entire U‑Boot environment.</div><div id="wwpID0EXHA" class="Heading_5">To print the U-Boot environment</div><div id="wwpID0EWHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command:</div><div id="wwpID0EVHA" class="Code"># printenv</div><div id="wwpID0EUHA" class="Heading_2">Printing/Setting Environment Variables</div><div id="wwpID0ETHA" class="Body_Text">You can print and set environment variables.</div><div id="wwpID0ESHA" class="Heading_5">To print an environment variable</div><div id="wwpID0ERHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command:</div><div id="wwpID0EQHA" class="Code"># printenv &lt;environment_variable&gt;</div><div id="wwpID0EPHA" class="List_Continue">Where <span class="Code_Char">&lt;environment_variable&gt;</span> refers to an environment variable in U‑Boot.</div><div id="wwpID0EOHA" class="List_Continue">For example, to print the list of devices U-Boot sends console output to, execute:</div><div id="wwpID0ENHA" class="Code"># printenv stdout</div><div id="wwpID0EMHA" class="List_Continue">Output can be as follows:</div><div id="wwpID0ELHA" class="Code">stdout=serial</div><div id="wwpID0EKHA" class="Heading_5">To set an environment variable</div><div id="wwpID0EJHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command:</div><div id="wwpID0EIHA" class="Code"># setenv &lt;environment_variable&gt; &lt;new_value&gt;</div><div id="wwpID0EHHA" class="List_Continue">Where <span class="Code_Char">&lt;environment_variable&gt;</span> refers to an environment variable in U‑Boot and &lt;new_value&gt; is the new value for that variable. </div><div id="wwpID0EGHA" class="List_Continue">For example, to modify the set of devices that U-Boot sends console output to, execute:</div><div id="wwpID0EFHA" class="Code"># setenv stdout serial</div><div id="wwpID0EEHA" class="Heading_5">To save the modified environment</div><div id="wwpID0EDHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the following command:</div><div id="wwpID0ECHA" class="Code"># saveenv</div><div id="wwpID0EBHA" class="List_Continue">The saved modified environment is preserved in case of resets and reboots.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br /><hr color="#DEE4F0" /><table width="90%" align="center" summary=""><tr><td class="Footer_Left"><font color="gray"><b></b><br />
           Subject to Change | © 2017 by NVIDIA Corporation.
           All rights reserved.
        </font></td><td class="Footer_Right"><font color="gray"><div>PR-06076-R28</div><br /><div style="text-align: center; font-weight: bold;"><div>Revised: 05 Mar 2018 16:32:29</div></div></font></td></tr></table></footer></body></html>