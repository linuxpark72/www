<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--
 * Copyright (c) 2009-2014 NVIDIA CORPORATION.  All rights reserved.
 *
 * NVIDIA Corporation and its licensors retain all intellectual property
 * and proprietary rights in and to this software, related documentation
 * and any modifications thereto.  Any use, reproduction, disclosure or
 * distribution of this software and related documentation without an express
 * license agreement from NVIDIA Corporation is strictly prohibited.
-->
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>L4T Multimedia API Reference: 07_video_convert</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="Nvidia.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="reverb-search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="nv.css" rel="stylesheet" type="text/css" />
<style>
 body {
 background-position: 350px 150px;
 background-image: url(watermark.png);
 background-repeat: no-repeat;
 background-attachment: fixed;
 }
 </style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="99%" border="0" cellspacing="1" cellpadding="1">
  <tbody>
    <tr valign="middle">
      <td rowspan="2" height="44" width="19%">
        <img src="./NVLogo_2D_H.jpg" width="204" height="44"></td>
      <td width="81%" height="44">
        <h2 style="text-align:right">L4T Multimedia API Reference</h2>
        <h4 style="text-align:right">
        28.1 Release</h4>
    </td>
  </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="grp_terms.html"><span>Important&#160;Terms</span></a></li>
      <li><a href="modules.html"><span>API&#160;Modules</span></a></li>
      <li><a href="l4t_mm_test_group.html"><span>Sample&#160;Applications</span></a></li>
      <li><a href="mmapi_tools.html"><span>Tools</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="usergroup0.html"><span>More</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('nvvid_scal_col_group.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">07_video_convert </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#build_and_run">Building and Running</a></li>
<li><a href="#key">Key Structure and Classes</a></li>
</ul>
<hr/>
<p> <a class="anchor" id="overview"></a> </p><h2>Overview</h2>
<p>The video scaling and color format conversion sample demonstrates how to use the libv4l2 video conversion component for image color formatting and buffer layout conversion.</p>
<p>This sample does not require a camera.</p>
<p><a class="anchor" id="build_and_run"></a> </p><hr/>
 <h2>Building and Running</h2>
<h4>Prerequisites</h4>
<ul>
<li>You have followed Steps 1-3 in <a class="el" href="mmapi_build.html">Building and Running</a>.</li>
<li>If you are building from your host Linux PC (x86), you have followed Step 4 in <a class="el" href="mmapi_build.html">Building and Running</a>.</li>
</ul>
<h3>To build:</h3>
<ul>
<li>Enter: <pre class="fragment"> $ cd $HOME/tegra_multimedia_api/samples/07_video_convert
 $ make
</pre></li>
</ul>
<h3>To run</h3>
<ul>
<li>Enter: <pre class="fragment"> $ ./video_convert &lt;in-file&gt; &lt;in-width&gt; &lt;in-height&gt; &lt;in-format&gt; &lt;out-file&gt; &lt;out-width&gt; &lt;out-height&gt; &lt;out-format&gt; [OPTIONS]
</pre></li>
</ul>
<p><a class="anchor" id="flow"></a> </p><h2>Flow</h2>
<p>The following diagram shows the flow of data through the sample.</p>
<div class="image">
<img src="l4t_mm_video_converter.jpg"  alt=" "/>
</div>
<p>The <code>video_convert</code> sample converts color format from YV12 to RGB or NV12 to YV12 etc. NVIDIA<sup>&reg;</sup> Tegra<sup>&reg;</sup> provides pitch linear and block linear memory format support on input and output. Input and output memory formats do not need to match. For example, for YV12 to RGB conversion, set the format argument to <code>YV12</code>. </p><pre class="fragment">ret = ctx.conv0-&gt;setOutputPlaneFormat(ctx.in_pixfmt, \
            ctx.in_width, \
            ctx.in_height, \
            V4L2_NV_BUFFER_LAYOUT_PITCH);
</pre><p>The above call in the sample sets up a libv4l2 output plane, i.e., receiving input YUV data reading from file, as a pitch-linear memory format. For example, for YV12 to RGB conversion, set the format argument to <code>RGB</code>.</p>
<pre class="fragment">ret = ctx.conv0-&gt;setCapturePlaneFormat(ctx.out_pixfmt, \
            ctx.out_width, \
            ctx.out_height, \
            V4L2_NV_BUFFER_LAYOUT_PITCH);
</pre><p>The above call in the sample sets up a libv4l2 capture plane. In this case, it specifies that the libv4l2 capture plane must have pitch-linear memory format, the most common one. Therefore, if the command line indicates the capture plane is instead block-linear (via the <code>--input-nvbl</code> option), the sample adapts to this request by initializing two <code><a class="el" href="classNvVideoConverter.html" title="Defines a helper class for V4L2 Video Converter. ">NvVideoConverter</a></code> objects, where:</p><ul>
<li>First object converts pitch-linear memory format to block-linear memory format. Because the input buffer is block-linear, this object is effectively blocked and the block-linear input buffers are diverted to the second converter. <pre class="fragment"> ret = ctx.conv0-&gt;setCapturePlaneFormat(ctx.in_pixfmt, \
          ctx.in_width, \
          ctx.in_height, \
          V4L2_NV_BUFFER_LAYOUT_BLOCKLINEAR);
</pre></li>
<li>Second object (the main one) converts block-linear memory format to pitch-linear memory format. This allows the pitch-linear output buffer to be dumped to a file. <pre class="fragment">ret = ctx.conv1-&gt;setOutputPlaneFormat(ctx.in_pixfmt, \
        ctx.in_width, \
        ctx.in_height, \
        V4L2_NV_BUFFER_LAYOUT_BLOCKLINEAR);
ret = ctx.conv1-&gt;setCapturePlaneFormat(ctx.out_pixfmt, \
        ctx.out_width, \
        ctx.out_height, \
        V4L2_NV_BUFFER_LAYOUT_PITCH);
</pre></li>
</ul>
<p>The block-linear memory format complies with Tegra hardware.</p>
<p><a class="anchor" id="key"></a> </p><hr/>
 <h2>Key Structure and Classes</h2>
<p><code>v412_videoconvert_test.h</code> exposes the <code>context_t</code> global structure to manage all the resources in the application. The key fields in that structure are:</p><ul>
<li><a href="classNvVideoConverter.html">NvVideoConverter</a> *conv. Performs video format conversion.</li>
<li><code>std::queue &lt; \c NvBuffer * &gt; *conv_output_plane_buf_queue</code>. Holds an output plane queue for the second video converter.</li>
</ul>
<h3>NvVideoDecoder</h3>
<p>The <a href="classNvVideoDecoder.html">NvVideoDecoder</a> class creates a new V4L2 Video Decoder. The following table describes the key NvVideoDecoder members that this sample uses.</p>
<table class="doxtable">
<tr>
<th>Method</th><th>Description  </th></tr>
<tr>
<td><a href="classNvVideoDecoder.html#abc20773d70cfafed881238dfda6046ce">setCapturePlaneFormat</a></td><td>Sets the format on the decoder capture plane. </td></tr>
<tr>
<td><a href="classNvVideoDecoder.html#a7cacbe8afce830495c25514cbd7c8efe">setOutputPlaneFormat</a> </td><td>Sets the format on the decoder output plane. </td></tr>
</table>
<h3>NvVideoConverter</h3>
<p>The <a href="classNvVideoConverter.html">NvVideoConverter</a> class packages all video converting related elements and functions. It performs color space conversion, scaling and conversion between hardware buffer memory and software buffer memory. The following table describes the key NvVideoConverter members that this sample uses.</p>
<table class="doxtable">
<tr>
<th>Member</th><th>Description  </th></tr>
<tr>
<td><a href="classNvV4l2Element.html#aaba251827cef1b23e7c42f776e95fee5">output_plane</a> </td><td>Holds the output plane. </td></tr>
<tr>
<td><a href="classNvV4l2Element.html#a91806d7ed13b4b2c48758e8a02f46c6d">capture_plane</a></td><td>Holds the capture plane. </td></tr>
<tr>
<td><a href="classNvVideoConverter.html#a2f5d1a234427862adf9cae7323b5e24c">waitForIdle</a> </td><td>Waits until all the buffers queued on the output plane are converted and dequeued from the capture plane. This is a blocking method. </td></tr>
<tr>
<td><a href="classNvVideoConverter.html#ad91e70f0e8b5f5a8b4deefa5a26ffe85">setCapturePlaneFormat</a></td><td>Sets the format on the converter capture plane. </td></tr>
<tr>
<td><a href="classNvVideoConverter.html#a38b53f4d1e2c357360893756f417faf6">setOutputPlaneFormat</a> </td><td>Sets the format on the converter output plane. </td></tr>
</table>
<h3>NvV4l2ElementPlane</h3>
<p><a href="group__l4t_mm__nvv4lelementplane__group.html">NvV4l2ElementPlane</a> creates an <a href="classNvV4l2Element.html">NVv4l2Element</a> plane. The following table describes the key NvV4l2ElementPlane members used in this sample.</p>
<table class="doxtable">
<tr>
<th>Member </th><th>Description  </th></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#a89959f455e5222f686187cc826b1b345">setupPlane</a> </td><td>Sets up the plane of V4l2 element. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#af89cfe87d8f818beb0478bcf5b72574c">deinitPlane</a> </td><td>Destroys the plane of V4l2 element. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#a03164dde4d7ab41f3e92b41e13059316">setStreamStatus</a> </td><td>Starts/Stops the stream. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#a37f213325e0e4857180f5b2319317d6a">setDQThreadCallback</a></td><td>Sets the callback function of the <code>dqueue</code> buffer thread. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#a31f77f5e5ed1f320caa44a868a7cbedd">startDQThread</a> </td><td>Starts the thread of the <code>dqueue</code> buffer. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#aa798d14493de321fa90aeab6d944ca87">stopDQThread</a> </td><td>Stops the thread of the <code>dqueue</code> buffer. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#af4d52964fcfd37082f47682e457f5e95">qBuffer</a> </td><td>Queues a V4l2 buffer from the plane. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#a8dfcbc666ee6f36a02abfb1170ae05cd">dqBuffer</a> </td><td>Dequeues a V4l2 buffer from the plane. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#ac5cd394a7e0a4afd69395759aeac8787">getNumBuffers</a> </td><td>Gets the number of the V4l2 buffer. </td></tr>
<tr>
<td><a href="#NvV4l2ElementPlane::getNumQueuedBuffers">getNumQueuedBuffers</a> </td><td>Gets the number of the V4l2 buffer in the queue. </td></tr>
<tr>
<td><a href="classNvV4l2ElementPlane.html#a868d438908f3d267dd4af1033133892f">getNthBuffer</a> </td><td>Gets the <code>NvBuffer</code> queue object at index N. </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->

  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">
        Advance Information | Subject to Change |
        Generated by NVIDIA | Thu Jul 13 2017 18:04:52 |
        PR-07086-R28
      </li>
     </ul>
  </div>
</body>
</html>
