<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Sensor Driver Programming Guide</title><link rel="Prev" href="jetson_tx1_camera_soft_archi.html" title="Previous" /><link rel="Next" href="multimedia.html" title="Next" /><link rel="StyleSheet" href="css/camera_sensor_prog.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/camera_sensor_prog_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN39LBwmXn_002fSXG5jdaYTOlWw" class="ww_skin_page_body" style="background-attachment: scroll; background-image: url(&quot;watermark.png&quot;); background-position: center center; background-repeat: no-repeat; margin-left: 0pt; margin-right: 10pt" onload="Page.OnLoad('../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html');"><header id="wwconnect_header"><div><table width="100%" align="center" summary=""><tr><td class="Header_Left"><img alt="NVIDIA Tegra" src="images/NVLogo_2D_H.jpg" width="204" height="44" border="0" /></td><td class="Header_Right"><div>NVIDIA Tegra Linux Driver Package</div><br />
           Development Guide <br /><font size="-1"><div>28.2 Release</div></font><br /></td></tr></table></div><!--     <br clear="all" />
 --><hr color="#DEE4F0" /><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwpID0E0NY0HA" class="Heading_2_Top">Sensor Driver Programming Guide</div><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0VX0HA">Camera Modules and Device Tree</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0XW0HA">Individual Imaging Device</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0LR0HA">V4L2 Kernel Driver</a></div></dd><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0FR0HA">Macro Definitions</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AR0HA">Sensor-Private Data</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0MQ0HA">Configuring Regmap</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0CQ0HA">Configuring Controls</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0OO0HA">Setting Up Control Registers</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0FO0HA">Read-Write Wrapper in the Register</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AO0HA">Power Functions</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E02N0HA">Setting Up V4L2 Sub-device and Camera Common</a></div></dd></dl><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0TM0HA">Control Handlers</a></div></dd><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0RM0HA">Set Control</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E06K0HA">Get-Volatile Control</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E03K0HA">Boot-Time Initialization</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0VG0HA">Removing Sensor Drivers</a></div></dd></dl><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0IG0HA">Kernel Configuration</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E02F0HA">Device Registration</a></div></dd><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0ZF0HA">Using Plugin Manager</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0XE0HA">Using Main Platform Device Tree File</a></div></dd></dl><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E03D0HA">Verifying the V4L2 Sensor Driver</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0ND0HA">Debugging Tips</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AC0HA">Mode Tables</a></div></dd></dl></div><div id="wwpID0E0MY0HA" class="Body_Text">Implementing the camera sensor driver enables acquisition of camera data over the CSI bus, in the native format, provided by the sensor. </div><div id="wwpID0E0LY0HA" class="Body_Text">There are two types of camera programming paths, depending on the camera and the application. </div><div id="wwpID0E0KY0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Camera Core Library Interface</div><div id="wwpID0E0JY0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Direct V4L2 Interface</div><div id="wwpID0E0IY0HA" class="Heading_5">Camera Core User Mode Library Interface</div><div id="wwpID0E0HY0HA" class="Body_Text">The camera core user mode library provides all the controls and data processing between the application and kernel-mode V4L2 drivers. The typical usecases for using the camera core libray interface include:</div><div id="wwpID0E0GY0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Applications that use the Tegra ISP functionality</div><div id="wwpID0E0FY0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Applications that must convert RGB format to YUV format and perform various post-processing tasks for Bayer sensors</div><div id="wwpID0E0EY0HA" class="Body_Text">The Linux for Tegra architecture framework with the application and kernel mode V4L2 drivers is as follows:</div><div class="ww_skin_page_overflow"><div id="wwpID0E0DY0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/image1.jpg" style="display: inline; left: 0pt; top: 0pt" alt="A screenshot of a cell phone Description generated with high confidence" /></div></div><div id="wwpID0E0CY0HA" class="Body_Text">The Android architecture framework with the application and kernel mode V4L2 drivers is as follows:</div><div class="ww_skin_page_overflow"><div id="wwpID0E0BY0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/image2_2.jpg" style="display: inline; left: 0pt; top: 0pt" alt="A screenshot of a cell phone Description generated with very high confidence" /></div></div><div id="wwpID0E0AY0HA" class="Heading_5">Direct V4L2 Interface</div><div id="wwpID0E06X0HA" class="Body_Text">In applications that support a direct V4L2 interface, use this interface to communicate to the NVIDIA V4L2 driver without having to use the camera core user mode library. Use this path for capturing RAW data from sensor or for validating sensor drivers. </div><div id="wwpID0E05X0HA" class="Body_Text">The application uses the kernel mode V4L2 drivers as follows:</div><div class="ww_skin_page_overflow"><div id="wwpID0E04X0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/image3_2.jpg" style="display: inline; left: 0pt; top: 0pt" alt="A screenshot of a cell phone Description generated with very high confidence" /></div></div><div id="wwpID0E03X0HA" class="Body_Text">Bringing up a Bayer pixel format sensor requires customers to develop:</div><div id="wwpID0E02X0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Device Tree in the kernel </div><div id="wwpID0E01X0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>V4L2 sensor driver</div><div id="wwpID0E0ZX0HA" class="Body_Text">The provided examples use:</div><div id="wwpID0E0YX0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Sony IMX185 sensors</div><div id="wwpID0E0XX0HA" class="Body_Text">The source code is available for:</div><div id="wwpID0E0WX0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Sony IMX185 sensor</div><div id="wwpID0E0VX0HA" class="Heading_3">Camera Modules and Device Tree</div><div id="wwpID0E0UX0HA" class="Body_Text">A camera module installed on the target platform can consist of one or more devices. A typical rear camera module includes a complementary metal-oxide semiconductor (CMOS) sensor. A typical front camera module may include a single CMOS sensor. </div><div id="wwpID0E0TX0HA" class="Heading_5">To add one or more camera modules to a device tree</div><div id="wwpID0E0SX0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Locate or create a <span class="Code_Char">tegra-camera-platform</span> device node in the kernel source tree at:</div><div id="wwpID0E0RX0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E0QX0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t210/jetson/kernel-dts/jetson-platforms/tegra210-camera-imx185-a00.dtsi</div><div id="wwpID0E0PX0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E0OX0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t18x/common/kernel-dts/t18x-common-modules/tegra186-camera-li-mipi-adpt-a00.dtsi</div><div id="wwpID0E0NX0HA" class="List_Continue_2">Where <span class="Code_Char">&lt;top&gt;</span> is the directory where you installed the board support package.</div><div id="wwpID0E0MX0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>In a Tegra-camera-platform device node, create a module table (modules) with one or more modules. </div><div id="wwpID0E0LX0HA" class="List_Continue">Each module must contain its basic information and the definition of the devices that are inside that module.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0KX0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0KX0HA" class="Note_Text">All value fields in camera-related device nodes must use the string data type, except for the files that refer to other device nodes.</div></td></tr></table></div><div id="wwpID0E0JX0HA" class="Body_Text">A typical device-tree node for a camera module is as follows:</div><div id="wwpID0E0IX0HA" class="Code">tegra-camera-platform {</div><div id="wwpID0E0HX0HA" class="Code">    compatible = "nvidia, tegra-camera-platform";</div><div id="wwpID0E0GX0HA" class="Code">    modules {</div><div id="wwpID0E0FX0HA" class="Code">        module0 {</div><div id="wwpID0E0EX0HA" class="Code">            badge = "imx185_bottom_liimx185";</div><div id="wwpID0E0DX0HA" class="Code">		   position = "bottom";</div><div id="wwpID0E0CX0HA" class="Code">		   orientation = "0";</div><div id="wwpID0E0BX0HA" class="Code">		   drivernode0 {</div><div id="wwpID0E0AX0HA" class="Code">                pcl_id = "v4l2_sensor";</div><div id="wwpID0E06W0HA" class="Code">                devname = "imx185 30-001a";</div><div id="wwpID0E05W0HA" class="Code">                proc-device-tree = "/proc/device-tree/i2c@3180000/tca9546@70/i2c@0/imx185_a@1a";</div><div id="wwpID0E04W0HA" class="Code">            };        };</div><div id="wwpID0E03W0HA" class="Code">    };</div><div id="wwpID0E02W0HA" class="Code">};</div><div id="wwpID0E01W0HA" class="Heading_5">Module Properties</div><div id="wwpID0E0ZW0HA" class="Body_Text">The information for <span class="Code_Char">moduleX: module</span> (or <span class="Code_Char">moduleX: modules</span>) is as follows:</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 95.2pt"><div id="wwpID0EABD0YW0HA" class="Cell_Heading">Property</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 306.55pt"><div id="wwpID0EAAD0YW0HA" class="Cell_Heading">Value</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0YW0HA" class="Cell_Text">badge</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EGAC0YW0HA" class="Cell_Text">A unique name that identifies this module.</div><div id="wwpID0EFAC0YW0HA" class="Cell_Text">Guidelines for naming the three parts of the <span class="Code_Char">badge_info</span> property:</div><div id="wwpID0EEAC0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The first part is the camera board ID (<span class="Code_Char">camera_board_id</span>) of the module.</div><div id="wwpID0EDAC0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The second part contains the position of the module, for example, rear or front.</div><div id="wwpID0ECAC0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The third part contains the last six characters of a part number, which you can find in the datasheet on the module from the vendor. If the part number is not available, use a unique identifier.</div><div id="wwpID0EBAC0YW0HA" class="Cell_Text">If your system has multiple modules that are identical, create a unique name for each module.</div><div id="wwpID0EAAC0YW0HA" class="Cell_Text">For example, if you have a rear facing camera, you can call the rear camera module <span class="Code_Char">imx185_rear_liimx185</span>.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0YW0HA" class="Cell_Text">position</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAB0YW0HA" class="Cell_Text">The camera-facing information. The positions supported depends on the number of cameras in the system:</div><div id="wwpID0ECAB0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Two-camera system: <span class="Code_Char">rear</span> and <span class="Code_Char">front</span>.</div><div id="wwpID0EBAB0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Three-camera system: <span class="Code_Char">bottom</span>, <span class="Code_Char">top</span>, and <span class="Code_Char">center</span>.</div><div id="wwpID0EAAB0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Six-camera system: <span class="Code_Char">bottomleft</span>, <span class="Code_Char">bottomright</span>, <span class="Code_Char">centerleft</span>, <span class="Code_Char">centerright</span>, <span class="Code_Char">topleft</span>, and <span class="Code_Char">topright</span>.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0YW0HA" class="Cell_Text">orientation</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAA0YW0HA" class="Cell_Text">An index based orientation for the sensor. When a device has a display with two cameras, typically these indices are used:</div><div id="wwpID0ECAA0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Rear facing: <span class="Code_Char">0</span></div><div id="wwpID0EBAA0YW0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Front facing: <span class="Code_Char">1</span></div><div id="wwpID0EAAA0YW0HA" class="Cell_Text">For additional camera layouts, each camera requires a unique index.</div></td></tr></table></div><div id="wwpID0E0XW0HA" class="Heading_3">Individual Imaging Device</div><div id="wwpID0E0WW0HA" class="Body_Text">An imaging device is a component inside the camera module. It can be a:</div><div id="wwpID0E0VW0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Sensor</div><div id="wwpID0E0UW0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Focuser</div><div id="wwpID0E0TW0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Flash</div><div id="wwpID0E0SW0HA" class="Body_Text">The required information must be added to the device-tree node to support the device operation.</div><div id="wwpID0E0RW0HA" class="Body_Text">For each device-tree node for a device, assign a device node that contains:</div><div id="wwpID0E0QW0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The name of the device</div><div id="wwpID0E0PW0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The slave address for the device</div><div id="wwpID0E0OW0HA" class="List_Continue">The slave address is available in the device datasheet.</div><div id="wwpID0E0NW0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>A compatible string that identifies the node</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0MW0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0MW0HA" class="Note_Text">Except for devices that refer to other device nodes, all value fields in camera-related device nodes must use the string data type.</div></td></tr></table></div><div id="wwpID0E0LW0HA" class="Body_Text">An example device-tree node for the IMX185 V4L2 sensor driver is as follows:</div><div id="wwpID0E0KW0HA" class="Code">imx185_a@1a {</div><div id="wwpID0E0JW0HA" class="Code">compatible = "nvidia,imx185";</div><div id="wwpID0E0IW0HA" class="Code">	reg = &lt;0x1a&gt;;</div><div id="wwpID0E0HW0HA" class="Code">	devnode = "video0";</div><div id="wwpID0E0GW0HA" class="Code">	physical_w = "15.0";</div><div id="wwpID0E0FW0HA" class="Code">	physical_h = "12.5";</div><div id="wwpID0E0EW0HA" class="Code">	sensor_model ="imx185";</div><div id="wwpID0E0DW0HA" class="Code">	post_crop_frame_drop = "0";</div><div id="wwpID0E0CW0HA" class="Code">	use_decibel_gain = "true";</div><div id="wwpID0E0BW0HA" class="Code">	delayed_gain = "true";</div><div id="wwpID0E0AW0HA" class="Code">	use_sensor_mode_id = "true";</div><div id="wwpID0E06V0HA" class="Code">&nbsp;</div><div id="wwpID0E05V0HA" class="Code">	mode0 {</div><div id="wwpID0E04V0HA" class="Code">		mclk_khz = "37125";</div><div id="wwpID0E03V0HA" class="Code">		num_lanes = "4";</div><div id="wwpID0E02V0HA" class="Code">		tegra_sinterface = "serial_a";</div><div id="wwpID0E01V0HA" class="Code">		discontinuous_clk = "no";</div><div id="wwpID0E0ZV0HA" class="Code">		dpcm_enable = "false";</div><div id="wwpID0E0YV0HA" class="Code">		cil_settletime = "0";</div><div id="wwpID0E0XV0HA" class="Code">		dynamic_pixel_bit_depth = "12";</div><div id="wwpID0E0WV0HA" class="Code">		csi_pixel_bit_depth = "12";</div><div id="wwpID0E0VV0HA" class="Code">		mode_type = "bayer";</div><div id="wwpID0E0UV0HA" class="Code">		pixel_phase = "rggb";</div><div id="wwpID0E0TV0HA" class="Code">&nbsp;</div><div id="wwpID0E0SV0HA" class="Code">		active_w = "1920";</div><div id="wwpID0E0RV0HA" class="Code">		active_h = "1080";</div><div id="wwpID0E0QV0HA" class="Code">		readout_orientation = "0";</div><div id="wwpID0E0PV0HA" class="Code">		line_length = "2200";</div><div id="wwpID0E0OV0HA" class="Code">		inherent_gain = "1";</div><div id="wwpID0E0NV0HA" class="Code">		mclk_multiplier = "2";</div><div id="wwpID0E0MV0HA" class="Code">		pix_clk_hz = "74250000";</div><div id="wwpID0E0LV0HA" class="Code">&nbsp;</div><div id="wwpID0E0KV0HA" class="Code">		min_gain_val = "0"; /* dB */</div><div id="wwpID0E0JV0HA" class="Code">		max_gain_val = "48"; /* dB */</div><div id="wwpID0E0IV0HA" class="Code">		min_hdr_ratio = "1";</div><div id="wwpID0E0HV0HA" class="Code">		max_hdr_ratio = "1";</div><div id="wwpID0E0GV0HA" class="Code">		min_framerate = "1.5";</div><div id="wwpID0E0FV0HA" class="Code">		max_framerate = "30";</div><div id="wwpID0E0EV0HA" class="Code">		min_exp_time = "30";</div><div id="wwpID0E0DV0HA" class="Code">		max_exp_time = "660000";</div><div id="wwpID0E0CV0HA" class="Code">		embedded_metadata_height = "1";</div><div id="wwpID0E0BV0HA" class="Code">	};</div><div id="wwpID0E0AV0HA" class="Code">	…</div><div id="wwpID0E06U0HA" class="Code">	ports {</div><div id="wwpID0E05U0HA" class="Code">		#address-cells = &lt;1&gt;;</div><div id="wwpID0E04U0HA" class="Code">		#size-cells = &lt;0&gt;;</div><div id="wwpID0E03U0HA" class="Code">		port@0 {</div><div id="wwpID0E02U0HA" class="Code">			reg = &lt;0&gt;;</div><div id="wwpID0E01U0HA" class="Code">			liimx185_imx185_out0: endpoint {</div><div id="wwpID0E0ZU0HA" class="Code">			csi-port = &lt;0&gt;;</div><div id="wwpID0E0YU0HA" class="Code">			bus-width = &lt;4&gt;;</div><div id="wwpID0E0XU0HA" class="Code">			remote-endpoint = &lt;&amp;liimx185_csi_in0&gt;;</div><div id="wwpID0E0WU0HA" class="Code">		};</div><div id="wwpID0E0VU0HA" class="Code">	};</div><div id="wwpID0E0UU0HA" class="Code">};</div><div id="wwpID0E0TU0HA" class="Heading_5">Device Properties</div><div id="wwpID0E0SU0HA" class="Body_Text">For the device tree node for the V4L2 sensor-device, define the required hardware resource for the device, as follows:</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 116.65pt"><div id="wwpID0EABO0RU0HA" class="Cell_Heading">Property</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 285.1pt"><div id="wwpID0EAAO0RU0HA" class="Cell_Heading">Value</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABN0RU0HA" class="Cell_Text">compatible</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAN0RU0HA" class="Cell_Text">Specifies the device identifier. The Linux kernel uses this keyword to bind the device driver to a specific device.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABM0RU0HA" class="Cell_Text">reg</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAM0RU0HA" class="Cell_Text">Specifies the I2C slave address.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABL0RU0HA" class="Cell_Text">mclk</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAL0RU0HA" class="Cell_Text">Specifies the name of the input clock for the device.</div><div id="wwpID0EBAL0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>On TX1: default MCLK is clk_out_3</div><div id="wwpID0EAAL0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>On TX2: default MCLK is extperiph1</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABK0RU0HA" class="Cell_Text">XXX-gpio</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EKAK0RU0HA" class="Cell_Text">Specifies the general-purpose input/output (GPIO) pins for the device, where XXX is the GPIO pin for the camera.</div><div id="wwpID0EJAK0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>On TX1, the default GPIO pins for camera include:</div><div id="wwpID0EIAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>S4 - Camera0 Reset</div><div id="wwpID0EHAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>S7 - Camera0 Power Down</div><div id="wwpID0EGAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>S5 - Camera1 Reset</div><div id="wwpID0EFAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>T0 - Camera1 Power Down</div><div id="wwpID0EEAK0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>On TX2, the default GPIO pins for camera include:</div><div id="wwpID0EDAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>R5 - Camera0 Reset</div><div id="wwpID0ECAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>R0 - Camera0 Power Down</div><div id="wwpID0EBAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>R1 - Camera1 Reset</div><div id="wwpID0EAAK0RU0HA" class="Cell_Bullet" style="margin-left: 39.6pt"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>L6 - Camera1 Power Down</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABJ0RU0HA" class="Cell_Text">XXX-supply</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EFAJ0RU0HA" class="Cell_Text">Specifies the regulator for the device, where XXX is the actual regulator name defined somewhere else in the device tree. The -supply suffix is mandatory.</div><div id="wwpID0EEAJ0RU0HA" class="Cell_Text">The following are the defined regulators:</div><div id="wwpID0EDAJ0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>vana-supply = &lt;&amp;en_vdd_cam_hv_2v8&gt;; // analog 2.8v </div><div id="wwpID0ECAJ0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>vdig-supply = &lt;&amp;en-vdd-cam_1v2&gt;; // digital 1.2v</div><div id="wwpID0EBAJ0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>vif-supply = &lt;&amp;en-vdd-cam&gt;; // interface 1.8v</div><div id="wwpID0EAAJ0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>vvcm-supply = &lt;&amp;en_vdd_vcm_2v8&gt;; // analog 2.8v for vcm</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABI0RU0HA" class="Cell_Text">XXX-reg</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EFAI0RU0HA" class="Cell_Text">Specifies the name of the regulator, where XXX is the regulator name for the sensor driver. The value of this field is the regulator name with the suffix -reg.</div><div id="wwpID0EEAI0RU0HA" class="Cell_Text">The following are the defined regulators:</div><div id="wwpID0EDAI0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>avdd-reg = “vana”;</div><div id="wwpID0ECAI0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>dvdd-reg = “vdig”</div><div id="wwpID0EBAI0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>iovdd-reg = “vif”</div><div id="wwpID0EAAI0RU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>vcmvdd-reg = “vvcm”</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABH0RU0HA" class="Cell_Text">physical_w</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAH0RU0HA" class="Cell_Text">Specifies the physical width (in millimeters) of the sensor.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABG0RU0HA" class="Cell_Text">physical_h</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAG0RU0HA" class="Cell_Text">Specifies the physical height (in millimeters) of the sensor.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABF0RU0HA" class="Cell_Text">sensor_model*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAF0RU0HA" class="Cell_Text">Specifies which sensor is in this module</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABE0RU0HA" class="Cell_Text">post_crop_frame_drop*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAE0RU0HA" class="Cell_Text">Specifies number of frames to be dropped after applying sensor crop settings.</div><div id="wwpID0EAAE0RU0HA" class="Cell_Text">For more information, refer to the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD0RU0HA" class="Cell_Text">use_decibel_gain*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAD0RU0HA" class="Cell_Text">Use this option for sensors that use decibels to represent the analog gain. When set to true, the analog gain value received by the driver is expressed in decibels (dB), based on the following conversion in the user mode library:</div><div id="wwpID0EBAD0RU0HA" class="Cell_Text">dB = 20 * log(Analog Gain)</div><div id="wwpID0EAAD0RU0HA" class="Cell_Text">For more information, refer to the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0RU0HA" class="Cell_Text">delayed_gain*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAC0RU0HA" class="Cell_Text">Used to delay the gain setting. When set to true, the user mode driver delays sending the updated gain value to the driver by one frame. Default is “false”.</div><div id="wwpID0EAAC0RU0HA" class="Cell_Text">For more information, refer to the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0RU0HA" class="Cell_Text">user_sensor_mode_id*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAB0RU0HA" class="Cell_Text">When set to true, the user mode driver uses TEGRA_CAMERA_CID_SENSOR_MODE_ID control to select a specific sensor mode and bypasses the default mode selection logic. Default is “false”.</div><div id="wwpID0EAAB0RU0HA" class="Cell_Text">For more information, refer to the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top" colspan="2"><div id="wwpID0EBAA0RU0HA" class="Cell_Heading">* Optional</div><div id="wwpID0EAAA0RU0HA" class="Cell_Heading">Properties, in this table, can be specified in different DTSI files. For example, clock, GPIO, and regulator properties can be specified in the platform DTSI file and the rest of the properties can be specified in the sensor DTSI files.</div></td></tr></table></div><div id="wwpID0E0PU0HA" class="Heading_5">Property-Value Pairs</div><div id="wwpID0E0OU0HA" class="Body_Text">The mandatory property-value pairs that apply to the sensor mode for the V4L2 implementation are as follows:</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 139.5pt"><div id="wwpID0EAB0CB00NU0HA" class="Cell_Heading">Property</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 262.25pt"><div id="wwpID0EAA0CB00NU0HA" class="Cell_Heading">Value</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAB0AB00NU0HA" class="Cell_Text">modeX</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAA0AB00NU0HA" class="Cell_Text">Specifies the sensor-mode information, that is, the X: 0-based index.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAB60NU0HA" class="Cell_Text">ports</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBA60NU0HA" class="Cell_Text">Provides the media controller graph binding information.</div><div id="wwpID0EAA60NU0HA" class="Cell_Text">For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0GK0HA" title="Sensor Driver Programming Guide">Port Binding</a></span>.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAB50NU0HA" class="Cell_Text">mclk_khz</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBA50NU0HA" class="Cell_Text">Specifies the standard MIPI driving clock.</div><div id="wwpID0EAA50NU0HA" class="Cell_Text">Unit in KHz.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAB40NU0HA" class="Cell_Text">num_lanes</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAA40NU0HA" class="Cell_Text">Specifies the number of lane channels the sensor is programmed to output.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAB30NU0HA" class="Cell_Text">tegra_sinterface</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAA30NU0HA" class="Cell_Text">Specifies the base Tegra serial interface to which the lanes are connected.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAB20NU0HA" class="Cell_Text">discontinuous_clk</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAA20NU0HA" class="Cell_Text">Specifies the indication that the sensor is programmed to use a discontinuous clock on MIPI lanes.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAB10NU0HA" class="Cell_Text">cil_settletime</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EEA10NU0HA" class="Cell_Text">Specifies the value of the THS-Settle time of the MIPI lane. A 0 value attempts to auto-calibrate according to the <span class="Code_Char">mclk_multiplier</span> parameter.</div><div id="wwpID0EDA10NU0HA" class="Cell_Text">If you are not using auto-calibration, you can calculate the values with the formula:</div><div id="wwpID0ECA10NU0HA" class="Cell_Text">85ns + 6*UI &lt; (cli_settletime + 5) &lt; 145ns + 10*UI.</div><div id="wwpID0EBA10NU0HA" class="Cell_Text">Where UI is the unit interval and is equal to the duration of the HS state on the Clock Lane. </div><div id="wwpID0EAA10NU0HA" class="Cell_Text">Consult the <span class="Hyperlink"><a href="https://www.mipi.org/specifications" target="external_window">MIPI Alliance Specification</a></span> for D-PHY for details.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABZ0NU0HA" class="Cell_Text">dpcm_enable</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAZ0NU0HA" class="Cell_Text">Specifies whether to enable dpcm compression for this mode.</div><div id="wwpID0EAAZ0NU0HA" class="Cell_Text">Set to <span class="Code_Char">true</span> or <span class="Code_Char">false</span>.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABY0NU0HA" class="Cell_Text">active_h</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAY0NU0HA" class="Cell_Text">Specifies the height of the pixel-active region.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABX0NU0HA" class="Cell_Text">active_w</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAX0NU0HA" class="Cell_Text">Specifies the width of the pixel-active region.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBBW0NU0HA" class="Cell_Text">pixel_t</div><div id="wwpID0EABW0NU0HA" class="Cell_Text">Deprecated</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAW0NU0HA" class="Cell_Text">This property is deprecated and replaced with these properties:</div><div id="wwpID0ECAW0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>mode_type</div><div id="wwpID0EBAW0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>csi_pixel_bit_depth</div><div id="wwpID0EAAW0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>pixel_phase</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABV0NU0HA" class="Cell_Text">mode_type</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EEAV0NU0HA" class="Cell_Text">Specifies the sensor mode type. Possible values include:</div><div id="wwpID0EDAV0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>yuv</div><div id="wwpID0ECAV0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>bayer</div><div id="wwpID0EBAV0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>bayer_wdr_pwl - Wide Dynamic Range mode that uses the piece-wise linear function to compress multi exposure fused pixel data. Multi exposure fusion is also performed on the sensor.</div><div id="wwpID0EAAV0NU0HA" class="Cell_Text">For more information, consult the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABU0NU0HA" class="Cell_Text">csi_pixel_bit_depth</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAU0NU0HA" class="Cell_Text">Specifies the bit depth of the final sensor output on the CSI bus.</div><div id="wwpID0EBAU0NU0HA" class="Cell_Text">“mode_type = bayer_wdr_pwl” represents the bit depth output after piece-wise linear function based compression is applied.</div><div id="wwpID0EAAU0NU0HA" class="Cell_Text">For more information, consult to the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABT0NU0HA" class="Cell_Text">dynamic_pixel_bit_depth*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAT0NU0HA" class="Cell_Text">Specifies the true dynamic range of the signal.</div><div id="wwpID0ECAT0NU0HA" class="Cell_Text">For non WDR mode types, this is equal to csi_pixel_bit_depth.</div><div id="wwpID0EBAT0NU0HA" class="Cell_Text">For “mode type = bayer_wdr_pwl”, specifies the bit depth of the multi exposure fused output before piece wise linear function based compression has been applied.</div><div id="wwpID0EAAT0NU0HA" class="Cell_Text">For more information, consult the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABS0NU0HA" class="Cell_Text">pixel_phase*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EJAS0NU0HA" class="Cell_Text">Specifies the sensor pixel phase. Possible values include:</div><div id="wwpID0EIAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>uyvy</div><div id="wwpID0EHAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>vyuy</div><div id="wwpID0EGAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>yuyv</div><div id="wwpID0EFAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>yvyu</div><div id="wwpID0EEAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>rggb</div><div id="wwpID0EDAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>bggr</div><div id="wwpID0ECAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>grbg</div><div id="wwpID0EBAS0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>gbrg</div><div id="wwpID0EAAS0NU0HA" class="Cell_Text">For more information, consult to the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBBR0NU0HA" class="Cell_Text">readout_orientation</div><div id="wwpID0EABR0NU0HA" class="Cell_Text">Applies to: Android</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EFAR0NU0HA" class="Cell_Text">Specifies the readout orientation that is based on the orientation of the camera module. Change this property if you would like to program a different readout order for this mode.</div><div id="wwpID0EEAR0NU0HA" class="Cell_Text">Possible values:</div><div id="wwpID0EDAR0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>0</div><div id="wwpID0ECAR0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>90</div><div id="wwpID0EBAR0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>180</div><div id="wwpID0EAAR0NU0HA" class="Cell_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>270</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABQ0NU0HA" class="Cell_Text">line_length</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAQ0NU0HA" class="Cell_Text">Specifies the pixel line width horizontal timing size  for the sensor mode for calibrating the features in the camera stack.</div><div id="wwpID0EAAQ0NU0HA" class="Cell_Text">This value must be equal or larger than <span class="Code_Char">active_w</span>.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABP0NU0HA" class="Cell_Text">mclk_multiplier</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAP0NU0HA" class="Cell_Text">Specifies the multiplier to MCLK for timing the capture sequence of the hardware. Use the following equation to calculate this value:</div><div id="wwpID0EBAP0NU0HA" class="Cell_Text">mclk_multiplier = desired ISP clock frequency / mclk.</div><div id="wwpID0EAAP0NU0HA" class="Cell_Text">This value must be larger than <span class="Code_Char">pixel_clk_hz / mclk</span> to prevent ISP underrun.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABO0NU0HA" class="Cell_Text">pix_clk_hz</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAO0NU0HA" class="Cell_Text">Specifies the sensor pixel clock for calculating the exposure, frame rate, and so forth.</div><div id="wwpID0EAAO0NU0HA" class="Cell_Text">This value is calculated based on input clock (<span class="Code_Char">mclk</span>) and PLL settings from sensor mode table. Please refer to sensor data sheet for how to calculate this value.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABN0NU0HA" class="Cell_Text">inherent_gain</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAN0NU0HA" class="Cell_Text">Specifies the gain obtained inherently from the mode, that is, pixel binning.</div><div id="wwpID0EAAN0NU0HA" class="Cell_Text">Set to <span class="Code_Char">1</span> if you do not know this value.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABM0NU0HA" class="Cell_Text">min_gain_val</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAM0NU0HA" class="Cell_Text">Specifies the minimum gain limit for the mode. Floor to 6 decimal places.</div><div id="wwpID0EAAM0NU0HA" class="Cell_Text">Usually is 1.0 (1x gain).</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABL0NU0HA" class="Cell_Text">max_gain_val</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAL0NU0HA" class="Cell_Text">Specifies the maximum gain limit for the mode. Floor to 6 decimal places.</div><div id="wwpID0EAAL0NU0HA" class="Cell_Text">If supported by the sensor, it can be increased to include digital gain.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABK0NU0HA" class="Cell_Text">min_exp_time</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EEAK0NU0HA" class="Cell_Text">Specifies the minimum exposure time limit for the mode, in microseconds. Ceiling function to integer.</div><div id="wwpID0EDAK0NU0HA" class="Cell_Text">The equation to calculate this value is as follows:</div><div id="wwpID0ECAK0NU0HA" class="Code">min_exp_time = (minimum coarse integration time) * line_ length / pix_clk_hz * 1000000</div><div id="wwpID0EBAK0NU0HA" class="Cell_Text">&nbsp;</div><div id="wwpID0EAAK0NU0HA" class="Cell_Text"><span class="Code_Char">minimum coarse integration time</span> is the minimum exposure intervals. Unit in lines.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABJ0NU0HA" class="Cell_Text">max_exp_time</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EEAJ0NU0HA" class="Cell_Text">Specifies the maximum exposure time limit for the mode in microseconds. Ceiling function to integer.</div><div id="wwpID0EDAJ0NU0HA" class="Cell_Text">The equation to calculate this value is as follows:</div><div id="wwpID0ECAJ0NU0HA" class="Code">min_exp_time = (maximum coarse integration time) * line_length / pix_clk_hz * 1000000</div><div id="wwpID0EBAJ0NU0HA" class="Cell_Text">&nbsp;</div><div id="wwpID0EAAJ0NU0HA" class="Cell_Text"><span class="Code_Char">minimum coarse integration time</span> is the maximum exposure intervals. Unit in lines.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABI0NU0HA" class="Cell_Text">min_hdr_ratio</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAI0NU0HA" class="Cell_Text">Specifies the minimum high-dynamic-range (HDR) ratio limit for the mode (for interleave HDR sensors).</div><div id="wwpID0EAAI0NU0HA" class="Cell_Text">For non-HDR sensors, set min_hdr_ratio to an empty string.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABH0NU0HA" class="Cell_Text">max_hdr_ratio</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAH0NU0HA" class="Cell_Text">Specifies the maximum HDR ratio limit for the mode (for HDR sensors).</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABG0NU0HA" class="Cell_Text">min_framerate</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAG0NU0HA" class="Cell_Text">Specifies the minimum frame-rate limit for the mode in frames per second (fps). Floor to 6 decimal places.</div><div id="wwpID0EBAG0NU0HA" class="Cell_Text">The equation to calculate this value is as follows:</div><div id="wwpID0EAAG0NU0HA" class="Code">min_framerate = pix_clk_hz / (line_length * maximum frame length)</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABF0NU0HA" class="Cell_Text">max_framerate</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAF0NU0HA" class="Cell_Text">Specifies the maximum frame-rate limit for the mode in fps. Floor to 6 decimal places.</div><div id="wwpID0EBAF0NU0HA" class="Cell_Text">The equation to calculate this value is as follows:</div><div id="wwpID0EAAF0NU0HA" class="Code">max_framerate = pix_clk_hz / (line_length * minimum frame length)</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABE0NU0HA" class="Cell_Text">embedded_metadata_height</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAE0NU0HA" class="Cell_Text">Specifies how many extra embedded metadata rows for each frame.</div><div id="wwpID0EAAE0NU0HA" class="Cell_Text">Set to <span class="Code_Char">0</span> to disable embedded metadata support.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD0NU0HA" class="Cell_Text">num_control_point*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAD0NU0HA" class="Cell_Text">Valid for “mode_type = bayer_wdr_pwl”.</div><div id="wwpID0ECAD0NU0HA" class="Cell_Text">Specifies the number of control points used in the piece-wise linear function used to compress multi exposure fused pixel data. Multi exposure fusion is also performed on the sensor.</div><div id="wwpID0EBAD0NU0HA" class="Cell_Text">Up to 16 control points are supported by the camera core user mode library interface.</div><div id="wwpID0EAAD0NU0HA" class="Cell_Text">For more information, consult the IMX185 Sensor Driver documentation.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0NU0HA" class="Cell_Text">control_point_x_[0..15]*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAC0NU0HA" class="Cell_Text">Valid for “mode_type = bayer_wdr_pwl”.</div><div id="wwpID0EBAC0NU0HA" class="Cell_Text">Specifies the x-coordinate of the N control point from the piece-wise linear compression function.</div><div id="wwpID0EAAC0NU0HA" class="Cell_Text">The value of the x-coordinate cannot exceed 2 to the power of dynamic_pixel_width_depth.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0NU0HA" class="Cell_Text">control_point_y_[0..15]*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0ECAB0NU0HA" class="Cell_Text">Valid for “mode_type = bayer_wdr_pwl”.</div><div id="wwpID0EBAB0NU0HA" class="Cell_Text">Specifies the y-coordinate of the N control point from the piece-wise linear compression function.</div><div id="wwpID0EAAB0NU0HA" class="Cell_Text">The value of the y-coordinate cannot exceed 2 to the power of csi_pixel_width_depth.</div></td></tr><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top" colspan="2"><div id="wwpID0EAAA0NU0HA" class="Cell_Heading">* Alternative to pixel_t when WDR sensor is used.</div></td></tr></table></div><div id="wwpID0E0MU0HA" class="Heading_5">Example Piece-wise Linear Compression Function</div><div id="wwpID0E0LU0HA" class="Body_Text">An example piece-wise linear compression function is as follows:</div><div class="ww_skin_page_overflow"><div id="wwpID0E0KU0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/image4_4.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" /></div></div><div id="wwpID0E0JU0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Input signal has 16-bit depth</div><div id="wwpID0E0IU0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Output signal has 12-bit depth</div><div id="wwpID0E0HU0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">csi_pixel_bit_depth =</span> “12”</div><div id="wwpID0E0GU0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">dynamic_pixel_bit_depth =</span> “16”</div><div id="wwpID0E0FU0HA" class="Body_Text">The control point properties are as follows:</div><div id="wwpID0E0EU0HA" class="Code">num_control_point = "4";</div><div id="wwpID0E0DU0HA" class="Code">control_point_x_0 = "0";</div><div id="wwpID0E0CU0HA" class="Code">control_point_x_1 = "2048";</div><div id="wwpID0E0BU0HA" class="Code">control_point_x_2 = "16384";</div><div id="wwpID0E0AU0HA" class="Code">control_point_x_3 = "65536";</div><div id="wwpID0E06T0HA" class="Code">control_point_y_0 = "0";</div><div id="wwpID0E05T0HA" class="Code">control_point_y_1 = "2048";</div><div id="wwpID0E04T0HA" class="Code">control_point_y_2 = "2944";</div><div id="wwpID0E03T0HA" class="Code">control_point_y_3 = "3712";</div><div id="wwpID0E02T0HA" class="Heading_5">Port Binding</div><div id="wwpID0E01T0HA" class="Code">	vi {</div><div id="wwpID0E0ZT0HA" class="Code">		num-channels = &lt;1&gt;;</div><div id="wwpID0E0YT0HA" class="Code">		ports {</div><div id="wwpID0E0XT0HA" class="Code">			#address-cells = &lt;1&gt;;</div><div id="wwpID0E0WT0HA" class="Code">			#size-cells = &lt;0&gt;;</div><div id="wwpID0E0VT0HA" class="Code">			port@0 {</div><div id="wwpID0E0UT0HA" class="Code">				reg = &lt;0&gt;;</div><div id="wwpID0E0TT0HA" class="Code">				liimx185_vi_in0: endpoint {</div><div id="wwpID0E0ST0HA" class="Code">					csi-port = &lt;2&gt;;</div><div id="wwpID0E0RT0HA" class="Code">					bus-width = &lt;2&gt;;</div><div id="wwpID0E0QT0HA" class="Code">					remote-endpoint = &lt;&amp;liimx185_csi_out0&gt;;</div><div id="wwpID0E0PT0HA" class="Code">				};</div><div id="wwpID0E0OT0HA" class="Code">			};</div><div id="wwpID0E0NT0HA" class="Code">		};</div><div id="wwpID0E0MT0HA" class="Code">	};</div><div id="wwpID0E0LT0HA" class="Code">&nbsp;</div><div id="wwpID0E0KT0HA" class="Code">nvcsi {</div><div id="wwpID0E0JT0HA" class="Code">	num-channels = &lt;1&gt;;</div><div id="wwpID0E0IT0HA" class="Code">	#address-cells = &lt;1&gt;;</div><div id="wwpID0E0HT0HA" class="Code">	#size-cells = &lt;0&gt;;</div><div id="wwpID0E0GT0HA" class="Code">	channel@0 {</div><div id="wwpID0E0FT0HA" class="Code">		reg = &lt;0&gt;;</div><div id="wwpID0E0ET0HA" class="Code">		ports {</div><div id="wwpID0E0DT0HA" class="Code">			#address-cells = &lt;1&gt;;</div><div id="wwpID0E0CT0HA" class="Code">			#size-cells = &lt;0&gt;;</div><div id="wwpID0E0BT0HA" class="Code">			port@0 {</div><div id="wwpID0E0AT0HA" class="Code">				reg = &lt;0&gt;;</div><div id="wwpID0E06S0HA" class="Code">				liimx185_csi_in0: endpoint@0 {</div><div id="wwpID0E05S0HA" class="Code">					csi-port = &lt;0&gt;;</div><div id="wwpID0E04S0HA" class="Code">					bus-width = &lt;4&gt;;</div><div id="wwpID0E03S0HA" class="Code">					remote-endpoint = &lt;&amp;liimx185_imx185_out0&gt;;</div><div id="wwpID0E02S0HA" class="Code">				};</div><div id="wwpID0E01S0HA" class="Code">			};</div><div id="wwpID0E0ZS0HA" class="Code">			port@1 {</div><div id="wwpID0E0YS0HA" class="Code">				reg = &lt;1&gt;;</div><div id="wwpID0E0XS0HA" class="Code">				liimx185_csi_out0: endpoint@1 {</div><div id="wwpID0E0WS0HA" class="Code">					remote-endpoint = &lt;&amp;liimx185_vi_in0&gt;;</div><div id="wwpID0E0VS0HA" class="Code">				};</div><div id="wwpID0E0US0HA" class="Code">			};</div><div id="wwpID0E0TS0HA" class="Code">		};</div><div id="wwpID0E0SS0HA" class="Code">	};</div><div id="wwpID0E0RS0HA" class="Body_Text">The port binding properties are as follows:</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 112.15pt"><div id="wwpID0EABE0QS0HA" class="Cell_Heading">Function</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 289.6pt"><div id="wwpID0EAAE0QS0HA" class="Cell_Heading">Description</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD0QS0HA" class="Cell_Text">port</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAD0QS0HA" class="Cell_Text">Specifies the mediapad port connection. All imager devices have one media pad for binding the connection with VI.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0QS0HA" class="Cell_Text">csi-port</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAC0QS0HA" class="Cell_Text">Defines the CSI port sensor connection. For imager devices, such as focuser or flash, this field is not required.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0QS0HA" class="Cell_Text">bus-width</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB0QS0HA" class="Cell_Text">Defines the bus width by identifying the number of CSI lanes connected to sensor. </div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0QS0HA" class="Cell_Text">remote-endpoint</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAA0QS0HA" class="Cell_Text">Defines the label for binding two ports. The binding expects one port to be for the sink and the other one is for the source.</div></td></tr></table></div><div id="wwpID0E0PS0HA" class="Heading_5">To verify the port binding result</div><div id="wwpID0E0OS0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Execute the command:</div><div id="wwpID0E0NS0HA" class="Code">sudo media-ctl -p -d /dev/media0</div><div id="wwpID0E0MS0HA" class="List_Continue">The output returned is similar to the following:</div><div id="wwpID0E0LS0HA" class="Code">Media controller API version 0.1.0</div><div id="wwpID0E0KS0HA" class="Code">&nbsp;</div><div id="wwpID0E0JS0HA" class="Code">Media device information</div><div id="wwpID0E0IS0HA" class="Code">------------------------</div><div id="wwpID0E0HS0HA" class="Code">driver          tegra-vi4</div><div id="wwpID0E0GS0HA" class="Code">model           NVIDIA Tegra Video Input Device</div><div id="wwpID0E0FS0HA" class="Code">serial          </div><div id="wwpID0E0ES0HA" class="Code">bus info        </div><div id="wwpID0E0DS0HA" class="Code">hw revision     0x3</div><div id="wwpID0E0CS0HA" class="Code">driver version  0.0.0</div><div id="wwpID0E0BS0HA" class="Code">&nbsp;</div><div id="wwpID0E0AS0HA" class="Code">Device topology</div><div id="wwpID0E06R0HA" class="Code">- entity 1: 150c0000.nvcsi-0 (2 pads, 2 links)</div><div id="wwpID0E05R0HA" class="Code">            type V4L2 subdev subtype Unknown flags 0</div><div id="wwpID0E04R0HA" class="Code">            device node name /dev/v4l-subdev0</div><div id="wwpID0E03R0HA" class="Code">	pad0: Sink</div><div id="wwpID0E02R0HA" class="Code">		&lt;- "imx185 30-001a":0 [ENABLED]</div><div id="wwpID0E01R0HA" class="Code">	pad1: Source</div><div id="wwpID0E0ZR0HA" class="Code">		-&gt; "vi-output, imx185 30-001a":0 [ENABLED]</div><div id="wwpID0E0YR0HA" class="Code">&nbsp;</div><div id="wwpID0E0XR0HA" class="Code">- entity 2: imx185 30-001a (1 pad, 1 link)</div><div id="wwpID0E0WR0HA" class="Code">            type V4L2 subdev subtype Sensor flags 0</div><div id="wwpID0E0VR0HA" class="Code">            device node name /dev/v4l-subdev1</div><div id="wwpID0E0UR0HA" class="Code">	pad0: Source</div><div id="wwpID0E0TR0HA" class="Code">		[fmt:SRGGB12/1920x1080 field:none]</div><div id="wwpID0E0SR0HA" class="Code">		-&gt; "150c0000.nvcsi-0":0 [ENABLED]</div><div id="wwpID0E0RR0HA" class="Code">&nbsp;</div><div id="wwpID0E0QR0HA" class="Code">- entity 3: vi-output, imx185 30-001a (1 pad, 1 link)</div><div id="wwpID0E0PR0HA" class="Code">            type Node subtype V4L flags 0</div><div id="wwpID0E0OR0HA" class="Code">            device node name /dev/video0</div><div id="wwpID0E0NR0HA" class="Code">	pad0: Sink</div><div id="wwpID0E0MR0HA" class="Code">		&lt;- "150c0000.nvcsi-0":1 [ENABLED]</div><div id="wwpID0E0LR0HA" class="Heading_3">V4L2 Kernel Driver</div><div id="wwpID0E0KR0HA" class="Body_Text">This topic is based on the Video for Linux 2 (V4L2) driver for the Sony IMX185 sensor <span class="Code_Char">(imx185.c)</span> at:</div><div id="wwpID0E0JR0HA" class="Code">kernel/kernel-4.4/drivers/media/i2c/imx185.c</div><div id="wwpID0E0IR0HA" class="Body_Text">Examine this source content to obtain a complete understanding of the driver.</div><div id="wwpID0E0HR0HA" class="Body_Text">For information on V4L2 implementation, consult:</div><div id="wwpID0E0GR0HA" class="Code"><span class="Hyperlink"><a href="https://linuxtv.org/downloads/v4l-dvb-apis/" target="external_window">https://linuxtv.org/downloads/v4l-dvb-apis/</a></span></div><div id="wwpID0E0FR0HA" class="Heading_4">Macro Definitions</div><div id="wwpID0E0ER0HA" class="Body_Text">The sensor-specific macro values include:</div><div id="wwpID0E0DR0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The minimum and maximum values for each control.</div><div id="wwpID0E0CR0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The default value for each control.</div><div id="wwpID0E0BR0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The macro values required for sensor timing or general functionality.</div><div id="wwpID0E0AR0HA" class="Heading_4">Sensor-Private Data</div><div id="wwpID0E06Q0HA" class="Body_Text">The structure contains the private data specific to the sensor:</div><div id="wwpID0E05Q0HA" class="Code">struct imx185 {</div><div id="wwpID0E04Q0HA" class="Code">	struct camera_common_power_rail	power;</div><div id="wwpID0E03Q0HA" class="Code">	int	                              numctrls;</div><div id="wwpID0E02Q0HA" class="Code">	struct v4l2_ctrl_handler	      ctrl_handler;</div><div id="wwpID0E01Q0HA" class="Code">	struct i2c_client	                  *i2c_client;</div><div id="wwpID0E0ZQ0HA" class="Code">	struct v4l2_subdev	            *subdev;</div><div id="wwpID0E0YQ0HA" class="Code">	struct media_pad	                  pad;</div><div id="wwpID0E0XQ0HA" class="Code">	u32				            frame_length;</div><div id="wwpID0E0WQ0HA" class="Code">	s32	                              group_hold_prev;</div><div id="wwpID0E0VQ0HA" class="Code">	bool	                              group_hold_en;</div><div id="wwpID0E0UQ0HA" class="Code">	s64                                 last_wdr_et_val;</div><div id="wwpID0E0TQ0HA" class="Code">	struct regmap	                  *regmap;</div><div id="wwpID0E0SQ0HA" class="Code">	struct camera_common_data	      *s_data;</div><div id="wwpID0E0RQ0HA" class="Code">	struct camera_common_pdata	      *pdata;</div><div id="wwpID0E0QQ0HA" class="Code">	struct v4l2_ctrl		            *ctrls[];</div><div id="wwpID0E0PQ0HA" class="Code">};</div><div id="wwpID0E0OQ0HA" class="Body_Text">The sensor properties are as follows:</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 100.85pt"><div id="wwpID0EABN0NQ0HA" class="Cell_Heading">Property</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 300.9pt"><div id="wwpID0EAAN0NQ0HA" class="Cell_Heading">Value</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABM0NQ0HA" class="Cell_Text">power</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAM0NQ0HA" class="Cell_Text">Holds generic power controls, include regulators, clks, and GPIOs.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABL0NQ0HA" class="Cell_Text">numctrls</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAL0NQ0HA" class="Cell_Text">Holds the number of v4l2 controls for the sensor.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABK0NQ0HA" class="Cell_Text">ctrl_handlerr</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAK0NQ0HA" class="Cell_Text">Holds the required v4l2 handler to controls, needed for v4l2 control init.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABJ0NQ0HA" class="Cell_Text">i2c_client</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAJ0NQ0HA" class="Cell_Text">Holds a handle to i2c_client, used to access to sensor i2c client instance.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABI0NQ0HA" class="Cell_Text">subdev</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAI0NQ0HA" class="Cell_Text">Holds a handle for v4l2 sub-device, needed to run subdev operations (ops).</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABH0NQ0HA" class="Cell_Text">pad</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAH0NQ0HA" class="Cell_Text">Holds media pad used for media controller initialization for a device to work as SINK or SOURCE.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABG0NQ0HA" class="Cell_Text">group_hold_prev</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAG0NQ0HA" class="Cell_Text">Holds previous state use by group hold control handler to check for change of state.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABF0NQ0HA" class="Cell_Text">group_hold_en</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAF0NQ0HA" class="Cell_Text">Holds group hold enable flag directly related to group hold control.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABE0NQ0HA" class="Cell_Text">frame_length</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAE0NQ0HA" class="Cell_Text">Holds the previous frame_length value.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD0NQ0HA" class="Cell_Text">reg_map</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAD0NQ0HA" class="Cell_Text">Holds a register map setup for I2C read and write.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0NQ0HA" class="Cell_Text">s_data</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAC0NQ0HA" class="Cell_Text">Holds a handle to common data, see documentation for camera_common_data.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0NQ0HA" class="Cell_Text">pdata</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB0NQ0HA" class="Cell_Text">Holds a handle to common platform data, populated by read Device Tree.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0NQ0HA" class="Cell_Text">ctrls</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAA0NQ0HA" class="Cell_Text">Holds handles to initialized v4l2 controls, dynamic array, MUST BE LAST FIELD.</div></td></tr></table></div><div id="wwpID0E0MQ0HA" class="Heading_4">Configuring Regmap</div><div id="wwpID0E0LQ0HA" class="Body_Text">Depending on the I2C interface of the sensor, you must update the values of <span class="Code_Char">reg_bits</span> and <span class="Code_Char">val_bits</span>.</div><div id="wwpID0E0KQ0HA" class="Code">regmap_config {</div><div id="wwpID0E0JQ0HA" class="Code">    reg_bits = 16;</div><div id="wwpID0E0IQ0HA" class="Code">    val_bits = 8;</div><div id="wwpID0E0HQ0HA" class="Code">};</div><div id="wwpID0E0GQ0HA" class="Body_Text">The <span class="Code_Char">regmap_config</span> properties are as follows:</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 89.65pt"><div id="wwpID0EABC0FQ0HA" class="Cell_Heading">Property</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 312.1pt"><div id="wwpID0EAAC0FQ0HA" class="Cell_Heading">Value</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0FQ0HA" class="Cell_Text">reg_bits </div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB0FQ0HA" class="Cell_Text">Specifies the number of bits needed to represent the I2C register offset.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0FQ0HA" class="Cell_Text">val_bits</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAA0FQ0HA" class="Cell_Text">Specifies the number of bits in the buffer to store data to be transferred over I2C.</div></td></tr></table></div><div id="wwpID0E0DQ0HA" class="Body_Text">Check the vendor register programming table of your sensor to determine the size of <span class="Code_Char">reg_bits</span> and <span class="Code_Char">val_bits</span>.</div><div id="wwpID0E0CQ0HA" class="Heading_4">Configuring Controls</div><div id="wwpID0E0BQ0HA" class="Body_Text">The controls must be linked to the control handlers.</div><div id="wwpID0E0AQ0HA" class="Heading_5">To link the controls to their control handlers</div><div id="wwpID0E06P0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Set up the function pointers as follows:</div><div id="wwpID0E05P0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Point <span class="Code_Char">g_volatile_ctrl</span> to the internal <span class="Code_Char">get</span> volatile control handler of the sensor.</div><div id="wwpID0E04P0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Point <span class="Code_Char">s_ctrl</span> to the internal <span class="Code_Char">set</span> control handler of the sensor.</div><div id="wwpID0E03P0HA" class="Code_Indent">static const struct v4l2_ctrl_ops imx185_ctrl_ops = {</div><div id="wwpID0E02P0HA" class="Code_Indent">    .g_volatile_ctrl = imx185_g_volatile_ctrl,</div><div id="wwpID0E01P0HA" class="Code_Indent">    .s_ctrl = imx185_s_ctrl,</div><div id="wwpID0E0ZP0HA" class="Code_Indent">};</div><div id="wwpID0E0YP0HA" class="Body_Text">The following code example lists the controls and their initialized values. This list is looped through during the <span class="Code_Char">ctrls_init</span> call to initialize each of the controls. Each control is then accessible through the <span class="Code_Char">ctrls</span> handler in the private data. The set of controls defined for IMX185 are the standard ones used by the user-mode library.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0XP0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0XP0HA" class="Note_Text">Additional controls require a change in the user mode library.</div></td></tr></table></div><div id="wwpID0E0WP0HA" class="Body_Text">Three types of controls are defined for the IMX185 sensor.</div><div id="wwpID0E0VP0HA" class="Code"><span style="font-size: 8pt">static struct v4l2_ctrl_config ctrl_config_list[] = {</span></div><div id="wwpID0E0UP0HA" class="Code"><span style="font-size: 8pt">/* Integer Control: setting integer values such as gain, coarse</span></div><div id="wwpID0E0TP0HA" class="Code"><span style="font-size: 8pt"> * time, *and frame length.</span></div><div id="wwpID0E0SP0HA" class="Code"><span style="font-size: 8pt">*/</span></div><div id="wwpID0E0RP0HA" class="Code"><span style="font-size: 8pt">    {</span></div><div id="wwpID0E0QP0HA" class="Code"><span style="font-size: 8pt">        .ops = &amp;imx185_ctrl_ops,         //pointer to control ops</span></div><div id="wwpID0E0PP0HA" class="Code"><span style="font-size: 8pt">                                         //function</span></div><div id="wwpID0E0OP0HA" class="Code">&nbsp;</div><div id="wwpID0E0NP0HA" class="Code"><span style="font-size: 8pt">        .id = TEGRA_CAMERA_CID_GAIN,             //id, defined in </span></div><div id="wwpID0E0MP0HA" class="Code"><span style="font-size: 8pt">                                         //camera_common.h</span></div><div id="wwpID0E0LP0HA" class="Code">&nbsp;</div><div id="wwpID0E0KP0HA" class="Code"><span style="font-size: 8pt">        .name = "Gain",                  //string name of control</span></div><div id="wwpID0E0JP0HA" class="Code"><span style="font-size: 8pt">        .type = V4L2_CTRL_TYPE_INTEGER,  //type of control</span></div><div id="wwpID0E0IP0HA" class="Code"><span style="font-size: 8pt">        .flags = V4L2_CTRL_FLAG_SLIDER,  //control flags</span></div><div id="wwpID0E0HP0HA" class="Code">&nbsp;</div><div id="wwpID0E0GP0HA" class="Code"><span style="font-size: 8pt">        // The following three are the values that likely need to change</span></div><div id="wwpID0E0FP0HA" class="Code">&nbsp;</div><div id="wwpID0E0EP0HA" class="Code"><span style="font-size: 8pt">        .min = 0 * FIXED POINT SCALING FACTOR,     //control value lower bound</span></div><div id="wwpID0E0DP0HA" class="Code"><span style="font-size: 8pt">        .max = 48 * FIXED POINT SCALING FACTOR,    //control value upper bound</span></div><div id="wwpID0E0CP0HA" class="Code"><span style="font-size: 8pt">        .def = 0 * FIXED POINT SCALING FACTOR,     //default control value</span></div><div id="wwpID0E0BP0HA" class="Code"><span style="font-size: 8pt">        .step = 3 * FIXED POINT SCALING FACTOR, / 10,                                 //increment step size for //value</span></div><div id="wwpID0E0AP0HA" class="Code">&nbsp;</div><div id="wwpID0E06O0HA" class="Code"><span style="font-size: 8pt">/* Menu Control: used as on/off switch for group hold and HDR.</span></div><div id="wwpID0E05O0HA" class="Code"><span style="font-size: 8pt"> * switch_ctrl_qmenu is used to define the states on/off. There</span></div><div id="wwpID0E04O0HA" class="Code"><span style="font-size: 8pt"> * shouldn't be a need to change these controls, unless a </span></div><div id="wwpID0E03O0HA" class="Code"><span style="font-size: 8pt"> * completely new one is being added.</span></div><div id="wwpID0E02O0HA" class="Code"><span style="font-size: 8pt">*/</span></div><div id="wwpID0E01O0HA" class="Code"><span style="font-size: 8pt">    {</span></div><div id="wwpID0E0ZO0HA" class="Code"><span style="font-size: 8pt">        .ops = &amp;imx185_ctrl_ops,</span></div><div id="wwpID0E0YO0HA" class="Code"><span style="font-size: 8pt">        .id = TEGRA_CAMERA_CID_GROUP_HOLD,</span></div><div id="wwpID0E0XO0HA" class="Code"><span style="font-size: 8pt">        .name = "Group Hold",</span></div><div id="wwpID0E0WO0HA" class="Code"><span style="font-size: 8pt">        .type = V4L2_CTRL_TYPE_INTEGER_MENU,</span></div><div id="wwpID0E0VO0HA" class="Code"><span style="font-size: 8pt">        .min = 0,</span></div><div id="wwpID0E0UO0HA" class="Code"><span style="font-size: 8pt">        .max = ARRAY_SIZE(switch_ctrl_qmenu) - 1,</span></div><div id="wwpID0E0TO0HA" class="Code"><span style="font-size: 8pt">        .menu_skip_mask = 0,</span></div><div id="wwpID0E0SO0HA" class="Code"><span style="font-size: 8pt">        .def = 0,</span></div><div id="wwpID0E0RO0HA" class="Code"><span style="font-size: 8pt">        .qmenu_int = switch_ctrl_qmenu,</span></div><div id="wwpID0E0QO0HA" class="Code"><span style="font-size: 8pt">    },</span></div><div id="wwpID0E0PO0HA" class="Code"><span style="font-size: 8pt">};</span></div><div id="wwpID0E0OO0HA" class="Heading_4">Setting Up Control Registers</div><div id="wwpID0E0NO0HA" class="Body_Text">Set up register writes for integer controls with the following functions:</div><div id="wwpID0E0MO0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span> <span class="Code_Char">addr</span> depends on the sensor being used.</div><div id="wwpID0E0LO0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">val</span> is the source from the control handler. </div><div id="wwpID0E0KO0HA" class="Body_Text">Each control handler calls these functions to set up register writes for each of the controls.</div><div id="wwpID0E0JO0HA" class="Code">imx185_get_frame_length_regs</div><div id="wwpID0E0IO0HA" class="Code">imx185_get_coarse_time_regs_shs1</div><div id="wwpID0E0HO0HA" class="Code">imx185_get_coarse_time_regs_shs2</div><div id="wwpID0E0GO0HA" class="Code">imx185_get_gain_reg</div><div id="wwpID0E0FO0HA" class="Heading_4">Read-Write Wrapper in the Register</div><div id="wwpID0E0EO0HA" class="Body_Text">The following functions are wrappers for the read-write interface of the I2C register. For IMX185, use the <span class="Code_Char">regmap</span> interface. However, you can modify these functions for other interfaces.</div><div id="wwpID0E0DO0HA" class="Code">imx185_read_reg</div><div id="wwpID0E0CO0HA" class="Code">imx185_write_reg</div><div id="wwpID0E0BO0HA" class="Code">imx185_write_table</div><div id="wwpID0E0AO0HA" class="Heading_4">Power Functions</div><div id="wwpID0E06N0HA" class="Body_Text">The functions for power-related controls are as follows:</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 112.15pt"><div id="wwpID0EABE05N0HA" class="Cell_Heading">Function</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 289.6pt"><div id="wwpID0EAAE05N0HA" class="Cell_Heading">Description</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD05N0HA" class="Cell_Text">imx185_power_on</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAD05N0HA" class="Cell_Text">Contains the power-on sequence. You must modify this function according to the specification sheets.</div><div id="wwpID0EAAD05N0HA" class="Cell_Text">Calls <span class="Code_Char">regulator_enable()</span> to turn on regulators and use <span class="Code_Char">gpio_set_value()</span> to toggle the GPIO pins.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC05N0HA" class="Cell_Text">imx185_power_off</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAC05N0HA" class="Cell_Text">Contains the power-off sequence. You must modify this function according to the specification sheets.</div><div id="wwpID0EAAC05N0HA" class="Cell_Text">Calls <span class="Code_Char">regulator_enable()</span> to turn on regulators and use <span class="Code_Char">gpio_set_value()</span> to toggle the GPIO pins.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB05N0HA" class="Cell_Text">imx185_power_put</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB05N0HA" class="Cell_Text">Calls <span class="Code_Char">regulator_put</span> () on all regulators.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA05N0HA" class="Cell_Text">imx185_power_get</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAA05N0HA" class="Cell_Text">Calls <span class="Code_Char">camera_common_regulator_get()</span> helper function or <span class="Code_Char">regulator_get()</span> to acquire all regulators.</div></td></tr></table></div><div id="wwpID0E04N0HA" class="Body_Text">The driver must call the <span class="Code_Char">power_get()</span> function first to acquire all regulators prior to calling the <span class="Code_Char">power_on()</span> and <span class="Code_Char">power_off()</span> functions.</div><div id="wwpID0E03N0HA" class="Body_Text">Additionally, the driver must all the <span class="Code_Char">power_put()</span> function to release all regulators when the driver is being released.</div><div id="wwpID0E02N0HA" class="Heading_4">Setting Up V4L2 Sub-device and Camera Common</div><div id="wwpID0E01N0HA" class="Body_Text">The <span class="Code_Char">imx185_s_stream </span>function is mainly for writing mode tables by making calls to register the <span class="Code_Char">write_table</span> function. You set up mode tables in the <span class="Code_Char">imx185_mode_tbls.h</span> file. For details, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AC0HA" title="Sensor Driver Programming Guide">Mode Tables</a></span>.</div><div id="wwpID0E0ZN0HA" class="Body_Text">In addition to writing mode tables and enabling the stream through stream-enable register writes, <span class="Code_Char">imx185_s_stream</span> also writes the initial integer-control values to the register through direct calls to the integer-control handlers. For details, see the section <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0TM0HA" title="Sensor Driver Programming Guide">Control Handlers</a></span>.</div><div id="wwpID0E0YN0HA" class="Code">Control[0].id = TEGRA_CAMERA_CID_GAIN;</div><div id="wwpID0E0XN0HA" class="Code">Control[1].id = TEGRA_CAMERA _CID_FRAME_RATE;</div><div id="wwpID0E0WN0HA" class="Code">Control[2].id = TEGRA_CAMERA _CID_EXPOSURE;</div><div id="wwpID0E0VN0HA" class="Code">err = v4l2_g_ext_ctrls(&amp;priv-&gt;ctrl_handler, &amp;cotrl);</div><div id="wwpID0E0UN0HA" class="Code">err |= imx185_set_gain(priv, control[0].value64);</div><div id="wwpID0E0TN0HA" class="Code">……</div><div id="wwpID0E0SN0HA" class="Body_Text">If a test pattern is supported by the sensor, and you can create a register table for that pattern, you can add a <span class="Code_Char">test_mode</span> flag to write the test-mode table.</div><div id="wwpID0E0RN0HA" class="Body_Text">Camera common is a set of functions that are common to camera drivers of the NVIDIA kernel, to which this driver refers. Camera common sets up most of the V4L2 framework, requiring linkage from the driver as follows:</div><div id="wwpID0E0QN0HA" class="Code">struct camera_common_sensor_ops</div><div id="wwpID0E0PN0HA" class="Code">struct camera_common_data</div><div id="wwpID0E0ON0HA" class="Body_Text">For details on modifying and adding new modes, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AC0HA" title="Sensor Driver Programming Guide">Mode Tables</a></span>.</div><div id="wwpID0E0NN0HA" class="Body_Text">The following code snippets set up the V4L2 sub-devices and camera common for registering the sensor driver with the V4L2 framework. The <span class="Code_Char">s_stream</span> pointer must point to the internal <span class="Code_Char">s_stream</span> function of the sensor; you can leave the other pointers as is.</div><div id="wwpID0E0MN0HA" class="Code">static struct v4l2_subdev_video_ops imx185_subdev_video_ops = {</div><div id="wwpID0E0LN0HA" class="Code">    .s_stream = imx185_s_stream,</div><div id="wwpID0E0KN0HA" class="Code">    ...</div><div id="wwpID0E0JN0HA" class="Code">};</div><div id="wwpID0E0IN0HA" class="Body_Text">You do NOT need to modify this structure:</div><div id="wwpID0E0HN0HA" class="Code">static struct v4l2_subdev_core_ops imx185_subdev_core_ops = {</div><div id="wwpID0E0GN0HA" class="Code">    ...</div><div id="wwpID0E0FN0HA" class="Code">};</div><div id="wwpID0E0EN0HA" class="Body_Text">Match the name for the pointer for the <span class="Code_Char">core</span> and <span class="Code_Char">video</span> operations function with the two from above, as follows:</div><div id="wwpID0E0DN0HA" class="Code">static struct v4l2_subdev_ops imx185_subdev_ops = {</div><div id="wwpID0E0CN0HA" class="Code">    .core = &amp;imx185_subdev_core_ops,</div><div id="wwpID0E0BN0HA" class="Code">    .video = &amp;imx185_subdev_video_ops,</div><div id="wwpID0E0AN0HA" class="Code">};</div><div id="wwpID0E06M0HA" class="Body_Text">During the parsing of the device tree, <span class="Code_Char">of_device_id</span> matches the compatible field with the one in the Device Tree.</div><div id="wwpID0E05M0HA" class="Code">static struct of_device_id imx185_of_match[] = {</div><div id="wwpID0E04M0HA" class="Code">    { .compatible = "nvidia, imx185", },</div><div id="wwpID0E03M0HA" class="Code">    { },</div><div id="wwpID0E02M0HA" class="Code">};</div><div id="wwpID0E01M0HA" class="Body_Text">This structure is required for camera common and you must set up the function pointers appropriately. Link the <span class="Code_Char">power_on</span>, <span class="Code_Char">power_off</span>, <span class="Code_Char">write_reg</span>, and <span class="Code_Char">read_reg</span> functions here:</div><div id="wwpID0E0ZM0HA" class="Code">static struct camera_common_sensor_ops imx185_common_ops = {</div><div id="wwpID0E0YM0HA" class="Code">    .power_on = imx185_power_on,</div><div id="wwpID0E0XM0HA" class="Code">    .power_off = imx185_power_off,</div><div id="wwpID0E0WM0HA" class="Code">    .write_reg = imx185_write_reg,</div><div id="wwpID0E0VM0HA" class="Code">    .read_reg = imx185_read_reg,</div><div id="wwpID0E0UM0HA" class="Code">};</div><div id="wwpID0E0TM0HA" class="Heading_3">Control Handlers</div><div id="wwpID0E0SM0HA" class="Body_Text">This topic describes the control handlers that control the top-level structure and tells the function how many controls the handler is expected to handle.</div><div id="wwpID0E0RM0HA" class="Heading_4">Set Control</div><div id="wwpID0E0QM0HA" class="Body_Text">The set-control function is used to call the desired control handler as follows.</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 206.65pt"><div id="wwpID0EABM0PM0HA" class="Cell_Heading">Controls</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 195.1pt"><div id="wwpID0EAAM0PM0HA" class="Cell_Heading">Operation</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABL0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_GAIN </div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAL0PM0HA" class="Cell_Text">Updates the gain settings. </div><div id="wwpID0EAAL0PM0HA" class="Cell_Text">Unit in ratios. See Gain Control.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABK0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_FRAME_LENGTH or V4L2 CID_FRAME_RATE</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAK0PM0HA" class="Cell_Text">Updates the frame length registers, unit in lines, or updates the frame rate settings, unit in FPS.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBBJ0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_COARSE_TIME or</div><div id="wwpID0EABJ0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_EXPOSURE</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAJ0PM0HA" class="Cell_Text">Updates the coarse integration time registers, unit in lines, or update exposure settings, unit in seconds. See Exposure Control.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABI0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_COARSE_TIME_SHORT*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAI0PM0HA" class="Cell_Text">Updates the short coarse integration time registers. Only available for HDR sensors.</div><div id="wwpID0EAAI0PM0HA" class="Cell_Text">Unit in seconds.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABH0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_GROUP_HOLD*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAH0PM0HA" class="Cell_Text">Provides the sensor group hold (register hold) control for sensors supporting this feature. </div><div id="wwpID0EAAH0PM0HA" class="Cell_Text">True or False.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABG0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_HDR_ENABLE*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAG0PM0HA" class="Cell_Text">Toggles between normal and HDR sensor mode. Only available for HDR sensors. </div><div id="wwpID0EAAG0PM0HA" class="Cell_Text">True of False.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABF0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_OTP_DATA*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAF0PM0HA" class="Cell_Text">Reads the module One-Time Programmable (OTP) memory data.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABE0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_FUSE_ID*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAE0PM0HA" class="Cell_Text">Reads the sensor fuse ID.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABD0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_SENSOR_MODE_ID*</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBAD0PM0HA" class="Cell_Text">Used for selecting specific sensor mode. </div><div id="wwpID0EAAD0PM0HA" class="Cell_Text">0 based index.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABC0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_VI_BYPASS_MODE**</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAC0PM0HA" class="Cell_Text">Used for bypassing VI settings in kernel driver. Set to true by default when using user mode library.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0PM0HA" class="Cell_Text">TEGRA_CAMERA_CID_OVERRIDE_ENABLE**</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB0PM0HA" class="Cell_Text">Used for overriding gain and exposure settings from default sensor mode table.</div></td></tr><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top" colspan="2"><div id="wwpID0EBAA0PM0HA" class="Cell_Heading">* Optional</div><div id="wwpID0EAAA0PM0HA" class="Cell_Heading">** Provided by NVIDIA V4L2 Media Controller Framework kernel driver. </div></td></tr></table></div><div id="wwpID0E0OM0HA" class="Heading_5">Gain Control</div><div id="wwpID0E0NM0HA" class="Body_Text">The gain control is used to control the per-frame gain setting. It takes a 32 Bit or 64 Bit input value from the user mode library.</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 128.95pt" rowspan="2"><div id="wwpID0EABC0MM0HA" class="Cell_Heading">Control</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 294.4pt" colspan="2"><div id="wwpID0EAAC0MM0HA" class="Cell_Heading">Input</div></td></tr><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 131.6pt"><div id="wwpID0EABB0MM0HA" class="Cell_Heading">32 Bit (deprecated)</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 162.8pt"><div id="wwpID0EAAB0MM0HA" class="Cell_Heading">64 Bit</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 128.95pt"><div id="wwpID0EACA0MM0HA" class="Cell_Text">TEGRA_CAMERA_CID_GAIN</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 131.6pt"><div id="wwpID0ECBA0MM0HA" class="Cell_Text">Specifies the gain values from the user mode library. It uses 24.8 format (24 Bit integer, 8 Bit fraction) as default. </div><div id="wwpID0EBBA0MM0HA" class="Cell_Text">To change this format, adjust the min/max gain range in the driver.</div><div id="wwpID0EABA0MM0HA" class="HTML_Preformatted" style="background-color: #FFFFFF">Use the minimum gain value to determine how many bits of a fraction to use.</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 162.8pt"><div id="wwpID0EDAA0MM0HA" class="Cell_Text">Specifies the gain values from the user mode library.</div><div id="wwpID0ECAA0MM0HA" class="Cell_Text">It uses 42.22 format (42 Bit integer, 22 Bit fraction). *</div><div id="wwpID0EBAA0MM0HA" class="Cell_Text">See <span class="Code_Char">imx185_set_gain</span> function in imx185.c file.</div><div id="wwpID0EAAA0MM0HA" class="Normal">&nbsp;</div></td></tr></table></div><div id="wwpID0E0LM0HA" class="Heading_5">Exposure Control</div><div id="wwpID0E0KM0HA" class="Body_Text">The exposure updated is achieved by using one of these controls:</div><div id="wwpID0E0JM0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>For 32-Bit input parameters use:</div><div id="wwpID0E0IM0HA" class="Code">TEGRA_CAMERA_CID_FRAME_LENGTH + TEGRA_CAMERA_CID_COARSE_TIME (deprecated)</div><div id="wwpID0E0HM0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>For 64-Bit input parameters use:</div><div id="wwpID0E0GM0HA" class="Code">TEGRA_CAMERA_CID_FRAME_RATE + TEGRA_CAMERA_CID_EXPOSURE </div><div class="ww_skin_page_overflow"><table class="Table_Normal" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0FM0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0FM0HA" class="Note_Text">Use either set of controls but do not mix or use both sets at once.</div></td></tr></table></div><div id="wwpID0E0EM0HA" class="Cell_Space_Before">&nbsp;</div><div class="ww_skin_page_overflow"><table class="Table_Grid" style="margin-left: 41.75pt" cellspacing="0" summary=""><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 177.7pt"><div id="wwpID0EABD0DM0HA" class="Cell_Heading">Control</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 224.05pt"><div id="wwpID0EAAD0DM0HA" class="Cell_Heading">Input</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EBBC0DM0HA" class="Cell_Text">TEGRA_CAMERA_CID_FRAME_LENGTH + TEGRA_CAMERA_CID_COARSE_TIME</div><div id="wwpID0EABC0DM0HA" class="Cell_Text">(deprecated)</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EDAC0DM0HA" class="Cell_Text">Specifies the pre-processed 32 Bit value.</div><div id="wwpID0ECAC0DM0HA" class="Cell_Text">The user mode library converts the frame rate to the sensor frame length and converts exposure to sensor coarse integration time.</div><div id="wwpID0EBAC0DM0HA" class="Cell_Text">The driver uses these values to program the frame length and coarse integration time registers.</div><div id="wwpID0EAAC0DM0HA" class="Cell_Text">These controls are deprecated. Use the controls below.</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0DM0HA" class="Cell_Text">TEGRA_CAMERA_CID_FRAME_RATE + V4L2 CID_EXPOSURE</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EEAB0DM0HA" class="Cell_Text">Specifies the unprocessed 64 Bit value*.</div><div id="wwpID0EDAB0DM0HA" class="Cell_Text">The user mode library passes the frame rate and exposure values to the driver without any pre-processing. the driver is responsible for converting these values into frame length and coarse integration time settings.</div><div id="wwpID0ECAB0DM0HA" class="Cell_Text">Use this method if the sensor has special requirements that cannot be handled by the user mode library.</div><div id="wwpID0EBAB0DM0HA" class="Cell_Text">&nbsp;</div><div id="wwpID0EAAB0DM0HA" class="Cell_Text">See <span class="Code_Char">imx185_set_frame_rate</span> and <span class="Code_Char">imx185_set_exposure</span> functions in imx185.c file.</div></td></tr><tr><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top" colspan="2"><div id="wwpID0EAAA0DM0HA" class="Cell_Text">* See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0CQ0HA" title="Sensor Driver Programming Guide">Fixed Point Format</a></span></div></td></tr></table></div><div id="wwpID0E0CM0HA" class="Heading_5">Fixed Point Format</div><div id="wwpID0E0BM0HA" class="Body_Text">When the driver implements <span class="Code_Char">TEGRA_CAMERA_CID_FRAME_RATE</span> and <span class="Code_Char">TEGRA_CAMERA_CID_EXPOSURE</span> controls, the received control values are in Q42.22 fixed point format. In Q42.22 fixed point format the upper 42 Bits are for storing integer values and the lower 22 Bits are for fraction values. This is a workaround due to the lack of a floating point in the kernel.</div><div id="wwpID0E0AM0HA" class="Body_Text">This format is achieved by multiplying the original value with <span class="Code_Char">1 &lt;&lt; 22</span>. The <span class="Code_Char">FIXED_POINT_SCALING_FACTOR</span> value is defined as follows.</div><div id="wwpID0E06L0HA" class="Code">#define FIXED_POINT_SCALING_FACTOR (1ULL &lt;&lt; 22)</div><div id="wwpID0E05L0HA" class="Body_Text">Use these fixed-point format values with caution. The value must be divided back to the original precision for calculation. For best results, multiply first, then divide the value with the <span class="Code_Char">FIXED_POINT_SCALING_FACTOR</span> last, to avoid unexpected precision loss and overflow issues.</div><div id="wwpID0E04L0HA" class="Body_Text">For example, these equations can yield different results:</div><div id="wwpID0E03L0HA" class="Code">Gain8 = (u8) (Gain64 / <span class="Code_Char">FIXED_POINT_SCALING_FACTOR * 160 / 48) // incorrect, precision loss</span></div><div id="wwpID0E02L0HA" class="Code">&nbsp;</div><div id="wwpID0E01L0HA" class="Code"><span class="Code_Char">Gain8 = (u8) (Gain64 * 160 / 48 / FIXED_POINT_SCALING_FACTOR)</span></div><div id="wwpID0E0ZL0HA" class="Code"><span class="Code_Char">// correct</span></div><div id="wwpID0E0YL0HA" class="Heading_5">V4L2 Set-Control Operation</div><div id="wwpID0E0XL0HA" class="Body_Text">The V4L2 set-control function contains a <span class="Code_Char">switch</span> statement to redirect set-control calls to their appropriate control handlers.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 36pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0WL0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 342pt"><div id="wwpID0EAAA0WL0HA" class="Note_Text">Read-only controls, such as <span class="Code_Char">fuse_id</span> and One-Time Programmable Read-Only Memory (OTP ROM), do not have a case statement in the control ID <span class="Code_Char">switch</span> statement.</div></td></tr></table></div><div id="wwpID0E0VL0HA" class="Code">imx185_s_ctrl {</div><div id="wwpID0E0UL0HA" class="Code">    ...</div><div id="wwpID0E0TL0HA" class="Code">    switch (ctrl-&gt;id) {</div><div id="wwpID0E0SL0HA" class="Code">        case <span class="Code_Char">TEGRA_CAMERA</span>_CID_GAIN:</div><div id="wwpID0E0RL0HA" class="Code">            ...</div><div id="wwpID0E0QL0HA" class="Code">        case <span class="Code_Char">TEGRA_CAMERA</span>_CID_EEPROM_DATA:</div><div id="wwpID0E0PL0HA" class="Code">            ...</div><div id="wwpID0E0OL0HA" class="Code">        case <span class="Code_Char">TEGRA_CAMERA</span>_CID_HDR_EN:</div><div id="wwpID0E0NL0HA" class="Code">            ...</div><div id="wwpID0E0ML0HA" class="Code">    }</div><div id="wwpID0E0LL0HA" class="Code">    ...</div><div id="wwpID0E0KL0HA" class="Code">&nbsp;</div><div id="wwpID0E0JL0HA" class="List_Continue"><span class="Code_Char">HDR_EN</span> is a pure software control. No control handler writes to the hardware so simply break out of the switch statement.</div><div id="wwpID0E0IL0HA" class="Heading_5">Setter-Control Handlers (Writes)</div><div id="wwpID0E0HL0HA" class="Body_Text">Setter-control handlers are the control handlers called by <span class="Code_Char">s_ctrl</span>. They perform additional control-handling operations, such as writes to registers. The majority of these controls make calls to the control register setup functions. </div><div id="wwpID0E0GL0HA" class="Body_Text">For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0OO0HA" title="Sensor Driver Programming Guide">Setting Up Control Registers</a></span>.</div><div id="wwpID0E0FL0HA" class="Code">imx185_set_group_hold</div><div id="wwpID0E0EL0HA" class="Code">imx185_set_gain</div><div id="wwpID0E0DL0HA" class="Code">imx185_set_frame_length</div><div id="wwpID0E0CL0HA" class="Code">imx185_set_coarse_time</div><div id="wwpID0E0BL0HA" class="Code">imx185_set_coarse_time_short</div><div id="wwpID0E0AL0HA" class="Code">imx185_write_eeprom</div><div id="wwpID0E06K0HA" class="Heading_4">Get-Volatile Control</div><div id="wwpID0E05K0HA" class="Body_Text">The imx185<span class="Code_Char">_g_volatile_ctrl</span> function contains a switch statement for redirecting get-control calls to their appropriate control handlers.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 54pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA04K0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 319.5pt"><div id="wwpID0EAAA04K0HA" class="Note_Text">For non-volatile controls, get-control simply returns the previously written value stored in the control handler.</div></td></tr></table></div><div id="wwpID0E03K0HA" class="Heading_4">Boot-Time Initialization</div><div id="wwpID0E02K0HA" class="Body_Text">The functions for initializing boot time are as follows.</div><div id="wwpID0E01K0HA" class="Heading_5">Control Initialization</div><div id="wwpID0E0ZK0HA" class="Body_Text">The imx185<span class="Code_Char">_ctrls_init</span> function iterates through <span class="Code_Char">ctrl_config_list</span>  and registers each control as a new custom control with the V4L2 framework. <span class="Code_Char">s_ctrl</span> is also called for each control to set it to its default value defined in <span class="Code_Char">ctrl_config_list</span>.</div><div id="wwpID0E0YK0HA" class="Body_Text">For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0CQ0HA" title="Sensor Driver Programming Guide">Configuration Controls</a></span>.</div><div id="wwpID0E0XK0HA" class="Body_Text">Modifying this function is necessary if you have calls for initializing the value for the read-only controls. See the calls to <span class="Code_Char">otp_setup</span> and <span class="Code_Char">fuse_id_setup</span> in  <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0TM0HA" title="Sensor Driver Programming Guide">Control Handlers</a></span>.</div><div id="wwpID0E0WK0HA" class="Code">imx185_ctrls_init {</div><div id="wwpID0E0VK0HA" class="Code">    ...</div><div id="wwpID0E0UK0HA" class="Code">    err = imx185_fuse_id_setup(priv);</div><div id="wwpID0E0TK0HA" class="Code">    ...</div><div id="wwpID0E0SK0HA" class="Code">}</div><div id="wwpID0E0RK0HA" class="Heading_5">Device Tree Parser</div><div id="wwpID0E0QK0HA" class="Body_Text">The <span class="Code_Char">imx185_parse_dt</span> function, which parses device trees, takes the Device Tree node and looks for the parameters, according to the sensor-related private data, required by the sensor driver.</div><div id="wwpID0E0PK0HA" class="Body_Text">The values include but are not limited to:</div><div id="wwpID0E0OK0HA" class="Code">mclk</div><div id="wwpID0E0NK0HA" class="Code">pwdn-gpios</div><div id="wwpID0E0MK0HA" class="Code">reset-gpios</div><div id="wwpID0E0LK0HA" class="Code">af-gpios</div><div id="wwpID0E0KK0HA" class="Code">avdd-reg</div><div id="wwpID0E0JK0HA" class="Code">dvdd-reg</div><div id="wwpID0E0IK0HA" class="Code">iovdd-reg</div><div id="wwpID0E0HK0HA" class="Body_Text">For details on how to set up device trees with the appropriate values, see the documentation. You must match the name list with the names in the Device Tree for their respective name-value pairs.</div><div id="wwpID0E0GK0HA" class="Heading_5">Media Controller Setup</div><div id="wwpID0E0FK0HA" class="Body_Text">A few additional components are needed to setup the media controller for V4L2 use. The open call is a placeholder operation for satisfying the V4L2 sub-device internal operation requirements. The setup likely will not need to be change besides a name changed to match the devices.</div><div id="wwpID0E0EK0HA" class="Code">imx185_open</div><div id="wwpID0E0DK0HA" class="Body_Text">Sub-device function operations must link to the open operation:</div><div id="wwpID0E0CK0HA" class="Code">static const struct v4l2_subdev_internal_ops imx185_subdev_internal_ops = {</div><div id="wwpID0E0BK0HA" class="Code">    .open = imx185_open,</div><div id="wwpID0E0AK0HA" class="Code">};</div><div id="wwpID0E06J0HA" class="Body_Text">Media entity function operations must link to the V4L2 sub-device link validation method:</div><div id="wwpID0E05J0HA" class="Code">static const struct media_entity_operations imx185_media_ops = {</div><div id="wwpID0E04J0HA" class="Code">    .link_validate = v4l2_subdev_link_validate,</div><div id="wwpID0E03J0HA" class="Code">};</div><div id="wwpID0E02J0HA" class="Heading_5">Sensor-Driver Probing</div><div id="wwpID0E01J0HA" class="Body_Text">The probing function of the sensor driver are as follows.</div><div id="wwpID0E0ZJ0HA" class="Heading_6"><span class="Strong">Entry Point for Initialization During Boot</span></div><div id="wwpID0E0YJ0HA" class="Body_Text">The <span class="Code_Char">imx185_probe</span> function is the entry point of the driver. The function starts off by allocating memory for common data and sensor-private data. For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AR0HA" title="Sensor Driver Programming Guide">Sensor-Private Data</a></span>.</div><div id="wwpID0E0XJ0HA" class="Code">common_data = devm_kzalloc(&amp;client-&gt;dev,</div><div id="wwpID0E0WJ0HA" class="Code">    sizeof(struct camera_common_data), GFP_KERNEL);</div><div id="wwpID0E0VJ0HA" class="Code">&nbsp;</div><div id="wwpID0E0UJ0HA" class="Code">priv = devm_kzalloc(&amp;client-&gt;dev,</div><div id="wwpID0E0TJ0HA" class="Code">    sizeof(struct imx185) + sizeof(struct v4l2_ctrl *) *</div><div id="wwpID0E0SJ0HA" class="Code">    ARRAY_SIZE(ctrl_config_list),</div><div id="wwpID0E0RJ0HA" class="Code">    GFP_KERNEL);</div><div id="wwpID0E0QJ0HA" class="Body_Text">The function then initializes <span class="Code_Char">regmap</span>:</div><div id="wwpID0E0PJ0HA" class="Code">priv-&gt;regmap = devm_regmap_init_i2c(client, &amp;sensor_regmap_config);</div><div id="wwpID0E0OJ0HA" class="Body_Text">Next, the function calls the other initialization functions, including:</div><div id="wwpID0E0NJ0HA" class="Code">// See the section Parser for Device Trees: stored in private </div><div id="wwpID0E0MJ0HA" class="Code">// data pdata field.</div><div id="wwpID0E0LJ0HA" class="Code">imx185_parse_dt(client);</div><div id="wwpID0E0KJ0HA" class="Code">&nbsp;</div><div id="wwpID0E0JJ0HA" class="Code">// See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AO0HA" title="Sensor Driver Programming Guide">Power Functions</a></span>.</div><div id="wwpID0E0IJ0HA" class="Code">imx185_power_get(priv);</div><div id="wwpID0E0HJ0HA" class="Code">&nbsp;</div><div id="wwpID0E0GJ0HA" class="Code">&nbsp;</div><div id="wwpID0E0FJ0HA" class="Code">// Link the appropriate subdev ops see </div><div id="wwpID0E0EJ0HA" class="Code">// <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E04N0HA" title="Sensor Driver Programming Guide">Setting Up V4L2 Subdevice and Camera Common</a></span>.</div><div id="wwpID0E0DJ0HA" class="Code">v4l2_i2c_subdev_init(&amp;common_data-&gt;subdev, client, &amp;subdev_ops);</div><div id="wwpID0E0CJ0HA" class="Code">&nbsp;</div><div id="wwpID0E0BJ0HA" class="Code">// See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E01K0HA" title="Sensor Driver Programming Guide">Initialization of Controls</a></span>.</div><div id="wwpID0E0AJ0HA" class="Code">imx185_ctrls_init(priv);</div><div id="wwpID0E06I0HA" class="Body_Text">Next, the function links the common data and sensor-private values:</div><div id="wwpID0E05I0HA" class="Code">// Link to ops. See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E04N0HA" title="Sensor Driver Programming Guide">Setting Up V4L2 Subdevice and Camera Common</a></span>.</div><div id="wwpID0E04I0HA" class="Code">common_data-&gt;ops = &amp; imx185_common_ops;</div><div id="wwpID0E03I0HA" class="Code">&nbsp;</div><div id="wwpID0E02I0HA" class="Code">// Control handler linking</div><div id="wwpID0E01I0HA" class="Code">common_data-&gt;ctrl_handler = &amp;priv-&gt;ctrl_handler;</div><div id="wwpID0E0ZI0HA" class="Code">&nbsp;</div><div id="wwpID0E0YI0HA" class="Code">// I2C client passed in to probe</div><div id="wwpID0E0XI0HA" class="Code">common_data-&gt;i2c_client = client;</div><div id="wwpID0E0WI0HA" class="Code">&nbsp;</div><div id="wwpID0E0VI0HA" class="Code">// Default to frame format 0. See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AC0HA" title="Sensor Driver Programming Guide">Mode Tables</a></span>.</div><div id="wwpID0E0UI0HA" class="Code">common_data-&gt;frmfmt = &amp; imx185_frmfmt[0];</div><div id="wwpID0E0TI0HA" class="Code">&nbsp;</div><div id="wwpID0E0SI0HA" class="Code">// Based on default data format definition, generally defaults</div><div id="wwpID0E0RI0HA" class="Code">// to the same format. See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0FR0HA" title="Sensor Driver Programming Guide">Macro Definitions</a></span>.</div><div id="wwpID0E0QI0HA" class="Code">common_data-&gt;colorfmt = camera_common_find_datafmt(</div><div id="wwpID0E0PI0HA" class="Code">                            IMX185_DEFAULT_DATAFMT);</div><div id="wwpID0E0OI0HA" class="Code">&nbsp;</div><div id="wwpID0E0NI0HA" class="Code">// Power-handler linking</div><div id="wwpID0E0MI0HA" class="Code">common_data-&gt;power = &amp;priv-&gt;power;</div><div id="wwpID0E0LI0HA" class="Code">&nbsp;</div><div id="wwpID0E0KI0HA" class="Code">// Sensor-private data linking</div><div id="wwpID0E0JI0HA" class="Code">common_data-&gt;priv = (void *)priv;</div><div id="wwpID0E0II0HA" class="Code">&nbsp;</div><div id="wwpID0E0HI0HA" class="Code">&nbsp;</div><div id="wwpID0E0GI0HA" class="Code">// Number of format is frame format. See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0FR0HA" title="Sensor Driver Programming Guide">Macro Definitions</a></span>.</div><div id="wwpID0E0FI0HA" class="Code">common_data-&gt;numfmts = ARRAY_SIZE(imx185_frmfmt);</div><div id="wwpID0E0EI0HA" class="Code">&nbsp;</div><div id="wwpID0E0DI0HA" class="Code">&nbsp;</div><div id="wwpID0E0CI0HA" class="Code">// Set up of port information for device</div><div id="wwpID0E0BI0HA" class="Code">camera_common_parse_ports(...)</div><div id="wwpID0E0AI0HA" class="Code">// Port information is also used to create the name for debugfs node setup</div><div id="wwpID0E06H0HA" class="Code"><span style="background-color: white"><a href="http://lmi-hub/source/s?defs=sprintf&amp;project=dev-kernel" target="external_window">sprintf</a></span><span style="background-color: white">(</span><span style="background-color: white"><a href="http://lmi-hub/source/xref/dev-kernel/kernel-3.18/drivers/media/i2c/ov23850.c#debugfs_name" target="external_window">debugfs_name</a></span><span style="background-color: white">, "imx185_%c",</span><span style="background-color: white"><a href="http://lmi-hub/source/xref/dev-kernel/kernel-3.18/drivers/media/i2c/ov23850.c#common_data" target="external_window"> common_data</a></span><span style="background-color: white">-&gt;</span><span style="background-color: white"><a href="http://lmi-hub/source/s?defs=csi_port&amp;project=dev-kernel" target="external_window">csi_port</a></span><span style="background-color: white"> + 'a');</span></div><div id="wwpID0E05H0HA" class="Code">camera_common_create_debugfs(common_data, <span style="background-color: white"><a href="http://lmi-hub/source/xref/dev-kernel/kernel-3.18/drivers/media/i2c/ov23850.c#debugfs_name" target="external_window">debugfs_name</a></span>); </div><div id="wwpID0E04H0HA" class="Heading_6"><span class="Strong">Setup of Default Values for Common Data</span></div><div id="wwpID0E03H0HA" class="Body_Text">For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0FR0HA" title="Sensor Driver Programming Guide">Macro Definitions</a></span>.</div><div id="wwpID0E02H0HA" class="Code">common_data-&gt;def_mode = IMX185_DEFAULT_MODE;</div><div id="wwpID0E01H0HA" class="Code">common_data-&gt;def_width = IMX185_DEFAULT_WIDTH;</div><div id="wwpID0E0ZH0HA" class="Code">common_data-&gt;def_height = IMX185_DEFAULT_HEIGHT;</div><div id="wwpID0E0YH0HA" class="Code">common_data-&gt;def_clk_freq = IMX185_DEFAULT_CLK_FREQ;</div><div id="wwpID0E0XH0HA" class="Code">&nbsp;</div><div id="wwpID0E0WH0HA" class="Code">// I2C client passed in to probe</div><div id="wwpID0E0VH0HA" class="Code">priv-&gt;i2c_client = client;</div><div id="wwpID0E0UH0HA" class="Code">&nbsp;</div><div id="wwpID0E0TH0HA" class="Code">// Link to common data above</div><div id="wwpID0E0SH0HA" class="Code">priv-&gt;s_data = common_data;</div><div id="wwpID0E0RH0HA" class="Code">&nbsp;</div><div id="wwpID0E0QH0HA" class="Code">// Link to V4L2 subdevice handler</div><div id="wwpID0E0PH0HA" class="Code">priv-&gt;subdev = &amp;common_data-&gt;subdev;</div><div id="wwpID0E0OH0HA" class="Code">// Link to subdevice dev to i2c_client dev (for media controller usage)</div><div id="wwpID0E0NH0HA" class="Code">priv-&gt;subdev-&gt;dev = &amp;client-&gt;dev;</div><div id="wwpID0E0MH0HA" class="Heading_5">Setup of Media Controller</div><div id="wwpID0E0LH0HA" class="Body_Text">All imager devices must register themselves as sub devices to media controller framework. VI acts as the master device which controls the binding, parsing the DT and establishes the media links once all the sub devices are registered.</div><div id="wwpID0E0KH0HA" class="Body_Text">Each sub-device can register to media controller framework by defining the entity and pads information. </div><div id="wwpID0E0JH0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span style="font-weight: bold">Entity:</span> Media entity is the unit device represented by media controller framework for establishing connections. Each media entity can have multiple pads. Framework provides a list of known entity types and the corresponding media operations.</div><div id="wwpID0E0IH0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span style="font-weight: bold">Pad:</span> Pad represents the device behaves as SINK or SOURCE port. Imager device must have a SOURCE port which is bound to VI. If imager device has a SINK port then the SOURCE port which binds the device SINK port must be represented in DT to complete the binding.</div><div id="wwpID0E0HH0HA" class="Code">// Link subdevice internal and media entity operations</div><div id="wwpID0E0GH0HA" class="Code">priv-&gt;subdev-&gt;internal_ops = &amp; imx185_subdev_internal_ops;</div><div id="wwpID0E0FH0HA" class="Code">&nbsp;</div><div id="wwpID0E0EH0HA" class="Code">// Setup subdevice flags and media entity type</div><div id="wwpID0E0DH0HA" class="Code">priv-&gt;subdev-&gt;flags |= V4L2_SUBDEV_FL_HAS_DEVNODE | V4L2_SUBDEV_FL_HAS_EVENTS;</div><div id="wwpID0E0CH0HA" class="Code">&nbsp;</div><div id="wwpID0E0BH0HA" class="Code">// Setup media controller pad flags</div><div id="wwpID0E0AH0HA" class="Code">priv-&gt;pad.flags = MEDIA_PAD_FL_SOURCE;</div><div id="wwpID0E06G0HA" class="Code">&nbsp;</div><div id="wwpID0E05G0HA" class="Code">priv-&gt;subdev-&gt;entity.type = MEDIA_ENT_T_V4L2_SUBDEV_SENSOR;</div><div id="wwpID0E04G0HA" class="Code">priv-&gt;subdev-&gt;entity.ops = &amp; imx185_media_ops;</div><div id="wwpID0E03G0HA" class="Code">&nbsp;</div><div id="wwpID0E02G0HA" class="Code">&nbsp;</div><div id="wwpID0E01G0HA" class="Code">// Initialize and register subdevice and media entity with media controller framework.</div><div id="wwpID0E0ZG0HA" class="Code">media_entity_init(&amp;priv-&gt;subdev-&gt;entity, 1, &amp;priv-&gt;pad, 0);</div><div id="wwpID0E0YG0HA" class="Code">&nbsp;</div><div id="wwpID0E0XG0HA" class="Code">v4l2_async_register_subdev(priv-&gt;subdev);</div><div id="wwpID0E0WG0HA" class="Code">&nbsp;</div><div id="wwpID0E0VG0HA" class="Heading_4">Removing Sensor Drivers</div><div id="wwpID0E0UG0HA" class="Body_Text">The <span class="Code_Char">imx185_remove</span> function removes the sensor-device instance and is called on device shutdown.</div><div id="wwpID0E0TG0HA" class="Body_Text">This function makes calls to various <span class="Code_Char">free</span>, <span class="Code_Char">put</span>, and <span class="Code_Char">destroy</span> functions that match up with several calls in probe. It must remain largely the same.</div><div id="wwpID0E0SG0HA" class="Code">// Unregister v4l2 sub-device</div><div id="wwpID0E0RG0HA" class="Code">v4l2 async unregister subdev(priv-&gt;<span style="font-weight: bold">subdev</span>);</div><div id="wwpID0E0QG0HA" class="Code">&nbsp;</div><div id="wwpID0E0PG0HA" class="Code">// Cleanup and unregister subdevice and media entity with</div><div id="wwpID0E0OG0HA" class="Code">media controller framework.</div><div id="wwpID0E0NG0HA" class="Code">media entity cleanup (&amp;priv-&gt;<span style="font-weight: bold">subdev</span>-&gt;entity);</div><div id="wwpID0E0MG0HA" class="Code">&nbsp;</div><div id="wwpID0E0LG0HA" class="Code">See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E01K0HA" title="Sensor Driver Programming Guide">Initialization of Controls</a></span> for details on</div><div id="wwpID0E0KG0HA" class="Code">// freeing the control handler.</div><div id="wwpID0E0JG0HA" class="Code">v4l2_ctrl_handler free(&amp;priv-&gt;ctrl_handler);</div><div id="wwpID0E0IG0HA" class="Heading_3">Kernel Configuration</div><div id="wwpID0E0HG0HA" class="Body_Text">After driver development is complete, add your new device information to the kernel configuration file, so it can be enabled for the kernel, as follows:</div><div id="wwpID0E0GG0HA" class="Code">CONFIG_VIDEO imx185=y</div><div id="wwpID0E0FG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Android:</div><div id="wwpID0E0EG0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E0DG0HA" class="Code_Indent">&lt;top&gt;/kernel/kernel-4.4/arch/arm64/configs/tegra21_android_defconfig</div><div id="wwpID0E0CG0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E0BG0HA" class="Code_Indent">&lt;top&gt;/kernel/kernel-4.4/arch/arm64/configs/tegra18_android_defconfig</div><div id="wwpID0E0AG0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Linux:</div><div id="wwpID0E06F0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E05F0HA" class="Code_Indent">&lt;top&gt;/kernel/kernel-4.4/arch/arm64/configs/tegra21_defconfig</div><div id="wwpID0E04F0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E03F0HA" class="Code_Indent">&lt;top&gt;/kernel/kernel-4.4/arch/arm64/configs/tegra18_defconfig</div><div id="wwpID0E02F0HA" class="Heading_3">Device Registration</div><div id="wwpID0E01F0HA" class="Body_Text">After driver development is complete, you must add your device information to the system kernel device tree so it can be instantiated when the kernel boots. There are two ways of registering your device.</div><div id="wwpID0E0ZF0HA" class="Heading_4">Using Plugin Manager</div><div id="wwpID0E0YF0HA" class="Body_Text">If your camera module has onboard EEPROM and has a valid camera ID programmed, Plugin Manager can be used. If your device module does not meet this requirement, use the main platform device tree instead by following the directions in <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0XE0HA" title="Sensor Driver Programming Guide">Using Main Platform Device Tree File</a></span>.</div><div id="wwpID0E0XF0HA" class="Body_Text">Plugin Manager automatically links devices when the system kernel boots. Plugin Manager uses the camera module ID returned by the boot loader to update the device tree entries with proper information at runtime. Plugin Manager allows a single system image to support multiple camera devices. To change camera modules, power down the device, replace the camera module, and then reboot. The new module works automatically.</div><div id="wwpID0E0WF0HA" class="Heading_5">For Plugin Manager support</div><div id="wwpID0E0VF0HA" class="List_Number" style="margin-left: 54pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Add your DTSI file to the camera configuration DTSI file.</div><div id="wwpID0E0UF0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Set the status of your device nodes to “disabled” as follows.</div><div id="wwpID0E0TF0HA" class="Code">		imx185_cam0: imx185_a@1a {</div><div id="wwpID0E0SF0HA" class="Code">			status = "disabled";</div><div id="wwpID0E0RF0HA" class="Code">		};</div><div id="wwpID0E0QF0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Update the camera plugin manager DTSI with proper override information.</div><div id="wwpID0E0PF0HA" class="Code">		fragment-imx185@0 {</div><div id="wwpID0E0OF0HA" class="Code">			ids = "LPRD-002001";</div><div id="wwpID0E0NF0HA" class="Code">			override@0 {</div><div id="wwpID0E0MF0HA" class="Code">				target = &lt;&amp;imx185_cam0&gt;;</div><div id="wwpID0E0LF0HA" class="Code">				_overlay_ {</div><div id="wwpID0E0KF0HA" class="Code">					status = "okay";</div><div id="wwpID0E0JF0HA" class="Code">				};</div><div id="wwpID0E0IF0HA" class="Code">			};</div><div id="wwpID0E0HF0HA" class="Code">			…</div><div id="wwpID0E0GF0HA" class="Code">		};</div><div id="wwpID0E0FF0HA" class="List_Continue">When the kernel boots, if a specific camera board is found, the override data is applied to the specific device nodes, and they are made available for the system.</div><div id="wwpID0E0EF0HA" class="Heading_5">Prerequisites</div><div id="wwpID0E0DF0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>You have obtained the kernel source files. For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/getting_started.html#wwconnect_header" title="BSP Customization">Synchronizing the Kernel</a></span>. </div><div id="wwpID0E0CF0HA" class="Heading_5">To enable Plugin Manager support</div><div id="wwpID0E0BF0HA" class="List_Number" style="margin-left: 54pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Add your device DTSI to the camera lists in:</div><div id="wwpID0E0AF0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E06E0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/:qt210/jetson/kernel-dts/jetson-platforms/tegra210-jetson-cv-camera-modules.dtsi</div><div id="wwpID0E05E0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E04E0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t18x/common/kernel-dts/t18x-common-platforms/tegra186-quill-camera-modules.dtsi</div><div id="wwpID0E03E0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Add the override information to:</div><div id="wwpID0E02E0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1: </div><div id="wwpID0E01E0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t210/jetson/kernel-dts/jetson-plugin-manager/tegra210-jetson-cv-camera-plugin-manager.dtsi</div><div id="wwpID0E0ZE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2: </div><div id="wwpID0E0YE0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t18x/common/kernel-dts/t18x-common-plugin-manager/tegra186-quill-camera-plugin-manager.dtsi</div><div id="wwpID0E0XE0HA" class="Heading_4">Using Main Platform Device Tree File</div><div id="wwpID0E0WE0HA" class="Body_Text">Register your new device by updating main platform DTSI file to include your new device DTSI file. Because Tegra uses Plugin Manager by default, you must first unregister Plugin Manager support, then add your device information to the main device tree DTSI file.</div><div id="wwpID0E0VE0HA" class="Heading_5">Prerequisites</div><div id="wwpID0E0UE0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>You have obtained the kernel source files. For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/getting_started.html#wwconnect_header" title="BSP Customization">Synchronizing the Kernel</a></span> in the Development Guide for the release.</div><div id="wwpID0E0TE0HA" class="Heading_5">To register a device using main-platform device tree files</div><div id="wwpID0E0SE0HA" class="List_Number" style="margin-left: 54pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Locate and edit the following file:</div><div id="wwpID0E0RE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E0QE0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t210/jetson/kernel-dts/tegra210-jetson-cv-base-p25970-2180-a00.dts</div><div id="wwpID0E0PE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E0OE0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t18x/quill/kernel-dts/tegra186-quill-p3310-1000-a00-00-base.dtsi</div><div id="wwpID0E0NE0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>In the DTSI, remove the following line:</div><div id="wwpID0E0ME0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E0LE0HA" class="Code_Indent">#include "jetson-plugin-manager/tegra210-jetson-cv-camera-plugin-manager.dtsi"</div><div id="wwpID0E0KE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E0JE0HA" class="Code_Indent">#include &lt;t18x-common-plugin-manager/tegra186-quill-camera-plugin-manager.dtsi"</div><div id="wwpID0E0IE0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Locate and edit the following file: </div><div id="wwpID0E0HE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E0GE0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t210/jetson/kernel-dts/tegra210-jetson-cv-base-p2597-2180-a00.dts</div><div id="wwpID0E0FE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E0EE0HA" class="Code_Indent">&lt;top&gt;/hardware/nvidia/platform/t18x/quill/kernel-dts/tegra186-quill-p3310-1000-a00-00-base.dts</div><div id="wwpID0E0DE0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>In the DTS file, replace the following line:</div><div id="wwpID0E0CE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX1:</div><div id="wwpID0E0BE0HA" class="Code_Indent">#include "jetson-platforms/tegra210-jetson-cv-camera-modules.dtsi"</div><div id="wwpID0E0AE0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>TX2:</div><div id="wwpID0E06D0HA" class="Code_Indent">#include &lt;t18x-common-platforms/tegra186-quill-camera-modules.dtsi&gt;</div><div id="wwpID0E05D0HA" class="List_Continue">With an <span class="Code_Char">#include</span> statement specifying the DTSI file for your new device.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 59.4pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA04D0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 292.5pt"><div id="wwpID0EAAA04D0HA" class="Note_Text">Use tegra210-jetson-cv-camera-modules.dtsi or tegra18x-quill-cv-camera-modules.dtsi as a model for generating your DTSI. In your file, change <span class="Code_Char">status = disable</span> to <span class="Code_Char">status = okay</span>.</div></td></tr></table></div><div id="wwpID0E03D0HA" class="Heading_3">Verifying the V4L2 Sensor Driver</div><div id="wwpID0E02D0HA" class="List_Continue">When the driver is complete, run <span class="Code_Char">v4l2-compliance</span> and <span class="Code_Char">v4l2-ctl</span> to ensure that your driver can capture raw data through the V4L2 interface.</div><div id="wwpID0E01D0HA" class="List_Continue">For details on RAW memory format, see the <span class="Emphasis">Tegra X2 Technical Reference Manual</span> “Video Input” topic.</div><div id="wwpID0E0ZD0HA" class="Heading_5">To run a v4l2-compliance test</div><div id="wwpID0E0YD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Enter the command:</div><div id="wwpID0E0XD0HA" class="Code">v4l2-compliance -d /dev/video0  </div><div id="wwpID0E0WD0HA" class="List_Continue">Specify the device node path with option <span class="Code_Char">‑d</span>.</div><div id="wwpID0E0VD0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>If you have a single camera, the device path is <span class="Code_Char">/dev/video0</span>.</div><div id="wwpID0E0UD0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>If you have multiple cameras, the number after <span class="Code_Char">video</span> indicates the index of one of the camera available in the system. The program will use this camera for the test.</div><div id="wwpID0E0TD0HA" class="Heading_5">To run a v4l2-ctl test</div><div id="wwpID0E0SD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Enter the command:</div><div id="wwpID0E0RD0HA" class="Code">v4l2-ctl --set-fmt-video=width=1920,height=1080,pixelformat=RG12 --stream-mmap -set-ctrl=sensor_mode=0 --stream-count=100 -d /dev/video0</div><div id="wwpID0E0QD0HA" class="List_Continue">You can use <span class="Code_Char">v4l2-ctl</span> to capture RAW data. You must provide appropriate parameter values for the camera driver you are using. </div><div id="wwpID0E0PD0HA" class="List_Continue">Both <span class="Code_Char">v4l2-compliance</span> and <span class="Code_Char">v4l2-ctl</span> are available as open source projects. Documentation for these commands is available from LinuxTV at:</div><div id="wwpID0E0OD0HA" class="Code"><span class="Hyperlink"><a href="https://www.linuxtv.org/wiki/index.php/V4l-utils" target="external_window">https://www.linuxtv.org/wiki/index.php/V4l-utils</a></span></div><div id="wwpID0E0ND0HA" class="Heading_3">Debugging Tips</div><div id="wwpID0E0MD0HA" class="Body_Text">When the driver is complete, before running any camera applications, check to see if the camera device node(s) got populated correctly in the system.</div><div id="wwpID0E0LD0HA" class="Body_Text">If the driver is loaded properly, the following device node is displayed:</div><div id="wwpID0E0KD0HA" class="Code">/dev/&lt;video#&gt;</div><div id="wwpID0E0JD0HA" class="Body_Text">The device node is the file I/O interface with which the user-space driver accesses the driver.</div><div id="wwpID0E0ID0HA" class="Body_Text">Problems may occur in the probing process and require debugging. Typically, problems occur in the clock, GPIO, and regulator setup. </div><div id="wwpID0E0HD0HA" class="Heading_5">To verify that driver name matches the name in the Device Tree</div><div id="wwpID0E0GD0HA" class="Body_Text">Your device name must be the same in both the Device Tree and your driver. This is how kernel binds the driver to your device.</div><div id="wwpID0E0FD0HA" class="Body_Text">In Device Tree:</div><div id="wwpID0E0ED0HA" class="Code">compatible = "nvidia,imx185";</div><div id="wwpID0E0DD0HA" class="Body_Text">In driver:</div><div id="wwpID0E0CD0HA" class="Code">static struct of_device_id imx185_of_match[] = {</div><div id="wwpID0E0BD0HA" class="Code">{ .compatible = "nvidia,imx185", },</div><div id="wwpID0E0AD0HA" class="Code">{ },</div><div id="wwpID0E06C0HA" class="Code">};</div><div id="wwpID0E05C0HA" class="Code">…</div><div id="wwpID0E04C0HA" class="Code">.driver = {</div><div id="wwpID0E03C0HA" class="Code">     .name = "imx185",</div><div id="wwpID0E02C0HA" class="Code">     .owner = THIS_MODULE,</div><div id="wwpID0E01C0HA" class="Code">     .of_match_table = of_match_ptr(imx185_of_match),</div><div id="wwpID0E0ZC0HA" class="Code">},</div><div id="wwpID0E0YC0HA" class="Heading_5">To verify that all names match the Device Tree</div><div id="wwpID0E0XC0HA" class="Body_Text">Verify that the names that are being read through the <span class="Code_Char">parse_dt</span> function matches those in the Device Tree.</div><div id="wwpID0E0WC0HA" class="Heading_5">To verify that the Device-Tree values match the hardware</div><div id="wwpID0E0VC0HA" class="Body_Text">Ensure that the values assigned to the Device Tree fields match the hardware they describe. Oftentimes, regulator names, GPIO numbers, and clock names are out-of-date in the Device Tree, causing probing to fail.</div><div id="wwpID0E0UC0HA" class="Body_Text">Use the Device Tree Compiler (dtc) to convert your .dtb file back to .dtsi format and examine the content. Ensure that the “status” field of your device node is set to the proper state.</div><div id="wwpID0E0TC0HA" class="Heading_5">To verify that functions run to completion</div><div id="wwpID0E0SC0HA" class="Body_Text">Ensure that the <span class="Code_Char">power_get</span> calls runs to completion. For details, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AO0HA" title="Sensor Driver Programming Guide">Power Functions</a></span> and <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E03K0HA" title="Sensor Driver Programming Guide">Boot-Time Initialization</a></span>.</div><div id="wwpID0E0RC0HA" class="Body_Text">Another common problem that occurs during probe is in <span class="Code_Char">control init</span>.</div><div id="wwpID0E0QC0HA" class="Heading_5">To verify that default values are correctly linked</div><div id="wwpID0E0PC0HA" class="Body_Text">Verify that default values are all linked correctly in the control configuration. Also, verify that the default macros are updated appropriately with the values in the mode table of the sensor.</div><div id="wwpID0E0OC0HA" class="Body_Text">For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0AR0HA" title="Sensor Driver Programming Guide">Sensor-Private Data and </a></span><span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0FR0HA" title="Sensor Driver Programming Guide">Macro Definitions</a></span>.</div><div id="wwpID0E0NC0HA" class="Body_Text">If new controls have been added to the control configuration list, on rare occasions, ensure that they contain the appropriate control handlers and default values.</div><div id="wwpID0E0MC0HA" class="Body_Text">After probing succeeds, problems could still occur with the control setting. A common problem is in the values of the register writes.</div><div id="wwpID0E0LC0HA" class="Heading_5">To verify that control-register values are correct</div><div id="wwpID0E0KC0HA" class="Body_Text">Ensure that the control-register setup contains the correct register address and formats according to the mode table and data sheets. For more information, see <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/camera_sensor_prog.html#wwpID0E0OO0HA" title="Sensor Driver Programming Guide">Setting Up Control Registers.</a></span> </div><div id="wwpID0E0JC0HA" class="Body_Text">For gain control, create a new <span class="Code_Char">calculate_gain </span>(<span class="Code_Char">to_gain</span>) function for calculating the gain value according to the gain formula in the datasheets.</div><div id="wwpID0E0IC0HA" class="Heading_5">To verify that mode-specific settings are correct</div><div id="wwpID0E0HC0HA" class="Body_Text">Double-check the mode-specific settings in the Device Tree and update them if necessary. The most common issues that cause sensor timeout are due to the wrong values for the following settings:</div><div id="wwpID0E0GC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The value for <span class="Code_Char">num_lanes</span> must be 1, 2, or 4, depending on your sensor configuration.</div><div id="wwpID0E0FC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The <span class="Code_Char">tegra_sinterface</span> setting must be set to the proper CSI port where the sensor is connected.</div><div id="wwpID0E0EC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>The <span class="Code_Char">discontinuous_clk</span> setting specifies for Tegra that the sensor is running in continuous clock mode (free running), or discontinuous clock mode (gated). If unsure, first set this value to “no”.</div><div id="wwpID0E0DC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Set the <span class="Code_Char">mclk_multiplier</span> to equal or larger than <span class="Code_Char">pix_clk_hz / mclk</span> to make sure the ISP is running fast enough to process the data from sensor.</div><div id="wwpID0E0CC0HA" class="Heading_5">Verify that i2c accesses are working properly</div><div id="wwpID0E0BC0HA" class="Body_Text">Closely examine the kernel logs for any I2C errors for the camera sensor. If there is an I2C error, check the power-on function to verify that the sensor power-on sequence is correct. The order of enabling power, clock, GPIO, and timing must comply with sensor specifications.</div><div id="wwpID0E0AC0HA" class="Heading_3">Mode Tables</div><div id="wwpID0E06B0HA" class="Body_Text">The modes tables of the register reside in a separate header file called <span class="Code_Char">sensor_mode_tbls.h</span> and are included by the main driver. Those tables can be a list of <span class="Code_Char">reg_8</span> or <span class="Code_Char">reg_16</span> address-value pairs. Mode tables are separated by resolution. </div><div id="wwpID0E05B0HA" class="Body_Text">The <span class="Code_Char">start</span> and <span class="Code_Char">stop</span> stream-register values must be in a separate mode table. When you separate them, delete the <span class="Code_Char">start</span> stream-register values at the end of the resolution mode tables.</div><div id="wwpID0E04B0HA" class="Code">static imx185_reg imx185_start[] = {</div><div id="wwpID0E03B0HA" class="Code">	 {0x3000, 0x00 },</div><div id="wwpID0E02B0HA" class="Code">	 {IMX185_TABLE_WAIT_MS, IMX185_WAIT_MS_START},</div><div id="wwpID0E01B0HA" class="Code">	 {0x3002, 0x00},</div><div id="wwpID0E0ZB0HA" class="Code">	 {0x3049, 0x02},</div><div id="wwpID0E0YB0HA" class="Code">	 {IMX185_TABLE_WAIT_MS, IMX185_WAIT_MS_STREAM},</div><div id="wwpID0E0XB0HA" class="Code">	 {IMX185_TABLE_END, 0x00 }</div><div id="wwpID0E0WB0HA" class="Code">};</div><div id="wwpID0E0VB0HA" class="Code">&nbsp;</div><div id="wwpID0E0UB0HA" class="Code">static imx185_reg imx185_stop[] = {</div><div id="wwpID0E0TB0HA" class="Code"> 	 {0x3000, 0x01 },</div><div id="wwpID0E0SB0HA" class="Code">	 {IMX185_TABLE_WAIT_MS, IMX185_WAIT_MS_STOP},</div><div id="wwpID0E0RB0HA" class="Code">	 {IMX185_TABLE_END, 0x00 }</div><div id="wwpID0E0QB0HA" class="Code">};</div><div id="wwpID0E0PB0HA" class="Body_Text">Also, a table for the color bars of the test pattern is used if the <span class="Code_Char">test_mode</span> flag is enabled, activating the test-pattern mode of the sensor. That table is required only if test pattern is supported by the sensor.</div><div id="wwpID0E0OB0HA" class="Code">static imx185_reg tp_colorbars[] = {</div><div id="wwpID0E0NB0HA" class="Code">    ...</div><div id="wwpID0E0MB0HA" class="Code">};</div><div id="wwpID0E0LB0HA" class="Body_Text">At the end of the header of the mode tables is an enumeration of all the mode tables, as well as a list that maps the enumeration to table pointers.</div><div id="wwpID0E0KB0HA" class="Code">enum {</div><div id="wwpID0E0JB0HA" class="Code">    IMX185_MODE_1920X1080_CROP_30FPS,</div><div id="wwpID0E0IB0HA" class="Code">    ...</div><div id="wwpID0E0HB0HA" class="Code">};</div><div id="wwpID0E0GB0HA" class="Code">static oimx185_reg *mode_table[] = {</div><div id="wwpID0E0FB0HA" class="Code">    [IMX185_MODE_1920X1080_CROP_30FPS] = imx185_1920x1080_crop_30fps, </div><div id="wwpID0E0EB0HA" class="Code">    ...</div><div id="wwpID0E0DB0HA" class="Code">};</div><div id="wwpID0E0CB0HA" class="Body_Text">The <span class="Code_Char">camera_common_frmfmt</span> array list is a required table that sets up the format for the V4L2 framework. Each of the elements on that list contains the resolutions, the <span class="Code_Char">is_hdr</span> flag, and the enumeration for the mode.</div><div id="wwpID0E0BB0HA" class="Code">static const struct camera_common_frmfmt imx185_frmfmt[] = {</div><div id="wwpID0E0AB0HA" class="Code">    {{1920, 1080}, 0, IMX185_MODE_1920X1080_CROP_30FPS},</div><div id="wwpID0E6HA" class="Code">    ...</div><div id="wwpID0E5HA" class="Code">};</div><div id="wwpID0E4HA" class="Heading_5">To add a register mode table</div><div id="wwpID0E3HA" class="List_Number" style="margin-left: 54pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Obtain the address-value pairs for the mode table you would like to add.</div><div id="wwpID0E2HA" class="Cell_Text">&nbsp;</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 59.4pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA1HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 292.5pt"><div id="wwpID0EAAA1HA" class="Note_Text">If separate stream-on and stream-off mode tables exist, you can omit them from the mode table.</div></td></tr></table></div><div id="wwpID0EZHA" class="List_Number" style="margin-left: 54pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Format the pairs according to the register structure and initialize a static array with the mode resolution as part of the name. For example:</div><div id="wwpID0EYHA" class="Code">static imx185_reg mode_####x####[] = {</div><div id="wwpID0EXHA" class="Code">{ 0x3000, 0x00 }, </div><div id="wwpID0EWHA" class="Code">...</div><div id="wwpID0EVHA" class="Code">/* your addr and val pairs */</div><div id="wwpID0EUHA" class="Code">};</div><div id="wwpID0ETHA" class="List_Continue">The mode table is now in place. End the table array with the following:</div><div id="wwpID0ESHA" class="Code">{ IMX185_TABLE_END, 0x00 }</div><div id="wwpID0ERHA" class="List_Number" style="margin-left: 54pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Create a new enumeration in the list of enumerations and add it to the array of mode tables:</div><div id="wwpID0EQHA" class="Code">enum {</div><div id="wwpID0EPHA" class="Code">    ...</div><div id="wwpID0EOHA" class="Code">    IMX185_MODE_####X####,</div><div id="wwpID0ENHA" class="Code">}</div><div id="wwpID0EMHA" class="Code">&nbsp;</div><div id="wwpID0ELHA" class="Code">static imx185_reg *mode_table[] = {</div><div id="wwpID0EKHA" class="Code">    ...</div><div id="wwpID0EJHA" class="Code">    [IMX185_MODE_####X####] = mode_####x####,</div><div id="wwpID0EIHA" class="Code">};</div><div id="wwpID0EHHA" class="List_Number" style="margin-left: 54pt; text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Add the new mode to the <span class="Code_Char">camera_common frmfmt</span> array:</div><div id="wwpID0EGHA" class="Code">static const struct camera_common_frmfmt IMX185_frmfmt[] = {</div><div id="wwpID0EFHA" class="Code">    ...</div><div id="wwpID0EEHA" class="Code">    {{####, ####}, 0, IMX185_MODE_####X####},</div><div id="wwpID0EDHA" class="Code">};</div><div id="wwpID0EBHA" class="Body_Text">&nbsp;</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br /><hr color="#DEE4F0" /><table width="90%" align="center" summary=""><tr><td class="Footer_Left"><font color="gray"><b></b><br />
           Subject to Change | © 2017 by NVIDIA Corporation.
           All rights reserved.
        </font></td><td class="Footer_Right"><font color="gray"><div>PR-06076-R28</div><br /><div style="text-align: center; font-weight: bold;"><div>Revised: 05 Mar 2018 16:32:31</div></div></font></td></tr></table></footer></body></html>